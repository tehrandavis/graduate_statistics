<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Tehran Davis">
<title>PSYC 7014: Graduate Statistics 1 - 40&nbsp; Within Subjects / Repeated Measures ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../week12/12_3-factorial_rma.html" rel="next">
<link href="../week12/12_1-afex_ANOVA.html" rel="prev">
<link href="../images/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="../site_libs/plotly-binding-4.10.1/plotly.js"></script><script src="../site_libs/typedarray-0.1/typedarray.min.js"></script><script src="../site_libs/jquery-3.5.1/jquery.min.js"></script><link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Within Subjects / Repeated Measures ANOVA</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">PSYC 7014: Graduate Statistics 1</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Graduate Statistics Walkthroughs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Part 1: INTRO to R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week00/0_1-getting_started.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week00/0_2-resources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Links to resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_1-Rmarkdown_basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Rmarkdown Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_2-objects_assignment_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Objects, assignment, and functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_3-install_packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Installing and loading an <code>R</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_4-loading_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Loading in Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_5-leveling-up.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Leveling-up</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Part 2: DESCRIBING &amp; VISUALIZING DATA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_1-structure_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The structure of your data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_2-central_tendency.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Measures of central tendency</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_3-summary_tables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Creating summary tables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_1-basic_ggplot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Basic ggplotting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_2-more_adv_ggplot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">More advanced ggPlots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_4-means_other_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Means and other models</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Part 3: DISTRIBUTIONS and NHST</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The normal distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Building intuitions about probability and NHST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_3-sampling_distributions_and_seeing_the_logic_of_nhst.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Sampling distributions and seeing the logic of NHST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_4-more_examples.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">More examples of distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_5-bias_variance.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Bias in sample variance estimates</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Part 4: MODELING w/ CONTINUOUS PREDICTORS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_2_correlations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_3_regressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Regression, pt.&nbsp;1: Running the model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_4_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Plotting regression data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_5_diagnostics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Regression model diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_6_example_report.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Example Report</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Part 5: T-TESTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_1_t-test.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Testing differences in means / t-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_2_t-test-null-model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Thinking about nothing (aka the null)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_3_t-test-lm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">t-test? It’s just a linear model</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Part 6: Power &amp; Effect Size</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_1-effect_size.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Effect Size</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_2-power.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Power</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_3-power_es_sig_tests.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Power, Effect sizes, and Significance testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_4-simulating_power.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Simulating Power!!!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Part 7: One-way ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_1-one-way-anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">The One-way ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_2-anova-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ANOVA and Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_1-posthocs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Multiple comparisons in One-way ANOVA, pt.&nbsp;1: post hoc tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_2-planned_contrasts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Multiple comparisons in One-way ANOVA, pt.&nbsp;2: planned contrasts</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Part 8: Factorial ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_1-main_effects.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Factorial ANOVA - The omnibus ANOVA and Main effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_2-factorial_w_post_hocs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Factorial ANOVA - Post hoc analysis of Main effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_3-advanced_example_and_apa.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Template for Analysis &amp; APA Style</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Part 9: Repeated Measures ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_1-afex_ANOVA.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">afex is for ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_2-repeated_measures_anova.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Within Subjects / Repeated Measures ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_3-factorial_rma.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Factorial RM-ANOVA and simple effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_4-sphericity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Sphericity: Variances and Co-Variances</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_5-spss_rma.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Running a RM-ANOVA in SPSS</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#within-subject-v.-between-subjects" id="toc-within-subject-v.-between-subjects" class="nav-link active" data-scroll-target="#within-subject-v.-between-subjects"><span class="toc-section-number">40.1</span>  Within-Subject v. Between Subjects</a>
  <ul class="collapse">
<li><a href="#within-v-between-anova" id="toc-within-v-between-anova" class="nav-link" data-scroll-target="#within-v-between-anova"><span class="toc-section-number">40.1.1</span>  Within v Between ANOVA</a></li>
  <li><a href="#comparing-bs-v-ws-anova" id="toc-comparing-bs-v-ws-anova" class="nav-link" data-scroll-target="#comparing-bs-v-ws-anova"><span class="toc-section-number">40.1.2</span>  Comparing BS v WS ANOVA</a></li>
  </ul>
</li>
  <li><a href="#a-note-on-univariate-v.-multivariate-methods" id="toc-a-note-on-univariate-v.-multivariate-methods" class="nav-link" data-scroll-target="#a-note-on-univariate-v.-multivariate-methods"><span class="toc-section-number">40.2</span>  a note on Univariate v. Multivariate methods</a></li>
  <li><a href="#a-note-on-sphericity-for-repeated-measures-anova" id="toc-a-note-on-sphericity-for-repeated-measures-anova" class="nav-link" data-scroll-target="#a-note-on-sphericity-for-repeated-measures-anova"><span class="toc-section-number">40.3</span>  a note on sphericity for Repeated measures ANOVA</a></li>
  <li>
<a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><span class="toc-section-number">40.4</span>  EXAMPLE 1</a>
  <ul class="collapse">
<li><a href="#loading-in-the-data" id="toc-loading-in-the-data" class="nav-link" data-scroll-target="#loading-in-the-data"><span class="toc-section-number">40.4.1</span>  loading in the data:</a></li>
  <li><a href="#plotting-the-data" id="toc-plotting-the-data" class="nav-link" data-scroll-target="#plotting-the-data"><span class="toc-section-number">40.4.2</span>  plotting the data</a></li>
  <li><a href="#the-facet-plot" id="toc-the-facet-plot" class="nav-link" data-scroll-target="#the-facet-plot"><span class="toc-section-number">40.4.3</span>  the Facet plot</a></li>
  <li><a href="#the-spaghetti-plot" id="toc-the-spaghetti-plot" class="nav-link" data-scroll-target="#the-spaghetti-plot"><span class="toc-section-number">40.4.4</span>  the Spaghetti Plot</a></li>
  <li><a href="#means-plots" id="toc-means-plots" class="nav-link" data-scroll-target="#means-plots"><span class="toc-section-number">40.4.5</span>  Means Plots</a></li>
  <li><a href="#building-the-model-using-afex" id="toc-building-the-model-using-afex" class="nav-link" data-scroll-target="#building-the-model-using-afex"><span class="toc-section-number">40.4.6</span>  building the model using afex:</a></li>
  <li><a href="#assumptions-checks-normality" id="toc-assumptions-checks-normality" class="nav-link" data-scroll-target="#assumptions-checks-normality"><span class="toc-section-number">40.4.7</span>  assumptions checks: normality</a></li>
  <li><a href="#assumptions-checks-sphericity" id="toc-assumptions-checks-sphericity" class="nav-link" data-scroll-target="#assumptions-checks-sphericity"><span class="toc-section-number">40.4.8</span>  assumptions checks: sphericity</a></li>
  <li><a href="#running-post-hoc-analyses-and-follow-ups" id="toc-running-post-hoc-analyses-and-follow-ups" class="nav-link" data-scroll-target="#running-post-hoc-analyses-and-follow-ups"><span class="toc-section-number">40.4.9</span>  running post-hoc analyses and follow-ups</a></li>
  <li><a href="#example-1-write-up" id="toc-example-1-write-up" class="nav-link" data-scroll-target="#example-1-write-up"><span class="toc-section-number">40.4.10</span>  Example 1 write up</a></li>
  </ul>
</li>
  <li>
<a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2"><span class="toc-section-number">40.5</span>  EXAMPLE 2</a>
  <ul class="collapse">
<li><a href="#loading-in-the-data-1" id="toc-loading-in-the-data-1" class="nav-link" data-scroll-target="#loading-in-the-data-1"><span class="toc-section-number">40.5.1</span>  loading in the data</a></li>
  <li><a href="#plotting-the-data-1" id="toc-plotting-the-data-1" class="nav-link" data-scroll-target="#plotting-the-data-1"><span class="toc-section-number">40.5.2</span>  plotting the data</a></li>
  <li><a href="#running-the-anova" id="toc-running-the-anova" class="nav-link" data-scroll-target="#running-the-anova"><span class="toc-section-number">40.5.3</span>  running the ANOVA:</a></li>
  <li><a href="#post-hocs-and-follow-ups" id="toc-post-hocs-and-follow-ups" class="nav-link" data-scroll-target="#post-hocs-and-follow-ups"><span class="toc-section-number">40.5.4</span>  post-hocs and follow-ups</a></li>
  <li><a href="#example-write-up" id="toc-example-write-up" class="nav-link" data-scroll-target="#example-write-up"><span class="toc-section-number">40.5.5</span>  Example write up</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">
<span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Within Subjects / Repeated Measures ANOVA</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="within-subject-v.-between-subjects" class="level2" data-number="40.1"><h2 data-number="40.1" class="anchored" data-anchor-id="within-subject-v.-between-subjects">
<span class="header-section-number">40.1</span> Within-Subject v. Between Subjects</h2>
<p>Up until now we have considered ANOVA in between subjects designs; when data at each level of each factor is from a <strong>different group</strong> of participants. This week we more onto within-subjects designs. As we mentioned in class we have a within-subject design whenever data from the same participants exists on at least two levels of a factor (or analogously occupied at least two cells within our interaction matrix).</p>
<p>To contrast some important distinctions let’s revisit our familiar data set contrasting test outcomes for students as a function of Lecture. I realize before, Lecture was crossed with at least one other factor, but for the sake on simplicity let’s just consider data from this single factor. The goal of this first section is to contrast results as a function whether this data is considered within-subjects or between-subjects.</p>
<p>This walkthough assumes you have the following packages:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>,</span>
<span>               <span class="va">afex</span>,</span>
<span>               <span class="va">cowplot</span>,</span>
<span>               <span class="va">emmeans</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Okay, not let’s load in some data:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_between</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/practice_datasets/within_between.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 36 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): Lecture
dbl (3): BetweenSubjects_ID, WithinSubjects_ID, Score

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_between</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 4
   BetweenSubjects_ID WithinSubjects_ID Lecture  Score
                &lt;dbl&gt;             &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
 1                  1                 1 Physical    53
 2                  2                 2 Physical    49
 3                  3                 3 Physical    47
 4                  4                 4 Physical    42
 5                  5                 5 Physical    51
 6                  6                 6 Physical    34
 7                  7                 7 Physical    44
 8                  8                 8 Physical    48
 9                  9                 9 Physical    35
10                 10                10 Physical    18
# ℹ 26 more rows</code></pre>
</div>
</div>
<section id="within-v-between-anova" class="level3" data-number="40.1.1"><h3 data-number="40.1.1" class="anchored" data-anchor-id="within-v-between-anova">
<span class="header-section-number">40.1.1</span> Within v Between ANOVA</h3>
<p>So we have our dataset <code>within_between</code>. You’ll note that there are two subjects columns <code>WithinSubjects</code> which imagines 12 participants each going through all 3 Lecture types and <code>BetweenSubjects</code> where each participant (N=36) is assigned to a single Lecture type. Previously, we might have treated this as a between subjects design. Looking at the <code>ezDesign</code> of this design we see that every <code>BetweenSubject</code> is assigned to a single condition (as evidenced by count = 1)</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ez</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ez/man/ezDesign.html">ezDesign</a></span><span class="op">(</span><span class="va">within_between</span>,y<span class="op">=</span><span class="va">Lecture</span>,x<span class="op">=</span><span class="va">BetweenSubjects_ID</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Skipping past the preliminaries (e.g., testing for assumptions) and straight to running the BS ANOVA:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">between_aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Score</span><span class="op">~</span><span class="va">Lecture</span>, data <span class="op">=</span> <span class="va">within_between</span><span class="op">)</span></span>
<span><span class="fu">sjstats</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjstats/reference/anova_stats.html">anova_stats</a></span><span class="op">(</span><span class="va">between_aov</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>term      | df | sumsq |  meansq | statistic | p.value | etasq | partial.etasq
------------------------------------------------------------------------------
Lecture   |  2 |  1194 | 597.000 |     4.284 |   0.022 | 0.206 |         0.206
Residuals | 33 |  4599 | 139.364 |           |         |       |              </code></pre>
</div>
</div>
<p>However, let’s assume instead that this data set comes a within design. That is, instead of different participants in each <code>Lecture</code> group, the same group of people went through all three lectures:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ez</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ez/man/ezDesign.html">ezDesign</a></span><span class="op">(</span><span class="va">within_between</span>,y<span class="op">=</span><span class="va">Lecture</span>,x<span class="op">=</span><span class="va">WithinSubjects_ID</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We see that the <code>ezDesign</code> has changed. Instead of 36 participants each individually assigned to a single condition, we have 12 participants each assigned to all three conditions for a single trial (measure). As mentioned in class, conceptually, a <strong>within subjects design considers participant as a pseudo factor</strong> with each individual participant as a level. To fully capture this we should <em>factorize</em> our <code>WithinSubjects_ID</code> column.</p>
<p>Running the within-subjects ANOVA:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>term                      | df |    sumsq |  meansq | statistic | p.value | etasq | partial.etasq
-------------------------------------------------------------------------------------------------
Lecture                   |  2 | 1194.000 | 597.000 |    12.305 |  &lt; .001 | 0.206 |         0.528
factor(WithinSubjects_ID) | 11 | 3531.667 | 321.061 |     6.618 |  &lt; .001 | 0.610 |         0.768
Residuals                 | 22 | 1067.333 |  48.515 |           |         |       |              </code></pre>
</div>
</div>
<p>Before continuing on, I want you to take a moment and think about what the specification of the formula in the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> model above actually means. Not only are we using <code>Lecture</code> as a predictor, but we are also treating participant <code>WithinSubjects_ID</code> as a factor as well. That is not only is the model accounting for the variation moving between levels of <code>Lecture</code>, but also the model is accounting for variability moving between each participant. If you want to continue to use the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> method for model building, you will need to include participant as a factor in the model. However, I would not recommend continuing with <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, especially as you end up with more complex within-subjects designs. In your future, you will probably elect to run either a mixed effects model using <code>lmer</code> or a repeated measures ANOVA. Mixed effect modeling is outside of the scope of what we cover this semester (although we’ve laid some foundations for it). As for repeated measures ANOVA, I would recommend moving onto a new method for running this in <code>R</code>. In the previous walkthrough I introduced <code>aov_ez()</code> from the <code>afex</code> library.</p>
<p>This might be a good time to start running ANOVA using <code><a href="https://rdrr.io/pkg/afex/man/aov_car.html">afex::aov_ez()</a></code>. Let’s re-run both of our models using <code>afex::ez()</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">between_aov</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"BetweenSubjects_ID"</span>, <span class="co"># 36 people in 3 groups</span></span>
<span>                           dv <span class="op">=</span> <span class="st">"Score"</span>, </span>
<span>                           data <span class="op">=</span> <span class="va">within_between</span>,</span>
<span>                           between <span class="op">=</span> <span class="st">"Lecture"</span>, <span class="co"># Lecture as between predictor</span></span>
<span>                           within <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           type <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                           return <span class="op">=</span> <span class="st">"afex_aov"</span>, </span>
<span>                           anova_table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>es <span class="op">=</span> <span class="st">"pes"</span><span class="op">)</span> <span class="co"># partial eta sq.</span></span>
<span>                           <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Converting to factor: Lecture</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: Lecture</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_aov</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"WithinSubjects_ID"</span>, <span class="co"># 12 people going through 3 conditions</span></span>
<span>                           dv <span class="op">=</span> <span class="st">"Score"</span>, </span>
<span>                           data <span class="op">=</span> <span class="va">within_between</span>,</span>
<span>                           between <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           within <span class="op">=</span> <span class="st">"Lecture"</span>, <span class="co"># Lecture as within predictor</span></span>
<span>                           type <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                           return <span class="op">=</span> <span class="st">"afex_aov"</span>, </span>
<span>                           anova_table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>es <span class="op">=</span> <span class="st">"pes"</span><span class="op">)</span> <span class="co"># partial eta sq.</span></span>
<span>                           <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="comparing-bs-v-ws-anova" class="level3" data-number="40.1.2"><h3 data-number="40.1.2" class="anchored" data-anchor-id="comparing-bs-v-ws-anova">
<span class="header-section-number">40.1.2</span> Comparing BS v WS ANOVA</h3>
<p>Okay, returning to our model outcomes. Keep in mind in both cases we are using the exact same scores.</p>
<p>Here is our between ANOVA:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">between_aov</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: Score
   Effect    df    MSE      F  pes p.value
1 Lecture 2, 33 139.36 4.28 * .206    .022
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>And here is our within ANOVA</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_aov</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: Score
   Effect          df   MSE        F  pes p.value
1 Lecture 1.26, 13.88 76.88 12.31 ** .528    .002
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>In both of these cases the data is exactly the same. What has changed is how we parse the variance (you’ll notice that the denominator degrees of freedom are different for the second ANOVA). In a within design, we need to take into account the “within-subject” variance. That is how individual subjects vary from one level of treatment to the other. In this respect, within designs are typically more powerful than analogous between designs. While the inherent differences between individual subjects is present in both types of designs, your within-subjects ANOVA model includes it in its analysis. In the present example, this increase in power is reflected by the lower MSE (48.52 v. 139.36) and subsequently, larger F-value (12.31 v. 4.28) and effect size (0.53 v. 0.21) in our within-subjects analysis.</p>
<p>Well if that’s the case why not run within-subject (WS) designs all of the time. Well, typically psychologists do when the subject lends itself to WS-designs. BUT there are certainly times when they are not practical, for example, if you are concerned about learning, practice, or carryover effects where exposure to a treatment on one level might impact the other levels—if you were studying radiation poisoning and had a placebo v. radiation dose condition, it be likely that you wouldn’t run your experiment as a within—or at the very least you wouldn’t give them the radiation first. It would also be likely that you’d be in violation several standards of ethics.</p>
<p>(You may also note that a correction is taking place on <code>within_aov</code> giving us those odd degrees of freedom. We’ll talk more about that in a bit.)</p>
</section></section><section id="a-note-on-univariate-v.-multivariate-methods" class="level2" data-number="40.2"><h2 data-number="40.2" class="anchored" data-anchor-id="a-note-on-univariate-v.-multivariate-methods">
<span class="header-section-number">40.2</span> a note on Univariate v. Multivariate methods</h2>
<p>Univariate v. multivariate statistical methods refer to the number of dependent variables associated with the model per fundamental unit of analysis. In psychology research the fundamental unit of analysis is typically the participant—measures are taken at the level of the participant. A univariate model has one dependent variable whereas a multivariate method has two or more per participant. Perhaps some of you are more familiar with this distinction in the context on One-way MANOVA… which analyzes two or more dependent variables simultaneously in an ANOVA design. MANOVA (multivariate ANOVA) is preferred to running seperate univariate ANOVAs if one believes that the dependent variables involved are somehow correlated with one another. In this case MANOVA factors these correlations into the model testing the IVs.</p>
<p>I bring all of this up as one way to conceptualize repeated-measures ANOVA is as multivariate method. Multiple measures are taken at the level of the participant. This will factor into our discussion of follow-up analyses.</p>
</section><section id="a-note-on-sphericity-for-repeated-measures-anova" class="level2" data-number="40.3"><h2 data-number="40.3" class="anchored" data-anchor-id="a-note-on-sphericity-for-repeated-measures-anova">
<span class="header-section-number">40.3</span> a note on sphericity for Repeated measures ANOVA</h2>
<p>In addition to the assumptions that we are familiar with, repeated-measures ANOVA has the additional assumption of Spherecity of Variance / Co-variance. We talked at length in class re: Spherecity of Variance / Co-variance so I suggest revisiting the slides for our example. At the same time there are debates as to the importance of sphericity in the subjects data. One alternative method that avoids these issues is to invoke mixed models (e.g., <code>lmer</code>). However, if you really want to go down the rabbit hole check out <a href="https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html">Doug Bates reponse on appropriate dfs and p-values in <code>lmer</code></a>. You’ll note that these discussions were ten years ago and are still being debated (see <a href="https://www.reddit.com/r/AskStatistics/comments/2x9ipp/linear_mixed_effect_models_and_pvalues_r/">here</a>. That said, you may be seeing mixed models in your near future (i.e., next semester)</p>
<p>For now, we won’t go down the rabbit hole and just focus on the practical issues confronted when running a repeated-measures ANOVA.</p>
</section><section id="example-1" class="level2" data-number="40.4"><h2 data-number="40.4" class="anchored" data-anchor-id="example-1">
<span class="header-section-number">40.4</span> EXAMPLE 1</h2>
<p>To start, we will use data related to the effectiveness of relaxation therapy to the number of episodes that chronic migraine sufferers reported. Data was collected from each subject over the course of 5 weeks. After week 2 the therapy treatment was implemented effectively dividing the 5 weeks into two phases, Pre (Weeks 1 &amp; 2) and Post (Weeks 3,4, &amp; 5).</p>
<section id="loading-in-the-data" class="level3" data-number="40.4.1"><h3 data-number="40.4.1" class="anchored" data-anchor-id="loading-in-the-data">
<span class="header-section-number">40.4.1</span> loading in the data:</h3>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">example1</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab14-3.dat"</span>, </span>
<span>                       delim <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 9 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
dbl (6): Subject, Wk1, Wk2, Wk3, Wk4, Wk5

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">example1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
  Subject   Wk1   Wk2   Wk3   Wk4   Wk5
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1       1    21    22     8     6     6
2       2    20    19    10     4     4
3       3    17    15     5     4     5
4       4    25    30    13    12    17
5       5    30    27    13     8     6
6       6    19    27     8     7     4
7       7    26    16     5     2     5
8       8    17    18     8     1     5
9       9    26    24    14     8     9</code></pre>
</div>
</div>
<p>You’ll notice that the data set above is in wide format. Each subject is on a single row and each week is in its own column. Note that <strong>this is the preferred format for within subjects analysis for SPSS</strong>. However in <code>R</code> we want it in long format.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">example1_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">example1</span>,</span>
<span>                              cols <span class="op">=</span> <span class="op">-</span><span class="va">Subject</span>,</span>
<span>                              names_to <span class="op">=</span> <span class="st">"Week"</span>, </span>
<span>                              values_to <span class="op">=</span> <span class="st">"Migraines"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example1_long</span><span class="op">$</span><span class="va">Week</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">example1_long</span><span class="op">$</span><span class="va">Week</span><span class="op">)</span></span>
<span><span class="va">example1_long</span><span class="op">$</span><span class="va">Subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">example1_long</span><span class="op">$</span><span class="va">Subject</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example1_long</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 45 × 3
   Subject Week  Migraines
   &lt;fct&gt;   &lt;fct&gt;     &lt;dbl&gt;
 1 1       Wk1          21
 2 1       Wk2          22
 3 1       Wk3           8
 4 1       Wk4           6
 5 1       Wk5           6
 6 2       Wk1          20
 7 2       Wk2          19
 8 2       Wk3          10
 9 2       Wk4           4
10 2       Wk5           4
# ℹ 35 more rows</code></pre>
</div>
</div>
<p>Ok, much better, each Subject × Week observation is on a single row.</p>
</section><section id="plotting-the-data" class="level3" data-number="40.4.2"><h3 data-number="40.4.2" class="anchored" data-anchor-id="plotting-the-data">
<span class="header-section-number">40.4.2</span> plotting the data</h3>
<p>In addition to plotting your means, one crucial step is to plot the changes in the within-subject (repeated measures) variable at the participant-level. This is especially useful for discerning whether the pattern of results is roughly similar for all participants -OR- if, instead there is large individual variability in the direction of the effect. In other words, “is your manipulation having roughly the same effect for every participant OR is the effect drastically different for participants.</p>
<p>There are 2 ways to do this: 1. the Facet plot or 2. Spaghetti Plot.</p>
</section><section id="the-facet-plot" class="level3" data-number="40.4.3"><h3 data-number="40.4.3" class="anchored" data-anchor-id="the-facet-plot">
<span class="header-section-number">40.4.3</span> the Facet plot</h3>
<p>Each window / facet is for a single subject (S1-S9):</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">example1_long</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Week</span>, y<span class="op">=</span><span class="va">Migraines</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="the-spaghetti-plot" class="level3" data-number="40.4.4"><h3 data-number="40.4.4" class="anchored" data-anchor-id="the-spaghetti-plot">
<span class="header-section-number">40.4.4</span> the Spaghetti Plot</h3>
<p>In this case each line represents an individual Subject (1-9):</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">example1_long</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Week</span>, y<span class="op">=</span><span class="va">Migraines</span>, group <span class="op">=</span> <span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>col<span class="op">=</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>col<span class="op">=</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which you choose is ultimately up to you. I tend to use Spaghetti plots unless I have instances where I have a high number of participants. This can potentially make the spaghetti plot busy (a bunch of points and line). That said, the purpose of the Spaghetti Plot is to note inconsistencies in trends. A helpful tool for a potentially busy Spaghetti Plot is to use <code>plotly</code>. This produces an interactive plot where you can use the mouse cursor to identify important information:</p>
<div class="cell" data-caption="use your mouse on me... I'm interactive!!">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span> <span class="co"># may need to install</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">s_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example1_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Week</span>, y<span class="op">=</span><span class="va">Migraines</span>, group <span class="op">=</span> <span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">s_plot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9441709c93c0a2bd55fb" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9441709c93c0a2bd55fb">{"x":{"data":[{"x":[1,2,3,4,5],"y":[21,22,8,6,6],"text":["Week: Wk1<br />Migraines: 21<br />Subject: 1<br />Subject: 1","Week: Wk2<br />Migraines: 22<br />Subject: 1<br />Subject: 1","Week: Wk3<br />Migraines:  8<br />Subject: 1<br />Subject: 1","Week: Wk4<br />Migraines:  6<br />Subject: 1<br />Subject: 1","Week: Wk5<br />Migraines:  6<br />Subject: 1<br />Subject: 1"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"frame":null},{"x":[1,2,3,4,5],"y":[20,19,10,4,4],"text":["Week: Wk1<br />Migraines: 20<br />Subject: 2<br />Subject: 2","Week: Wk2<br />Migraines: 19<br />Subject: 2<br />Subject: 2","Week: Wk3<br />Migraines: 10<br />Subject: 2<br />Subject: 2","Week: Wk4<br />Migraines:  4<br />Subject: 2<br />Subject: 2","Week: Wk5<br />Migraines:  4<br />Subject: 2<br />Subject: 2"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(211,146,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(211,146,0,1)"}},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(211,146,0,1)","dash":"solid"},"frame":null},{"x":[1,2,3,4,5],"y":[17,15,5,4,5],"text":["Week: Wk1<br />Migraines: 17<br />Subject: 3<br />Subject: 3","Week: Wk2<br />Migraines: 15<br />Subject: 3<br />Subject: 3","Week: Wk3<br />Migraines:  5<br />Subject: 3<br />Subject: 3","Week: Wk4<br />Migraines:  4<br />Subject: 3<br />Subject: 3","Week: Wk5<br />Migraines:  5<br />Subject: 3<br />Subject: 3"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(147,170,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(147,170,0,1)"}},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(147,170,0,1)","dash":"solid"},"frame":null},{"x":[1,2,3,4,5],"y":[25,30,13,12,17],"text":["Week: Wk1<br />Migraines: 25<br />Subject: 4<br />Subject: 4","Week: Wk2<br />Migraines: 30<br />Subject: 4<br />Subject: 4","Week: Wk3<br />Migraines: 13<br />Subject: 4<br />Subject: 4","Week: Wk4<br />Migraines: 12<br />Subject: 4<br />Subject: 4","Week: Wk5<br />Migraines: 17<br />Subject: 4<br />Subject: 4"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"4","legendgroup":"4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"frame":null},{"x":[1,2,3,4,5],"y":[30,27,13,8,6],"text":["Week: Wk1<br />Migraines: 30<br />Subject: 5<br />Subject: 5","Week: Wk2<br />Migraines: 27<br />Subject: 5<br />Subject: 5","Week: Wk3<br />Migraines: 13<br />Subject: 5<br />Subject: 5","Week: Wk4<br />Migraines:  8<br />Subject: 5<br />Subject: 5","Week: Wk5<br />Migraines:  6<br />Subject: 5<br />Subject: 5"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(0,193,159,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,193,159,1)"}},"hoveron":"points","name":"5","legendgroup":"5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(0,193,159,1)","dash":"solid"},"frame":null},{"x":[1,2,3,4,5],"y":[19,27,8,7,4],"text":["Week: Wk1<br />Migraines: 19<br />Subject: 6<br />Subject: 6","Week: Wk2<br />Migraines: 27<br />Subject: 6<br />Subject: 6","Week: Wk3<br />Migraines:  8<br />Subject: 6<br />Subject: 6","Week: Wk4<br />Migraines:  7<br />Subject: 6<br />Subject: 6","Week: Wk5<br />Migraines:  4<br />Subject: 6<br />Subject: 6"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(0,185,227,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,185,227,1)"}},"hoveron":"points","name":"6","legendgroup":"6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(0,185,227,1)","dash":"solid"},"frame":null},{"x":[1,2,3,4,5],"y":[26,16,5,2,5],"text":["Week: Wk1<br />Migraines: 26<br />Subject: 7<br />Subject: 7","Week: Wk2<br />Migraines: 16<br />Subject: 7<br />Subject: 7","Week: Wk3<br />Migraines:  5<br />Subject: 7<br />Subject: 7","Week: Wk4<br />Migraines:  2<br />Subject: 7<br />Subject: 7","Week: Wk5<br />Migraines:  5<br />Subject: 7<br />Subject: 7"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"7","legendgroup":"7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"frame":null},{"x":[1,2,3,4,5],"y":[17,18,8,1,5],"text":["Week: Wk1<br />Migraines: 17<br />Subject: 8<br />Subject: 8","Week: Wk2<br />Migraines: 18<br />Subject: 8<br />Subject: 8","Week: Wk3<br />Migraines:  8<br />Subject: 8<br />Subject: 8","Week: Wk4<br />Migraines:  1<br />Subject: 8<br />Subject: 8","Week: Wk5<br />Migraines:  5<br />Subject: 8<br />Subject: 8"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(219,114,251,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(219,114,251,1)"}},"hoveron":"points","name":"8","legendgroup":"8","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(219,114,251,1)","dash":"solid"},"frame":null},{"x":[1,2,3,4,5],"y":[26,24,14,8,9],"text":["Week: Wk1<br />Migraines: 26<br />Subject: 9<br />Subject: 9","Week: Wk2<br />Migraines: 24<br />Subject: 9<br />Subject: 9","Week: Wk3<br />Migraines: 14<br />Subject: 9<br />Subject: 9","Week: Wk4<br />Migraines:  8<br />Subject: 9<br />Subject: 9","Week: Wk5<br />Migraines:  9<br />Subject: 9<br />Subject: 9"],"type":"scatter","mode":"markers+lines","marker":{"autocolorscale":false,"color":"rgba(255,97,195,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,97,195,1)"}},"hoveron":"points","name":"9","legendgroup":"9","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","line":{"width":1.88976377952756,"color":"rgba(255,97,195,1)","dash":"solid"},"frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,5.6],"tickmode":"array","ticktext":["Wk1","Wk2","Wk3","Wk4","Wk5"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["Wk1","Wk2","Wk3","Wk4","Wk5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Week","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.45,31.45],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0,10,20,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Migraines","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"Subject","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2ec37639dbee":{"x":{},"y":{},"colour":{},"type":"scatter"},"2ec3509622e5":{"x":{},"y":{},"colour":{}}},"cur_data":"2ec37639dbee","visdat":{"2ec37639dbee":["function (y) ","x"],"2ec3509622e5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Try hovering over individual points and lines in the plot above. Also, see what happens when you click on one of the participant numbers in the legend.</p>
</section><section id="means-plots" class="level3" data-number="40.4.5"><h3 data-number="40.4.5" class="anchored" data-anchor-id="means-plots">
<span class="header-section-number">40.4.5</span> Means Plots</h3>
<p>One additional concern that we must deal with when plotting within-subjects data is the error bars. Plotting the standard error or regular confidence intervals may be misleading for making statistical inferences. This is because the values when normally calculated do not account for within subject correlation. Luckily for us there is a correction that we can make using the <code>Rmisc</code> package. Please see <a href="https://doaj.org/article/dd17c4ccc4684c9da60c02f3864d09e6">Cousineau (2005)</a> and <a href="https://doaj.org/article/011cd52c58b449c4bf169676ca704062">Morey (2008)</a> for details on this issue and subsequent correction.</p>
<p>The practical steps for this correction includes first <strong>norming</strong> the data to account for within subjects correlations.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">normedData</span> <span class="op">&lt;-</span> <span class="fu">Rmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rmisc/man/normDataWithin.html">normDataWithin</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example1_long</span>,</span>
<span>                                    measurevar <span class="op">=</span> <span class="st">"Migraines"</span>,</span>
<span>                                    idvar <span class="op">=</span> <span class="st">"Subject"</span>, </span>
<span>                                    betweenvars <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">normedData</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Subject Week Migraines MigrainesNormed
1        1  Wk1        21       21.644444
2        1  Wk2        22       22.644444
3        1  Wk3         8        8.644444
4        1  Wk4         6        6.644444
5        1  Wk5         6        6.644444
6        2  Wk1        20       21.844444
7        2  Wk2        19       20.844444
8        2  Wk3        10       11.844444
9        2  Wk4         4        5.844444
10       2  Wk5         4        5.844444
11       3  Wk1        17       21.044444
12       3  Wk2        15       19.044444
13       3  Wk3         5        9.044444
14       3  Wk4         4        8.044444
15       3  Wk5         5        9.044444
16       4  Wk1        25       18.844444
17       4  Wk2        30       23.844444
18       4  Wk3        13        6.844444
19       4  Wk4        12        5.844444
20       4  Wk5        17       10.844444
21       5  Wk1        30       26.444444
22       5  Wk2        27       23.444444
23       5  Wk3        13        9.444444
24       5  Wk4         8        4.444444
25       5  Wk5         6        2.444444
26       6  Wk1        19       19.244444
27       6  Wk2        27       27.244444
28       6  Wk3         8        8.244444
29       6  Wk4         7        7.244444
30       6  Wk5         4        4.244444
31       7  Wk1        26       28.444444
32       7  Wk2        16       18.444444
33       7  Wk3         5        7.444444
34       7  Wk4         2        4.444444
35       7  Wk5         5        7.444444
36       8  Wk1        17       20.444444
37       8  Wk2        18       21.444444
38       8  Wk3         8       11.444444
39       8  Wk4         1        4.444444
40       8  Wk5         5        8.444444
41       9  Wk1        26       23.044444
42       9  Wk2        24       21.044444
43       9  Wk3        14       11.044444
44       9  Wk4         8        5.044444
45       9  Wk5         9        6.044444</code></pre>
</div>
</div>
<p>We then calculate the se, sd, and ci values of our normed data, in this case <code>MigrainesNormed</code>.</p>
<p>The final step is to make a correction on these <code>Normed</code> values (<a href="https://doaj.org/article/011cd52c58b449c4bf169676ca704062">Morey (2008)</a>). This is done by taking the number of levels of the within factor (<code>nWithinGroups</code>) and applying the following correction:</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get the number of levels in Week:</span></span>
<span><span class="va">nWithinGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span><span class="op">(</span><span class="va">example1_long</span><span class="op">$</span><span class="va">Week</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># apply the correction factor:</span></span>
<span><span class="va">correctionFactor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">nWithinGroups</span><span class="op">/</span><span class="op">(</span><span class="va">nWithinGroups</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The range of our corrected errorbars are the sd, se, ci multiplied by this <code>correctionFactor</code>.</p>
<p>For example, the <code>sd</code> of participants’ <code>Migraines</code> in <code>Wk1</code> is:</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">normedData</span><span class="op">$</span><span class="va">MigrainesNormed</span><span class="op">[</span><span class="va">normedData</span><span class="op">$</span><span class="va">Week</span><span class="op">==</span><span class="st">"Wk1"</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">correctionFactor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.588369</code></pre>
</div>
</div>
<p>Fortunately there is a function in <code>Rmisc</code> that handles this correction for us, <code>summarySEwithin</code>. It is very similar to the <code>summarySE</code> function you are familiar with, but asks you to specify which IVs are within-subjects (<code>withinvars</code>), between-subjects(<code>betweenvars</code>) and which column contains subject IDs <code>idvar</code>. Using our original <code>example1_long</code> data:</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">Rmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rmisc/man/summarySEwithin.html">summarySEwithin</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">example1_long</span>,</span>
<span>                       measurevar <span class="op">=</span> <span class="st">"Migraines"</span>,</span>
<span>                       withinvars <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>                       betweenvars <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                       idvar <span class="op">=</span> <span class="st">"Subject"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Week N Migraines       sd        se       ci
1  Wk1 9 22.333333 3.588369 1.1961229 2.758264
2  Wk2 9 22.000000 2.993280 0.9977598 2.300838
3  Wk3 9  9.333333 1.984663 0.6615545 1.525547
4  Wk4 9  5.777778 1.474788 0.4915960 1.133623
5  Wk5 9  6.777778 2.837252 0.9457507 2.180905</code></pre>
</div>
</div>
<p>Unfortunately, to date I haven’t found a way to get this to play nice with <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. HOWEVER, there is a simple work around. Since <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> is simply summarizing our means and error values from the dataset and <code>summarySEwithin</code> is doing the exact same thing, we can simply pull these values straight from <code>summarySEwithin</code> with one MAJOR caveat. <code>summarySEwithin</code> reports the normed means and errors, however we need the original means. Note that this is not an issue when you are only dealing with within subjects factors, but if you are performing mixed ANOVA (combination within-subjects and between-subjects) these means can differ.</p>
<p>To address this problem user <code>Hause Lin</code> created a custom function <code>summarySEwithin2</code> that reports both normed and unnormed means. You can find this script on their Github site <a href="https://gist.github.com/hauselin/a83b6d2f05b0c90c0428017455f73744">here</a>. I would recommend copying and pasting the code you your own “.R” file for future use. In the meantime we can directly source this code from their site:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"https://gist.githubusercontent.com/hauselin/a83b6d2f05b0c90c0428017455f73744/raw/38e03ea4bf658d913cf11f4f1c18a1c328265a71/summarySEwithin2.R"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A similar script may be found on <a href="http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/">this ggplot tutorial site</a>, which forms the basis of this alternative plotting method.</p>
<p>Note that this “alternative” is how I in fact create most of my own ANOVA plots. But, I have my own custom function that is an adaptation of <code>summarySEwithin2</code>, I call it <code>withinSummary</code>. This is to address the fact that when writing your data up you need to use not only the actual means but also the actual se / sd / ci.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/custom_functions/withinSummary.R"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives me both the <code>$Actual</code> and <code>$Corrected</code> values. I can use the <code>descriptiveStats$Corrected</code> data for plotting, for example: First we save the output of <code>withinSummary</code> to an object:</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">descriptiveStats</span> <span class="op">&lt;-</span> <span class="fu">withinSummary</span><span class="op">(</span>data<span class="op">=</span><span class="va">example1_long</span>,</span>
<span>                                  measurevar <span class="op">=</span> <span class="st">"Migraines"</span>,</span>
<span>                                  withinvars <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>                                  idvar <span class="op">=</span> <span class="st">"Subject"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:lubridate':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    transpose</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">descriptiveStats</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Actual
  Week N Migraines       sd       se       ci
1  Wk1 9 22.333333 4.582576 1.527525 3.522480
2  Wk2 9 22.000000 5.338539 1.779513 4.103564
3  Wk3 9  9.333333 3.391165 1.130388 2.606680
4  Wk4 9  5.777778 3.419714 1.139905 2.628625
5  Wk5 9  6.777778 4.116363 1.372121 3.164117

$Corrected
  Week N Migraines MigrainesNormed       sd        se       ci
1  Wk1 9 22.333333       22.333333 3.588369 1.1961229 2.758264
2  Wk2 9 22.000000       22.000000 2.993280 0.9977598 2.300838
3  Wk3 9  9.333333        9.333333 1.984663 0.6615545 1.525547
4  Wk4 9  5.777778        5.777778 1.474788 0.4915960 1.133623
5  Wk5 9  6.777778        6.777778 2.837252 0.9457507 2.180905</code></pre>
</div>
</div>
<p>From here we can refer directly to <code>descriptiveStats</code> in constructing the <code>ggplot</code>. When plotting you use the <code>Corrected</code> values .</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">descriptiveStats</span><span class="op">$</span><span class="va">Corrected</span>, <span class="co"># using the corrected table to make the plots</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Week</span>,</span>
<span>                y <span class="op">=</span> <span class="va">Migraines</span>, </span>
<span>                group<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now to construct the plot. rather than using <code>summary_stat()</code> we directly call each <code>geom</code>. For example, adding the means and as points:</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Connecting those points with lines:</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Adding error bars (SE):</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">Migraines</span><span class="op">-</span><span class="va">se</span>, ymax<span class="op">=</span><span class="va">Migraines</span><span class="op">+</span><span class="va">se</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>note that above I set width of the error bars to 0 to keep consistent with how we’ve been plotting pointranges. However, if you want caps, you can change the width. I recommend a width no higher than 0.2.</p>
<p>From here you can use your familiar commands to whip it into APA format!</p>
</section><section id="building-the-model-using-afex" class="level3" data-number="40.4.6"><h3 data-number="40.4.6" class="anchored" data-anchor-id="building-the-model-using-afex">
<span class="header-section-number">40.4.6</span> building the model using afex:</h3>
<p>Running a WS ANOVA is just like running a BS ANOVA in <code>afex</code> (see the last walkthrough). We call in our within subjects factors using the <code>within=</code> argument.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_aov</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Subject"</span>, </span>
<span>                           dv <span class="op">=</span> <span class="st">"Migraines"</span>, </span>
<span>                           data <span class="op">=</span> <span class="va">example1_long</span>,</span>
<span>                           between <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           within <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>                           type <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                           return <span class="op">=</span> <span class="st">"afex_aov"</span>, </span>
<span>                           anova_table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>es <span class="op">=</span> <span class="st">"pes"</span><span class="op">)</span></span>
<span>                           <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="assumptions-checks-normality" class="level3" data-number="40.4.7"><h3 data-number="40.4.7" class="anchored" data-anchor-id="assumptions-checks-normality">
<span class="header-section-number">40.4.7</span> assumptions checks: normality</h3>
<p>We can then use the model, <code>within_aov</code> to run the requisite assumption checks. As before, the model plays nicely with <code>performance</code>, but the blanket <code>check_model</code> will not work with <code>afex</code>. Instead we can do a piecemeal check for normality along with visualizations.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># visualization against histogram</span></span>
<span><span class="va">within_aov</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_normality.html">check_normality</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># qq visualization</span></span>
<span><span class="va">within_aov</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_normality.html">check_normality</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="st">"qq"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># shapiro-wilkes test</span></span>
<span><span class="va">within_aov</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_normality.html">check_normality</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">show</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.206).</code></pre>
</div>
</div>
</section><section id="assumptions-checks-sphericity" class="level3" data-number="40.4.8"><h3 data-number="40.4.8" class="anchored" data-anchor-id="assumptions-checks-sphericity">
<span class="header-section-number">40.4.8</span> assumptions checks: sphericity</h3>
<p>Just like the paired <span class="math inline">\(t\)</span> test from a few weeks back, the RM-ANOVA does not have an explicit check for homogeneity of variance. Instead, RM ANOVA introduces a new test of assumptions that you must run, the test of <strong>Sphericity</strong>. Indeed, this test is run <strong>instead</strong> of the check for homogeneity. This is because technically a WS ANOVA violates the assumption of independence of scores, and thus inflates the likelihood of a homogeneity of variances violation. Essentially, we give up on trying to hold onto this assumption and instead direct our interests towards maintaining <strong>Sphericity</strong>. Importantly, if we do violate sphericity, there is a clean and relatively agreed upon step that we must take with our analysis.</p>
<p>There are two ways to test for sphericity, (1) simply using and adjusting based upon the summary output of our ANOVA model, or (2) we can again use the <code>performance</code> library. <strong>I typically just use method 1, so that’s all I will show you here to avoid confusion.</strong></p>
<p>There is an argument to be made that you should always make a correction to guard against deviations from sphericity (see below). The correction becomes larger the further your data is from sphericity. However, standard practice in the psychology literature is to only apply the correction if our data fail the Mauchly’s Test (<em>p</em> &lt; .05) <a href="https://statistics.laerd.com/statistical-guides/sphericity-statistical-guide.php">link</a>. The outcome of this test can be obtained by using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function on our model.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">within_aov</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.Anova.mlm(object$Anova, multivariate = FALSE): HF eps &gt; 1
treated as 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

            Sum Sq num Df Error SS den Df F value    Pr(&gt;F)    
(Intercept) 7893.7      1   486.71      8 129.747 3.186e-06 ***
Week        2449.2      4   230.40     32  85.042 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

     Test statistic p-value
Week        0.28236 0.53699


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

      GG eps Pr(&gt;F[GG])    
Week 0.68446  5.773e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       HF eps  Pr(&gt;F[HF])
Week 1.075624 1.39444e-16</code></pre>
</div>
</div>
<p>This gives us our original ANOVA table with non-corrected degrees of freedom, the Mauchly Test, and the Greenhouse-Geisser and Huynh-Feldt corrections. <strong>The Mauchly Test is our test for Sphericity</strong>. In this case the Mauchly Test <code>p = .54</code>, so no corrections are necessary. If your elect to make the correction (i.e., the data fails Mauchly’s Test) then you could multiply your original degrees of freedom by the GG eps (or HF eps). The p-value next to the correction values tells you the p-value for your ANOVA effect assuming corrections. In this case even with the corrections the effect of Week is significant.</p>
<p>If you want to get the corrected degrees of freedom, you can simply take a look at the model itself:</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_aov</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: Migraines
  Effect          df   MSE         F  pes p.value
1   Week 2.74, 21.90 10.52 85.04 *** .914   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>* note that the output includes the sphericity correction: GG.</p>
<p>Alternatively you could just rerun the <code>afex</code> function and specifying the <code>correction=</code> call. You can either specify the “GG” correction:</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## GG correction:</span></span>
<span><span class="va">within_aov_gg</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Subject"</span>, </span>
<span>                           dv <span class="op">=</span> <span class="st">"Migraines"</span>, </span>
<span>                           data <span class="op">=</span> <span class="va">example1_long</span>,</span>
<span>                           between <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           within <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>                           type <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                           return <span class="op">=</span> <span class="st">"afex_aov"</span>, </span>
<span>                           anova_table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>es <span class="op">=</span> <span class="st">"pes"</span>,</span>
<span>                                            correction<span class="op">=</span><span class="st">"GG"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">within_aov_gg</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: Migraines
  Effect          df   MSE         F  pes p.value
1   Week 2.74, 21.90 10.52 85.04 *** .914   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<p>or the “HF” correction:</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## HF correction (note that any HF eps &gt; 1 will be treated as 1):</span></span>
<span><span class="va">within_aov_hf</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Subject"</span>, </span>
<span>                           dv <span class="op">=</span> <span class="st">"Migraines"</span>, </span>
<span>                           data <span class="op">=</span> <span class="va">example1_long</span>,</span>
<span>                           between <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           within <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>                           type <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                           return <span class="op">=</span> <span class="st">"afex_aov"</span>, </span>
<span>                           anova_table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>es <span class="op">=</span> <span class="st">"pes"</span>, </span>
<span>                                            correction<span class="op">=</span><span class="st">"HF"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: HF eps &gt; 1 treated as 1</code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_aov_hf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: Migraines
  Effect    df  MSE         F  pes p.value
1   Week 4, 32 7.20 85.04 *** .914   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: HF </code></pre>
</div>
</div>
</section><section id="running-post-hoc-analyses-and-follow-ups" class="level3" data-number="40.4.9"><h3 data-number="40.4.9" class="anchored" data-anchor-id="running-post-hoc-analyses-and-follow-ups">
<span class="header-section-number">40.4.9</span> running post-hoc analyses and follow-ups</h3>
<p>Post-hoc comparisons of means take a different form for repeated measures ANOVA. Typical methods such as Tukey HSD were designed for between-subjects effects, where it makes sense (assuming homogeneity of variance) to use a pooled error term. <strong>However, for within-subjects (or repeated measures) effects, the error term is the Treatment x Subjects interaction, and the nature of the TxS interaction across all treatment levels can be very different than it is for any particular pair of treatment levels</strong>.</p>
<p>The typical recommendation (more detail on this in the following walkthrough) is to carry out pair-wise contrasts for a within-subjects factor using ordinary paired tests with an error term based only on the levels being compared .</p>
<p>Because of this, post-hoc analysis involving repeated measures requires an additional argument in <code>emmeans()</code>; invoking <code>model="multivariate"</code></p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">emmeans</span><span class="op">(</span><span class="va">within_aov</span>, specs <span class="op">=</span> <span class="va">pairwise</span><span class="op">~</span><span class="va">Week</span>, model<span class="op">=</span><span class="st">"multivariate"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 Week emmean   SE df lower.CL upper.CL
 Wk1   22.33 1.53  8    18.81    25.86
 Wk2   22.00 1.78  8    17.90    26.10
 Wk3    9.33 1.13  8     6.73    11.94
 Wk4    5.78 1.14  8     3.15     8.41
 Wk5    6.78 1.37  8     3.61     9.94

Confidence level used: 0.95 

$contrasts
 contrast  estimate    SE df t.ratio p.value
 Wk1 - Wk2    0.333 1.700  8   0.196  0.9996
 Wk1 - Wk3   13.000 1.247  8  10.423  &lt;.0001
 Wk1 - Wk4   16.556 1.375  8  12.036  &lt;.0001
 Wk1 - Wk5   15.556 1.608  8   9.672  0.0001
 Wk2 - Wk3   12.667 1.179  8  10.748  &lt;.0001
 Wk2 - Wk4   16.222 0.909  8  17.837  &lt;.0001
 Wk2 - Wk5   15.222 1.441  8  10.562  &lt;.0001
 Wk3 - Wk4    3.556 0.818  8   4.345  0.0154
 Wk3 - Wk5    2.556 1.156  8   2.211  0.2663
 Wk4 - Wk5   -1.000 0.882  8  -1.134  0.7857

P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
</div>
<p>Note that the <code>df</code> (df = 8) of these tests are <strong><em>NOT</em></strong> the error df (df = 22) from the omnibus ANOVA.</p>
</section><section id="example-1-write-up" class="level3" data-number="40.4.10"><h3 data-number="40.4.10" class="anchored" data-anchor-id="example-1-write-up">
<span class="header-section-number">40.4.10</span> Example 1 write up</h3>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># adding to the plot we created above</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">theme_cowplot</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Figure 1.</em> Number of migraines as a function of Week. Note that Weeks 1 and 2 are baseline while Weeks 3, 4, and 5 are post relaxation therapy treatment.</p>
<blockquote class="blockquote">
<p>To test whether relaxation therapy had a positive effect for migraine suffers, we analyzed the number of migraines each individual reported over a 5 week period. The first two weeks were used as a baseline to establish a typical week for each person. The remaining three weeks each person was lead through relaxation therapy techniques. These data were submitted to a within-subjects ANOVA with Week as a factor.</p>
<p>Post hoc comparisions demonstrated the effectiveness of our treatment. While the number of migraines remained indifferent during the first two weeks (TukeyHSD, <em>p</em> &gt;.05) there was a significant decrease in the number of migraines post treatment. As seen in Figure 1, the number of migraines in Weeks 3, 4, 5 we significantly lower than Weeks 1 and 2 (<em>p</em>s &lt; .05).</p>
</blockquote>
<p>** note that you don’t have to worry about the sphericity violation as it relates to the post hoc analyses—as you are only comparing two levels.</p>
</section></section><section id="example-2" class="level2" data-number="40.5"><h2 data-number="40.5" class="anchored" data-anchor-id="example-2">
<span class="header-section-number">40.5</span> EXAMPLE 2</h2>
<p>Let’s take a look at another example, using a experimental paradigm we are familiar with, scores as a function of lecture type.</p>
<section id="loading-in-the-data-1" class="level3" data-number="40.5.1"><h3 data-number="40.5.1" class="anchored" data-anchor-id="loading-in-the-data-1">
<span class="header-section-number">40.5.1</span> loading in the data</h3>
<p>You note that this data is already in long format so no need to adjust.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">example2_long</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/practice_datasets/withinEx2.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 36 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): Lecture
dbl (2): Subject, Score

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">example2_long</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 3
   Subject Lecture  Score
     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
 1       1 Physical    53
 2       2 Physical    49
 3       3 Physical    47
 4       4 Physical    42
 5       5 Physical    51
 6       6 Physical    34
 7       7 Physical    44
 8       8 Physical    48
 9       9 Physical    35
10      10 Physical    18
# ℹ 26 more rows</code></pre>
</div>
</div>
</section><section id="plotting-the-data-1" class="level3" data-number="40.5.2"><h3 data-number="40.5.2" class="anchored" data-anchor-id="plotting-the-data-1">
<span class="header-section-number">40.5.2</span> plotting the data</h3>
<p>Let’s plot this data. Below, I put together the code for the means plot. But why don’t you try to create a Spaghetti plot.</p>
<p>This time for the means plot I’ll make my points a little larger, lines a little thicker, and add caps to the error bars:</p>
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">descriptiveStats</span> <span class="op">&lt;-</span> <span class="fu">withinSummary</span><span class="op">(</span>data<span class="op">=</span><span class="va">example2_long</span>,measurevar <span class="op">=</span> <span class="st">"Score"</span>,withinvars <span class="op">=</span> <span class="st">"Lecture"</span>,idvar <span class="op">=</span> <span class="st">"Subject"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Automatically converting the following non-factors to factors: Lecture</code></pre>
</div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">descriptiveStats</span><span class="op">$</span><span class="va">Corrected</span>,mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Lecture</span>,y <span class="op">=</span> <span class="va">Score</span>, group<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">Score</span><span class="op">-</span><span class="va">se</span>, ymax<span class="op">=</span><span class="va">Score</span><span class="op">+</span><span class="va">se</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_cowplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span>, lineheight <span class="op">=</span> <span class="fl">.55</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"grey50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Lecture"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span> <span class="op">(</span><span class="st">"Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.25</span>,<span class="fl">.25</span>,<span class="fl">.25</span><span class="op">)</span>,<span class="st">"in"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  </span>
<span>  <span class="co"># stack legend boxes horizontally:</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.box <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12_2-repeated_measures_anova_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Maybe not the best plot, but wanted to show you how to tweak things.</p>
</section><section id="running-the-anova" class="level3" data-number="40.5.3"><h3 data-number="40.5.3" class="anchored" data-anchor-id="running-the-anova">
<span class="header-section-number">40.5.3</span> running the ANOVA:</h3>
<p>As before, let’s run this using afex:</p>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_aov</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"Subject"</span>, </span>
<span>  dv <span class="op">=</span> <span class="st">"Score"</span>, </span>
<span>  data <span class="op">=</span> <span class="va">example2_long</span>,</span>
<span>  between <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="st">"Lecture"</span>,</span>
<span>  type <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  return <span class="op">=</span> <span class="st">"afex_aov"</span>, </span>
<span>  anova_table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>es <span class="op">=</span> <span class="st">"pes"</span>, correction<span class="op">=</span><span class="st">"none"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">within_aov</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

            Sum Sq num Df Error SS den Df F value    Pr(&gt;F)    
(Intercept)  40401      1   3531.7     11 125.836 2.319e-07 ***
Lecture       1194      2   1067.3     22  12.305  0.000259 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

        Test statistic  p-value
Lecture        0.41524 0.012345


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

         GG eps Pr(&gt;F[GG])   
Lecture 0.63101    0.00225 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

           HF eps Pr(&gt;F[HF])
Lecture 0.6748954 0.00173583</code></pre>
</div>
</div>
<p>You’ll notice that in this example the data failed the Mauchly Test for Sphericity (<span class="math inline">\(p\)</span> = .0123). As I mentioned above in this case you’ll need to make the appropriate corrections. GG corrections are the “industry standard” (you typically see these in psych literature). HF corrections are not as conservative, and are appropriate in instances where the GG eps &gt; 0.75. In this case we’ll use the GG correction. My advice, just rerun the ANOVA with <code>correction="GG"</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">within_aov</span> <span class="op">&lt;-</span> <span class="fu">afex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/afex/man/aov_car.html">aov_ez</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"Subject"</span>, </span>
<span>  dv <span class="op">=</span> <span class="st">"Score"</span>, </span>
<span>  data <span class="op">=</span> <span class="va">example2_long</span>,</span>
<span>  between <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  within <span class="op">=</span> <span class="st">"Lecture"</span>,</span>
<span>  type <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  return <span class="op">=</span> <span class="st">"afex_aov"</span>, </span>
<span>  anova_table<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>es <span class="op">=</span> <span class="st">"pes"</span>, </span>
<span>                   correction<span class="op">=</span><span class="st">"GG"</span>,</span>
<span>                   sig_symbols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">within_aov</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

            Sum Sq num Df Error SS den Df F value    Pr(&gt;F)    
(Intercept)  40401      1   3531.7     11 125.836 2.319e-07 ***
Lecture       1194      2   1067.3     22  12.305  0.000259 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

        Test statistic  p-value
Lecture        0.41524 0.012345


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

         GG eps Pr(&gt;F[GG])   
Lecture 0.63101    0.00225 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

           HF eps Pr(&gt;F[HF])
Lecture 0.6748954 0.00173583</code></pre>
</div>
</div>
</section><section id="post-hocs-and-follow-ups" class="level3" data-number="40.5.4"><h3 data-number="40.5.4" class="anchored" data-anchor-id="post-hocs-and-follow-ups">
<span class="header-section-number">40.5.4</span> post-hocs and follow-ups</h3>
<p>Remember again, that any simple effects / post hoc comparisons need to be “multivariate”)</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">emmeans</span><span class="op">(</span><span class="va">within_aov</span>, </span>
<span>        spec<span class="op">=</span> <span class="st">"Lecture"</span>, </span>
<span>        model <span class="op">=</span> <span class="st">"multivariate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span>adjust<span class="op">=</span><span class="st">"tukey"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast           estimate   SE df t.ratio p.value
 Physical - Social      14.0 3.01 11   4.651  0.0019
 Physical - History      5.5 1.52 11   3.618  0.0104
 Social - History       -8.5 3.59 11  -2.368  0.0875

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
</section><section id="example-write-up" class="level3" data-number="40.5.5"><h3 data-number="40.5.5" class="anchored" data-anchor-id="example-write-up">
<span class="header-section-number">40.5.5</span> Example write up</h3>
<p>Again I need to get my summary stats for the write up. Since I’m not doing any custom contrasts I can just pull the cell values from my summary table:</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">descriptiveStats</span><span class="op">$</span><span class="va">Actual</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Lecture  N Score        sd       se       ci
1  History 12  34.5  8.393721 2.423058 5.333116
2 Physical 12  40.0 10.795622 3.116428 6.859211
3   Social 12  26.0 15.201675 4.388345 9.658683</code></pre>
</div>
</div>
<p>And now for the write-up:</p>
<p>… to test this hypothesis we ran a within subjects ANOVA. Due to a violation of the sphericity assumption, we used Greenhouse-Geisser corrected degress of freedom. Our analysis revealed a significant effect for Lecture, <span class="math inline">\(F\)</span>(1.26, 13.88) = 12.31, <span class="math inline">\(p\)</span> = .002, <span class="math inline">\(\eta_p^2\)</span> = .53. Post-hoc analyses revealed participants scores in the Physical condition (<span class="math inline">\(M\)</span> ± <span class="math inline">\(SE\)</span>: 40.0 ± 3.12) was significantly greater than both History (34.5 ± 2.4) and Social (26.0 ± 4.4) scores (<span class="math inline">\(p\)</span>s &lt; .05). History and Social were not different from one another.</p>
<p>Take a look at the next walkthrough for an example of factorial repeated measures ANOVA.</p>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../week12/12_1-afex_ANOVA.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">afex is for ANOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../week12/12_3-factorial_rma.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Factorial RM-ANOVA and simple effects</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb89" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Within Subjects / Repeated Measures ANOVA"</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Within-Subject v. Between Subjects</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>Up until now we have considered ANOVA in between subjects designs; when data at each level of each factor is from a **different group** of participants. This week we more onto within-subjects designs. As we mentioned in class we have a within-subject design whenever data from the same participants exists on at least two levels of a factor (or analogously occupied at least two cells within our interaction matrix).</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>To contrast some important distinctions let's revisit our familiar data set contrasting test outcomes for students as a function of Lecture. I realize before, Lecture was crossed with at least one other factor, but for the sake on simplicity let's just consider data from this single factor. The goal of this first section is to contrast results as a function whether this data is considered within-subjects or between-subjects.</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>This walkthough assumes you have the following packages:</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>               afex,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>               cowplot,</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>               emmeans)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>Okay, not let's load in some data:</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>within_between <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/practice_datasets/within_between.csv"</span>)</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>within_between</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a><span class="fu">### Within v Between ANOVA</span></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>So we have our dataset <span class="in">`within_between`</span>. You'll note that there are two subjects columns <span class="in">`WithinSubjects`</span> which imagines 12 participants each going through all 3 Lecture types and <span class="in">`BetweenSubjects`</span> where each participant (N=36) is assigned to a single Lecture type. Previously, we might have treated this as a between subjects design. Looking at the <span class="in">`ezDesign`</span> of this design we see that every <span class="in">`BetweenSubject`</span> is assigned to a single condition (as evidenced by count = 1)</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>ez<span class="sc">::</span><span class="fu">ezDesign</span>(within_between,<span class="at">y=</span>Lecture,<span class="at">x=</span>BetweenSubjects_ID)</span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>Skipping past the preliminaries (e.g., testing for assumptions) and straight to running the BS ANOVA:</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a>between_aov <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score<span class="sc">~</span>Lecture, <span class="at">data =</span> within_between)</span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>sjstats<span class="sc">::</span><span class="fu">anova_stats</span>(between_aov)[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>However, let's assume instead that this data set comes a within design. That is, instead of different participants in each <span class="in">`Lecture`</span> group, the same group of people went through all three lectures:</span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a>ez<span class="sc">::</span><span class="fu">ezDesign</span>(within_between,<span class="at">y=</span>Lecture,<span class="at">x=</span>WithinSubjects_ID)</span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a>We see that the <span class="in">`ezDesign`</span> has changed. Instead of 36 participants each individually assigned to a single condition, we have 12 participants each assigned to all three conditions for a single trial (measure). As mentioned in class, conceptually, a **within subjects design considers participant as a pseudo factor** with each individual participant as a level. To fully capture this we should *factorize* our <span class="in">`WithinSubjects_ID`</span> column.</span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a>Running the within-subjects ANOVA:</span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true" tabindex="-1"></a>within_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score<span class="sc">~</span>Lecture <span class="sc">+</span> <span class="fu">factor</span>(WithinSubjects_ID), <span class="at">data =</span> within_between)</span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true" tabindex="-1"></a>sjstats<span class="sc">::</span><span class="fu">anova_stats</span>(within_lm)[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true" tabindex="-1"></a>Before continuing on, I want you to take a moment and think about what the specification of the formula in the <span class="in">`lm()`</span> model above actually means. Not only are we using <span class="in">`Lecture`</span> as a predictor, but we are also treating participant <span class="in">`WithinSubjects_ID`</span> as a factor as well. That is not only is the model accounting for the variation moving between levels of <span class="in">`Lecture`</span>, but also the model is accounting for variability moving between each participant. If you want to continue to use the <span class="in">`lm()`</span> method for model building, you will need to include participant as a factor in the model. However, I would not recommend continuing with <span class="in">`lm()`</span>, especially as you end up with more complex within-subjects designs. In your future, you will probably elect to run either a mixed effects model using <span class="in">`lmer`</span> or a repeated measures ANOVA. Mixed effect modeling is outside of the scope of what we cover this semester (although we've laid some foundations for it). As for repeated measures ANOVA, I would recommend moving onto a new method for running this in <span class="in">`R`</span>. In the previous walkthrough I introduced <span class="in">`aov_ez()`</span> from the <span class="in">`afex`</span> library.</span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true" tabindex="-1"></a>This might be a good time to start running ANOVA using <span class="in">`afex::aov_ez()`</span>. Let's re-run both of our models using <span class="in">`afex::ez()`</span>:</span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-74"><a href="#cb89-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-75"><a href="#cb89-75" aria-hidden="true" tabindex="-1"></a>between_aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"BetweenSubjects_ID"</span>, <span class="co"># 36 people in 3 groups</span></span>
<span id="cb89-76"><a href="#cb89-76" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dv =</span> <span class="st">"Score"</span>, </span>
<span id="cb89-77"><a href="#cb89-77" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> within_between,</span>
<span id="cb89-78"><a href="#cb89-78" aria-hidden="true" tabindex="-1"></a>                           <span class="at">between =</span> <span class="st">"Lecture"</span>, <span class="co"># Lecture as between predictor</span></span>
<span id="cb89-79"><a href="#cb89-79" aria-hidden="true" tabindex="-1"></a>                           <span class="at">within =</span> <span class="cn">NULL</span>,</span>
<span id="cb89-80"><a href="#cb89-80" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="dv">3</span>, </span>
<span id="cb89-81"><a href="#cb89-81" aria-hidden="true" tabindex="-1"></a>                           <span class="at">return =</span> <span class="st">"afex_aov"</span>, </span>
<span id="cb89-82"><a href="#cb89-82" aria-hidden="true" tabindex="-1"></a>                           <span class="at">anova_table=</span><span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>) <span class="co"># partial eta sq.</span></span>
<span id="cb89-83"><a href="#cb89-83" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb89-84"><a href="#cb89-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-85"><a href="#cb89-85" aria-hidden="true" tabindex="-1"></a>within_aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"WithinSubjects_ID"</span>, <span class="co"># 12 people going through 3 conditions</span></span>
<span id="cb89-86"><a href="#cb89-86" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dv =</span> <span class="st">"Score"</span>, </span>
<span id="cb89-87"><a href="#cb89-87" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> within_between,</span>
<span id="cb89-88"><a href="#cb89-88" aria-hidden="true" tabindex="-1"></a>                           <span class="at">between =</span> <span class="cn">NULL</span>,</span>
<span id="cb89-89"><a href="#cb89-89" aria-hidden="true" tabindex="-1"></a>                           <span class="at">within =</span> <span class="st">"Lecture"</span>, <span class="co"># Lecture as within predictor</span></span>
<span id="cb89-90"><a href="#cb89-90" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="dv">3</span>, </span>
<span id="cb89-91"><a href="#cb89-91" aria-hidden="true" tabindex="-1"></a>                           <span class="at">return =</span> <span class="st">"afex_aov"</span>, </span>
<span id="cb89-92"><a href="#cb89-92" aria-hidden="true" tabindex="-1"></a>                           <span class="at">anova_table=</span><span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>) <span class="co"># partial eta sq.</span></span>
<span id="cb89-93"><a href="#cb89-93" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb89-94"><a href="#cb89-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-95"><a href="#cb89-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-96"><a href="#cb89-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-97"><a href="#cb89-97" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing BS v WS ANOVA</span></span>
<span id="cb89-98"><a href="#cb89-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-99"><a href="#cb89-99" aria-hidden="true" tabindex="-1"></a>Okay, returning to our model outcomes. Keep in mind in both cases we are using the exact same scores.</span>
<span id="cb89-100"><a href="#cb89-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-101"><a href="#cb89-101" aria-hidden="true" tabindex="-1"></a>Here is our between ANOVA:</span>
<span id="cb89-102"><a href="#cb89-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-105"><a href="#cb89-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-106"><a href="#cb89-106" aria-hidden="true" tabindex="-1"></a>between_aov</span>
<span id="cb89-107"><a href="#cb89-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-108"><a href="#cb89-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-109"><a href="#cb89-109" aria-hidden="true" tabindex="-1"></a>And here is our within ANOVA</span>
<span id="cb89-110"><a href="#cb89-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-113"><a href="#cb89-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-114"><a href="#cb89-114" aria-hidden="true" tabindex="-1"></a>within_aov</span>
<span id="cb89-115"><a href="#cb89-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-116"><a href="#cb89-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-117"><a href="#cb89-117" aria-hidden="true" tabindex="-1"></a>In both of these cases the data is exactly the same. What has changed is how we parse the variance (you'll notice that the denominator degrees of freedom are different for the second ANOVA). In a within design, we need to take into account the "within-subject" variance. That is how individual subjects vary from one level of treatment to the other. In this respect, within designs are typically more powerful than analogous between designs. While the inherent differences between individual subjects is present in both types of designs, your within-subjects ANOVA model includes it in its analysis. In the present example, this increase in power is reflected by the lower MSE (48.52 v. 139.36) and subsequently, larger F-value (12.31 v. 4.28) and effect size (0.53 v. 0.21) in our within-subjects analysis.</span>
<span id="cb89-118"><a href="#cb89-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-119"><a href="#cb89-119" aria-hidden="true" tabindex="-1"></a>Well if that's the case why not run within-subject (WS) designs all of the time. Well, typically psychologists do when the subject lends itself to WS-designs. BUT there are certainly times when they are not practical, for example, if you are concerned about learning, practice, or carryover effects where exposure to a treatment on one level might impact the other levels---if you were studying radiation poisoning and had a placebo v. radiation dose condition, it be likely that you wouldn't run your experiment as a within---or at the very least you wouldn't give them the radiation first. It would also be likely that you'd be in violation several standards of ethics.</span>
<span id="cb89-120"><a href="#cb89-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-121"><a href="#cb89-121" aria-hidden="true" tabindex="-1"></a>(You may also note that a correction is taking place on <span class="in">`within_aov`</span> giving us those odd degrees of freedom. We'll talk more about that in a bit.)</span>
<span id="cb89-122"><a href="#cb89-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-123"><a href="#cb89-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## a note on Univariate v. Multivariate methods</span></span>
<span id="cb89-124"><a href="#cb89-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-125"><a href="#cb89-125" aria-hidden="true" tabindex="-1"></a>Univariate v. multivariate statistical methods refer to the number of dependent variables associated with the model per fundamental unit of analysis. In psychology research the fundamental unit of analysis is typically the participant---measures are taken at the level of the participant. A univariate model has one dependent variable whereas a multivariate method has two or more per participant. Perhaps some of you are more familiar with this distinction in the context on One-way MANOVA... which analyzes two or more dependent variables simultaneously in an ANOVA design. MANOVA (multivariate ANOVA) is preferred to running seperate univariate ANOVAs if one believes that the dependent variables involved are somehow correlated with one another. In this case MANOVA factors these correlations into the model testing the IVs.</span>
<span id="cb89-126"><a href="#cb89-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-127"><a href="#cb89-127" aria-hidden="true" tabindex="-1"></a>I bring all of this up as one way to conceptualize repeated-measures ANOVA is as multivariate method. Multiple measures are taken at the level of the participant. This will factor into our discussion of follow-up analyses.</span>
<span id="cb89-128"><a href="#cb89-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-129"><a href="#cb89-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## a note on sphericity for Repeated measures ANOVA</span></span>
<span id="cb89-130"><a href="#cb89-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-131"><a href="#cb89-131" aria-hidden="true" tabindex="-1"></a>In addition to the assumptions that we are familiar with, repeated-measures ANOVA has the additional assumption of Spherecity of Variance / Co-variance. We talked at length in class re: Spherecity of Variance / Co-variance so I suggest revisiting the slides for our example. At the same time there are debates as to the importance of sphericity in the subjects data. One alternative method that avoids these issues is to invoke mixed models (e.g., <span class="in">`lmer`</span>). However, if you really want to go down the rabbit hole check out <span class="co">[</span><span class="ot">Doug Bates reponse on appropriate dfs and p-values in `lmer`</span><span class="co">](https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html)</span>. You'll note that these discussions were ten years ago and are still being debated (see <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.reddit.com/r/AskStatistics/comments/2x9ipp/linear_mixed_effect_models_and_pvalues_r/)</span>. That said, you may be seeing mixed models in your near future (i.e., next semester)</span>
<span id="cb89-132"><a href="#cb89-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-133"><a href="#cb89-133" aria-hidden="true" tabindex="-1"></a>For now, we won't go down the rabbit hole and just focus on the practical issues confronted when running a repeated-measures ANOVA.</span>
<span id="cb89-134"><a href="#cb89-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-135"><a href="#cb89-135" aria-hidden="true" tabindex="-1"></a><span class="fu">## EXAMPLE 1</span></span>
<span id="cb89-136"><a href="#cb89-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-137"><a href="#cb89-137" aria-hidden="true" tabindex="-1"></a>To start, we will use data related to the effectiveness of relaxation therapy to the number of episodes that chronic migraine sufferers reported. Data was collected from each subject over the course of 5 weeks. After week 2 the therapy treatment was implemented effectively dividing the 5 weeks into two phases, Pre (Weeks 1 &amp; 2) and Post (Weeks 3,4, &amp; 5).</span>
<span id="cb89-138"><a href="#cb89-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-139"><a href="#cb89-139" aria-hidden="true" tabindex="-1"></a><span class="fu">### loading in the data:</span></span>
<span id="cb89-140"><a href="#cb89-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-143"><a href="#cb89-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-144"><a href="#cb89-144" aria-hidden="true" tabindex="-1"></a>example1 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab14-3.dat"</span>, </span>
<span id="cb89-145"><a href="#cb89-145" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb89-146"><a href="#cb89-146" aria-hidden="true" tabindex="-1"></a>example1</span>
<span id="cb89-147"><a href="#cb89-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-148"><a href="#cb89-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-149"><a href="#cb89-149" aria-hidden="true" tabindex="-1"></a>You'll notice that the data set above is in wide format. Each subject is on a single row and each week is in its own column. Note that **this is the preferred format for within subjects analysis for SPSS**. However in <span class="in">`R`</span> we want it in long format.</span>
<span id="cb89-150"><a href="#cb89-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-153"><a href="#cb89-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-154"><a href="#cb89-154" aria-hidden="true" tabindex="-1"></a>example1_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(example1,</span>
<span id="cb89-155"><a href="#cb89-155" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cols =</span> <span class="sc">-</span>Subject,</span>
<span id="cb89-156"><a href="#cb89-156" aria-hidden="true" tabindex="-1"></a>                              <span class="at">names_to =</span> <span class="st">"Week"</span>, </span>
<span id="cb89-157"><a href="#cb89-157" aria-hidden="true" tabindex="-1"></a>                              <span class="at">values_to =</span> <span class="st">"Migraines"</span>)</span>
<span id="cb89-158"><a href="#cb89-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-159"><a href="#cb89-159" aria-hidden="true" tabindex="-1"></a>example1_long<span class="sc">$</span>Week <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(example1_long<span class="sc">$</span>Week)</span>
<span id="cb89-160"><a href="#cb89-160" aria-hidden="true" tabindex="-1"></a>example1_long<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(example1_long<span class="sc">$</span>Subject)</span>
<span id="cb89-161"><a href="#cb89-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-162"><a href="#cb89-162" aria-hidden="true" tabindex="-1"></a>example1_long</span>
<span id="cb89-163"><a href="#cb89-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-164"><a href="#cb89-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-165"><a href="#cb89-165" aria-hidden="true" tabindex="-1"></a>Ok, much better, each Subject × Week observation is on a single row.</span>
<span id="cb89-166"><a href="#cb89-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-167"><a href="#cb89-167" aria-hidden="true" tabindex="-1"></a><span class="fu">### plotting the data</span></span>
<span id="cb89-168"><a href="#cb89-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-169"><a href="#cb89-169" aria-hidden="true" tabindex="-1"></a>In addition to plotting your means, one crucial step is to plot the changes in the within-subject (repeated measures) variable at the participant-level. This is especially useful for discerning whether the pattern of results is roughly similar for all participants -OR- if, instead there is large individual variability in the direction of the effect. In other words, "is your manipulation having roughly the same effect for every participant OR is the effect drastically different for participants.</span>
<span id="cb89-170"><a href="#cb89-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-171"><a href="#cb89-171" aria-hidden="true" tabindex="-1"></a>There are 2 ways to do this: 1. the Facet plot or 2. Spaghetti Plot.</span>
<span id="cb89-172"><a href="#cb89-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-173"><a href="#cb89-173" aria-hidden="true" tabindex="-1"></a><span class="fu">### the Facet plot</span></span>
<span id="cb89-174"><a href="#cb89-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-175"><a href="#cb89-175" aria-hidden="true" tabindex="-1"></a>Each window / facet is for a single subject (S1-S9):</span>
<span id="cb89-176"><a href="#cb89-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-179"><a href="#cb89-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-180"><a href="#cb89-180" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> example1_long, <span class="fu">aes</span>(<span class="at">x=</span>Week, <span class="at">y=</span>Migraines, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb89-181"><a href="#cb89-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb89-182"><a href="#cb89-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb89-183"><a href="#cb89-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Subject, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb89-184"><a href="#cb89-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-185"><a href="#cb89-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-186"><a href="#cb89-186" aria-hidden="true" tabindex="-1"></a><span class="fu">### the Spaghetti Plot</span></span>
<span id="cb89-187"><a href="#cb89-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-188"><a href="#cb89-188" aria-hidden="true" tabindex="-1"></a>In this case each line represents an individual Subject (1-9):</span>
<span id="cb89-189"><a href="#cb89-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-192"><a href="#cb89-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-193"><a href="#cb89-193" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> example1_long, <span class="fu">aes</span>(<span class="at">x=</span>Week, <span class="at">y=</span>Migraines, <span class="at">group =</span> Subject)) <span class="sc">+</span></span>
<span id="cb89-194"><a href="#cb89-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>Subject)) <span class="sc">+</span> </span>
<span id="cb89-195"><a href="#cb89-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col=</span>Subject))</span>
<span id="cb89-196"><a href="#cb89-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-197"><a href="#cb89-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-198"><a href="#cb89-198" aria-hidden="true" tabindex="-1"></a>Which you choose is ultimately up to you. I tend to use Spaghetti plots unless I have instances where I have a high number of participants. This can potentially make the spaghetti plot busy (a bunch of points and line). That said, the purpose of the Spaghetti Plot is to note inconsistencies in trends. A helpful tool for a potentially busy Spaghetti Plot is to use <span class="in">`plotly`</span>. This produces an interactive plot where you can use the mouse cursor to identify important information:</span>
<span id="cb89-199"><a href="#cb89-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-200"><a href="#cb89-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r caption = "use your mouse on me... I'm interactive!!"}</span></span>
<span id="cb89-201"><a href="#cb89-201" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># may need to install</span></span>
<span id="cb89-202"><a href="#cb89-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-203"><a href="#cb89-203" aria-hidden="true" tabindex="-1"></a>s_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> example1_long, <span class="fu">aes</span>(<span class="at">x=</span>Week, <span class="at">y=</span>Migraines, <span class="at">group =</span> Subject)) <span class="sc">+</span></span>
<span id="cb89-204"><a href="#cb89-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>Subject)) <span class="sc">+</span> </span>
<span id="cb89-205"><a href="#cb89-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col=</span>Subject))</span>
<span id="cb89-206"><a href="#cb89-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-207"><a href="#cb89-207" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(s_plot)</span>
<span id="cb89-208"><a href="#cb89-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-209"><a href="#cb89-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-210"><a href="#cb89-210" aria-hidden="true" tabindex="-1"></a>Try hovering over individual points and lines in the plot above. Also, see what happens when you click on one of the participant numbers in the legend.</span>
<span id="cb89-211"><a href="#cb89-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-212"><a href="#cb89-212" aria-hidden="true" tabindex="-1"></a><span class="fu">### Means Plots</span></span>
<span id="cb89-213"><a href="#cb89-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-214"><a href="#cb89-214" aria-hidden="true" tabindex="-1"></a>One additional concern that we must deal with when plotting within-subjects data is the error bars. Plotting the standard error or regular confidence intervals may be misleading for making statistical inferences. This is because the values when normally calculated do not account for within subject correlation. Luckily for us there is a correction that we can make using the <span class="in">`Rmisc`</span> package. Please see <span class="co">[</span><span class="ot">Cousineau (2005)</span><span class="co">](https://doaj.org/article/dd17c4ccc4684c9da60c02f3864d09e6)</span> and <span class="co">[</span><span class="ot">Morey (2008)</span><span class="co">](https://doaj.org/article/011cd52c58b449c4bf169676ca704062)</span> for details on this issue and subsequent correction.</span>
<span id="cb89-215"><a href="#cb89-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-216"><a href="#cb89-216" aria-hidden="true" tabindex="-1"></a>The practical steps for this correction includes first **norming** the data to account for within subjects correlations.</span>
<span id="cb89-217"><a href="#cb89-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-220"><a href="#cb89-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-221"><a href="#cb89-221" aria-hidden="true" tabindex="-1"></a>normedData <span class="ot">&lt;-</span> Rmisc<span class="sc">::</span><span class="fu">normDataWithin</span>(<span class="at">data =</span> example1_long,</span>
<span id="cb89-222"><a href="#cb89-222" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">measurevar =</span> <span class="st">"Migraines"</span>,</span>
<span id="cb89-223"><a href="#cb89-223" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">idvar =</span> <span class="st">"Subject"</span>, </span>
<span id="cb89-224"><a href="#cb89-224" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">betweenvars =</span> <span class="cn">NULL</span>)</span>
<span id="cb89-225"><a href="#cb89-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-226"><a href="#cb89-226" aria-hidden="true" tabindex="-1"></a>normedData</span>
<span id="cb89-227"><a href="#cb89-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-228"><a href="#cb89-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-229"><a href="#cb89-229" aria-hidden="true" tabindex="-1"></a>We then calculate the se, sd, and ci values of our normed data, in this case <span class="in">`MigrainesNormed`</span>.</span>
<span id="cb89-230"><a href="#cb89-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-231"><a href="#cb89-231" aria-hidden="true" tabindex="-1"></a>The final step is to make a correction on these <span class="in">`Normed`</span> values (<span class="co">[</span><span class="ot">Morey (2008)</span><span class="co">](https://doaj.org/article/011cd52c58b449c4bf169676ca704062)</span>). This is done by taking the number of levels of the within factor (<span class="in">`nWithinGroups`</span>) and applying the following correction:</span>
<span id="cb89-232"><a href="#cb89-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-235"><a href="#cb89-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-236"><a href="#cb89-236" aria-hidden="true" tabindex="-1"></a><span class="co"># get the number of levels in Week:</span></span>
<span id="cb89-237"><a href="#cb89-237" aria-hidden="true" tabindex="-1"></a>nWithinGroups <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(example1_long<span class="sc">$</span>Week)</span>
<span id="cb89-238"><a href="#cb89-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-239"><a href="#cb89-239" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the correction factor:</span></span>
<span id="cb89-240"><a href="#cb89-240" aria-hidden="true" tabindex="-1"></a>correctionFactor <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(nWithinGroups<span class="sc">/</span>(nWithinGroups <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb89-241"><a href="#cb89-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-242"><a href="#cb89-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-243"><a href="#cb89-243" aria-hidden="true" tabindex="-1"></a>The range of our corrected errorbars are the sd, se, ci multiplied by this <span class="in">`correctionFactor`</span>.</span>
<span id="cb89-244"><a href="#cb89-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-245"><a href="#cb89-245" aria-hidden="true" tabindex="-1"></a>For example, the <span class="in">`sd`</span> of participants' <span class="in">`Migraines`</span> in <span class="in">`Wk1`</span> is:</span>
<span id="cb89-246"><a href="#cb89-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-249"><a href="#cb89-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-250"><a href="#cb89-250" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(normedData<span class="sc">$</span>MigrainesNormed[normedData<span class="sc">$</span>Week<span class="sc">==</span><span class="st">"Wk1"</span>])<span class="sc">*</span>correctionFactor</span>
<span id="cb89-251"><a href="#cb89-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-252"><a href="#cb89-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-253"><a href="#cb89-253" aria-hidden="true" tabindex="-1"></a>Fortunately there is a function in <span class="in">`Rmisc`</span> that handles this correction for us, <span class="in">`summarySEwithin`</span>. It is very similar to the <span class="in">`summarySE`</span> function you are familiar with, but asks you to specify which IVs are within-subjects (<span class="in">`withinvars`</span>), between-subjects(<span class="in">`betweenvars`</span>) and which column contains subject IDs <span class="in">`idvar`</span>. Using our original <span class="in">`example1_long`</span> data:</span>
<span id="cb89-254"><a href="#cb89-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-257"><a href="#cb89-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-258"><a href="#cb89-258" aria-hidden="true" tabindex="-1"></a>Rmisc<span class="sc">::</span><span class="fu">summarySEwithin</span>(<span class="at">data=</span>example1_long,</span>
<span id="cb89-259"><a href="#cb89-259" aria-hidden="true" tabindex="-1"></a>                       <span class="at">measurevar =</span> <span class="st">"Migraines"</span>,</span>
<span id="cb89-260"><a href="#cb89-260" aria-hidden="true" tabindex="-1"></a>                       <span class="at">withinvars =</span> <span class="st">"Week"</span>,</span>
<span id="cb89-261"><a href="#cb89-261" aria-hidden="true" tabindex="-1"></a>                       <span class="at">betweenvars =</span> <span class="cn">NULL</span>, </span>
<span id="cb89-262"><a href="#cb89-262" aria-hidden="true" tabindex="-1"></a>                       <span class="at">idvar =</span> <span class="st">"Subject"</span>)</span>
<span id="cb89-263"><a href="#cb89-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-264"><a href="#cb89-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-265"><a href="#cb89-265" aria-hidden="true" tabindex="-1"></a>Unfortunately, to date I haven't found a way to get this to play nice with <span class="in">`stat_summary()`</span> in <span class="in">`ggplot()`</span>. HOWEVER, there is a simple work around. Since <span class="in">`stat_summary()`</span> is simply summarizing our means and error values from the dataset and <span class="in">`summarySEwithin`</span> is doing the exact same thing, we can simply pull these values straight from <span class="in">`summarySEwithin`</span> with one MAJOR caveat. <span class="in">`summarySEwithin`</span> reports the normed means and errors, however we need the original means. Note that this is not an issue when you are only dealing with within subjects factors, but if you are performing mixed ANOVA (combination within-subjects and between-subjects) these means can differ.</span>
<span id="cb89-266"><a href="#cb89-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-267"><a href="#cb89-267" aria-hidden="true" tabindex="-1"></a>To address this problem user <span class="in">`Hause Lin`</span> created a custom function <span class="in">`summarySEwithin2`</span> that reports both normed and unnormed means. You can find this script on their Github site <span class="co">[</span><span class="ot">here</span><span class="co">](https://gist.github.com/hauselin/a83b6d2f05b0c90c0428017455f73744)</span>. I would recommend copying and pasting the code you your own ".R" file for future use. In the meantime we can directly source this code from their site:</span>
<span id="cb89-268"><a href="#cb89-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-271"><a href="#cb89-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-272"><a href="#cb89-272" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://gist.githubusercontent.com/hauselin/a83b6d2f05b0c90c0428017455f73744/raw/38e03ea4bf658d913cf11f4f1c18a1c328265a71/summarySEwithin2.R"</span>)</span>
<span id="cb89-273"><a href="#cb89-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-274"><a href="#cb89-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-275"><a href="#cb89-275" aria-hidden="true" tabindex="-1"></a>A similar script may be found on <span class="co">[</span><span class="ot">this ggplot tutorial site</span><span class="co">]</span>(http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/), which forms the basis of this alternative plotting method.</span>
<span id="cb89-276"><a href="#cb89-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-277"><a href="#cb89-277" aria-hidden="true" tabindex="-1"></a>Note that this "alternative" is how I in fact create most of my own ANOVA plots. But, I have my own custom function that is an adaptation of <span class="in">`summarySEwithin2`</span>, I call it <span class="in">`withinSummary`</span>. This is to address the fact that when writing your data up you need to use not only the actual means but also the actual se / sd / ci.</span>
<span id="cb89-278"><a href="#cb89-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-281"><a href="#cb89-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-282"><a href="#cb89-282" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/custom_functions/withinSummary.R"</span>)</span>
<span id="cb89-283"><a href="#cb89-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-284"><a href="#cb89-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-285"><a href="#cb89-285" aria-hidden="true" tabindex="-1"></a>This gives me both the <span class="in">`$Actual`</span> and <span class="in">`$Corrected`</span> values. I can use the <span class="in">`descriptiveStats$Corrected`</span> data for plotting, for example: First we save the output of <span class="in">`withinSummary`</span> to an object:</span>
<span id="cb89-286"><a href="#cb89-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-289"><a href="#cb89-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-290"><a href="#cb89-290" aria-hidden="true" tabindex="-1"></a>descriptiveStats <span class="ot">&lt;-</span> <span class="fu">withinSummary</span>(<span class="at">data=</span>example1_long,</span>
<span id="cb89-291"><a href="#cb89-291" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">measurevar =</span> <span class="st">"Migraines"</span>,</span>
<span id="cb89-292"><a href="#cb89-292" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">withinvars =</span> <span class="st">"Week"</span>,</span>
<span id="cb89-293"><a href="#cb89-293" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">idvar =</span> <span class="st">"Subject"</span>)</span>
<span id="cb89-294"><a href="#cb89-294" aria-hidden="true" tabindex="-1"></a>descriptiveStats</span>
<span id="cb89-295"><a href="#cb89-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-296"><a href="#cb89-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-297"><a href="#cb89-297" aria-hidden="true" tabindex="-1"></a>From here we can refer directly to <span class="in">`descriptiveStats`</span> in constructing the <span class="in">`ggplot`</span>. When plotting you use the <span class="in">`Corrected`</span> values .</span>
<span id="cb89-298"><a href="#cb89-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-301"><a href="#cb89-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-302"><a href="#cb89-302" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(descriptiveStats<span class="sc">$</span>Corrected, <span class="co"># using the corrected table to make the plots</span></span>
<span id="cb89-303"><a href="#cb89-303" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Week,</span>
<span id="cb89-304"><a href="#cb89-304" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Migraines, </span>
<span id="cb89-305"><a href="#cb89-305" aria-hidden="true" tabindex="-1"></a>                <span class="at">group=</span><span class="dv">1</span>))</span>
<span id="cb89-306"><a href="#cb89-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-307"><a href="#cb89-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-308"><a href="#cb89-308" aria-hidden="true" tabindex="-1"></a>And now to construct the plot. rather than using <span class="in">`summary_stat()`</span> we directly call each <span class="in">`geom`</span>. For example, adding the means and as points:</span>
<span id="cb89-309"><a href="#cb89-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-312"><a href="#cb89-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-313"><a href="#cb89-313" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb89-314"><a href="#cb89-314" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb89-315"><a href="#cb89-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-316"><a href="#cb89-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-317"><a href="#cb89-317" aria-hidden="true" tabindex="-1"></a>Connecting those points with lines:</span>
<span id="cb89-318"><a href="#cb89-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-321"><a href="#cb89-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-322"><a href="#cb89-322" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb89-323"><a href="#cb89-323" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb89-324"><a href="#cb89-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-325"><a href="#cb89-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-326"><a href="#cb89-326" aria-hidden="true" tabindex="-1"></a>Adding error bars (SE):</span>
<span id="cb89-327"><a href="#cb89-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-330"><a href="#cb89-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-331"><a href="#cb89-331" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>Migraines<span class="sc">-</span>se, <span class="at">ymax=</span>Migraines<span class="sc">+</span>se), <span class="at">width=</span><span class="dv">0</span>)</span>
<span id="cb89-332"><a href="#cb89-332" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(p)</span>
<span id="cb89-333"><a href="#cb89-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-334"><a href="#cb89-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-335"><a href="#cb89-335" aria-hidden="true" tabindex="-1"></a>note that above I set width of the error bars to 0 to keep consistent with how we've been plotting pointranges. However, if you want caps, you can change the width. I recommend a width no higher than 0.2.</span>
<span id="cb89-336"><a href="#cb89-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-337"><a href="#cb89-337" aria-hidden="true" tabindex="-1"></a>From here you can use your familiar commands to whip it into APA format!</span>
<span id="cb89-338"><a href="#cb89-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-339"><a href="#cb89-339" aria-hidden="true" tabindex="-1"></a><span class="fu">### building the model using afex:</span></span>
<span id="cb89-340"><a href="#cb89-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-341"><a href="#cb89-341" aria-hidden="true" tabindex="-1"></a>Running a WS ANOVA is just like running a BS ANOVA in <span class="in">`afex`</span> (see the last walkthrough). We call in our within subjects factors using the <span class="in">`within=`</span> argument.</span>
<span id="cb89-342"><a href="#cb89-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-345"><a href="#cb89-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-346"><a href="#cb89-346" aria-hidden="true" tabindex="-1"></a>within_aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"Subject"</span>, </span>
<span id="cb89-347"><a href="#cb89-347" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dv =</span> <span class="st">"Migraines"</span>, </span>
<span id="cb89-348"><a href="#cb89-348" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> example1_long,</span>
<span id="cb89-349"><a href="#cb89-349" aria-hidden="true" tabindex="-1"></a>                           <span class="at">between =</span> <span class="cn">NULL</span>,</span>
<span id="cb89-350"><a href="#cb89-350" aria-hidden="true" tabindex="-1"></a>                           <span class="at">within =</span> <span class="st">"Week"</span>,</span>
<span id="cb89-351"><a href="#cb89-351" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="dv">3</span>, </span>
<span id="cb89-352"><a href="#cb89-352" aria-hidden="true" tabindex="-1"></a>                           <span class="at">return =</span> <span class="st">"afex_aov"</span>, </span>
<span id="cb89-353"><a href="#cb89-353" aria-hidden="true" tabindex="-1"></a>                           <span class="at">anova_table=</span><span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>)</span>
<span id="cb89-354"><a href="#cb89-354" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb89-355"><a href="#cb89-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-356"><a href="#cb89-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-357"><a href="#cb89-357" aria-hidden="true" tabindex="-1"></a><span class="fu">### assumptions checks: normality</span></span>
<span id="cb89-358"><a href="#cb89-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-359"><a href="#cb89-359" aria-hidden="true" tabindex="-1"></a>We can then use the model, <span class="in">`within_aov`</span> to run the requisite assumption checks. As before, the model plays nicely with <span class="in">`performance`</span>, but the blanket <span class="in">`check_model`</span> will not work with <span class="in">`afex`</span>. Instead we can do a piecemeal check for normality along with visualizations.</span>
<span id="cb89-360"><a href="#cb89-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-363"><a href="#cb89-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-364"><a href="#cb89-364" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization against histogram</span></span>
<span id="cb89-365"><a href="#cb89-365" aria-hidden="true" tabindex="-1"></a>within_aov <span class="sc">%&gt;%</span> performance<span class="sc">::</span><span class="fu">check_normality</span>() <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span>
<span id="cb89-366"><a href="#cb89-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-367"><a href="#cb89-367" aria-hidden="true" tabindex="-1"></a><span class="co"># qq visualization</span></span>
<span id="cb89-368"><a href="#cb89-368" aria-hidden="true" tabindex="-1"></a>within_aov <span class="sc">%&gt;%</span> performance<span class="sc">::</span><span class="fu">check_normality</span>() <span class="sc">%&gt;%</span> <span class="fu">plot</span>(<span class="st">"qq"</span>)</span>
<span id="cb89-369"><a href="#cb89-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-370"><a href="#cb89-370" aria-hidden="true" tabindex="-1"></a><span class="co"># shapiro-wilkes test</span></span>
<span id="cb89-371"><a href="#cb89-371" aria-hidden="true" tabindex="-1"></a>within_aov <span class="sc">%&gt;%</span> performance<span class="sc">::</span><span class="fu">check_normality</span>() <span class="sc">%&gt;%</span> <span class="fu">show</span>()</span>
<span id="cb89-372"><a href="#cb89-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-373"><a href="#cb89-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-374"><a href="#cb89-374" aria-hidden="true" tabindex="-1"></a><span class="fu">### assumptions checks: sphericity</span></span>
<span id="cb89-375"><a href="#cb89-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-376"><a href="#cb89-376" aria-hidden="true" tabindex="-1"></a>Just like the paired $t$ test from a few weeks back, the RM-ANOVA does not have an explicit check for homogeneity of variance. Instead, RM ANOVA introduces a new test of assumptions that you must run, the test of **Sphericity**. Indeed, this test is run **instead** of the check for homogeneity. This is because technically a WS ANOVA violates the assumption of independence of scores, and thus inflates the likelihood of a homogeneity of variances violation. Essentially, we give up on trying to hold onto this assumption and instead direct our interests towards maintaining **Sphericity**. Importantly, if we do violate sphericity, there is a clean and relatively agreed upon step that we must take with our analysis.</span>
<span id="cb89-377"><a href="#cb89-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-378"><a href="#cb89-378" aria-hidden="true" tabindex="-1"></a>There are two ways to test for sphericity, (1) simply using and adjusting based upon the summary output of our ANOVA model, or (2) we can again use the <span class="in">`performance`</span> library. **I typically just use method 1, so that's all I will show you here to avoid confusion.**</span>
<span id="cb89-379"><a href="#cb89-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-380"><a href="#cb89-380" aria-hidden="true" tabindex="-1"></a>There is an argument to be made that you should always make a correction to guard against deviations from sphericity (see below). The correction becomes larger the further your data is from sphericity. However, standard practice in the psychology literature is to only apply the correction if our data fail the Mauchly's Test (*p* <span class="sc">\&lt;</span> .05) <span class="co">[</span><span class="ot">link</span><span class="co">](https://statistics.laerd.com/statistical-guides/sphericity-statistical-guide.php)</span>. The outcome of this test can be obtained by using the <span class="in">`summary()`</span> function on our model.</span>
<span id="cb89-381"><a href="#cb89-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-384"><a href="#cb89-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-385"><a href="#cb89-385" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(within_aov)</span>
<span id="cb89-386"><a href="#cb89-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-387"><a href="#cb89-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-388"><a href="#cb89-388" aria-hidden="true" tabindex="-1"></a>This gives us our original ANOVA table with non-corrected degrees of freedom, the Mauchly Test, and the Greenhouse-Geisser and Huynh-Feldt corrections. **The Mauchly Test is our test for Sphericity**. In this case the Mauchly Test <span class="in">`p = .54`</span>, so no corrections are necessary. If your elect to make the correction (i.e., the data fails Mauchly's Test) then you could multiply your original degrees of freedom by the GG eps (or HF eps). The p-value next to the correction values tells you the p-value for your ANOVA effect assuming corrections. In this case even with the corrections the effect of Week is significant.</span>
<span id="cb89-389"><a href="#cb89-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-390"><a href="#cb89-390" aria-hidden="true" tabindex="-1"></a>If you want to get the corrected degrees of freedom, you can simply take a look at the model itself:</span>
<span id="cb89-391"><a href="#cb89-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-394"><a href="#cb89-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-395"><a href="#cb89-395" aria-hidden="true" tabindex="-1"></a>within_aov</span>
<span id="cb89-396"><a href="#cb89-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-397"><a href="#cb89-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-398"><a href="#cb89-398" aria-hidden="true" tabindex="-1"></a><span class="sc">\*</span> note that the output includes the sphericity correction: GG.</span>
<span id="cb89-399"><a href="#cb89-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-400"><a href="#cb89-400" aria-hidden="true" tabindex="-1"></a>Alternatively you could just rerun the <span class="in">`afex`</span> function and specifying the <span class="in">`correction=`</span> call. You can either specify the "GG" correction:</span>
<span id="cb89-401"><a href="#cb89-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-404"><a href="#cb89-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-405"><a href="#cb89-405" aria-hidden="true" tabindex="-1"></a><span class="do">## GG correction:</span></span>
<span id="cb89-406"><a href="#cb89-406" aria-hidden="true" tabindex="-1"></a>within_aov_gg <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"Subject"</span>, </span>
<span id="cb89-407"><a href="#cb89-407" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dv =</span> <span class="st">"Migraines"</span>, </span>
<span id="cb89-408"><a href="#cb89-408" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> example1_long,</span>
<span id="cb89-409"><a href="#cb89-409" aria-hidden="true" tabindex="-1"></a>                           <span class="at">between =</span> <span class="cn">NULL</span>,</span>
<span id="cb89-410"><a href="#cb89-410" aria-hidden="true" tabindex="-1"></a>                           <span class="at">within =</span> <span class="st">"Week"</span>,</span>
<span id="cb89-411"><a href="#cb89-411" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="dv">3</span>, </span>
<span id="cb89-412"><a href="#cb89-412" aria-hidden="true" tabindex="-1"></a>                           <span class="at">return =</span> <span class="st">"afex_aov"</span>, </span>
<span id="cb89-413"><a href="#cb89-413" aria-hidden="true" tabindex="-1"></a>                           <span class="at">anova_table=</span><span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>,</span>
<span id="cb89-414"><a href="#cb89-414" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">correction=</span><span class="st">"GG"</span>))</span>
<span id="cb89-415"><a href="#cb89-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-416"><a href="#cb89-416" aria-hidden="true" tabindex="-1"></a>within_aov_gg</span>
<span id="cb89-417"><a href="#cb89-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-418"><a href="#cb89-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-419"><a href="#cb89-419" aria-hidden="true" tabindex="-1"></a>or the "HF" correction:</span>
<span id="cb89-420"><a href="#cb89-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-423"><a href="#cb89-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-424"><a href="#cb89-424" aria-hidden="true" tabindex="-1"></a><span class="do">## HF correction (note that any HF eps &gt; 1 will be treated as 1):</span></span>
<span id="cb89-425"><a href="#cb89-425" aria-hidden="true" tabindex="-1"></a>within_aov_hf <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"Subject"</span>, </span>
<span id="cb89-426"><a href="#cb89-426" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dv =</span> <span class="st">"Migraines"</span>, </span>
<span id="cb89-427"><a href="#cb89-427" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> example1_long,</span>
<span id="cb89-428"><a href="#cb89-428" aria-hidden="true" tabindex="-1"></a>                           <span class="at">between =</span> <span class="cn">NULL</span>,</span>
<span id="cb89-429"><a href="#cb89-429" aria-hidden="true" tabindex="-1"></a>                           <span class="at">within =</span> <span class="st">"Week"</span>,</span>
<span id="cb89-430"><a href="#cb89-430" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="dv">3</span>, </span>
<span id="cb89-431"><a href="#cb89-431" aria-hidden="true" tabindex="-1"></a>                           <span class="at">return =</span> <span class="st">"afex_aov"</span>, </span>
<span id="cb89-432"><a href="#cb89-432" aria-hidden="true" tabindex="-1"></a>                           <span class="at">anova_table=</span><span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>, </span>
<span id="cb89-433"><a href="#cb89-433" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">correction=</span><span class="st">"HF"</span>))</span>
<span id="cb89-434"><a href="#cb89-434" aria-hidden="true" tabindex="-1"></a>within_aov_hf</span>
<span id="cb89-435"><a href="#cb89-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-436"><a href="#cb89-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-437"><a href="#cb89-437" aria-hidden="true" tabindex="-1"></a><span class="fu">### running post-hoc analyses and follow-ups</span></span>
<span id="cb89-438"><a href="#cb89-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-439"><a href="#cb89-439" aria-hidden="true" tabindex="-1"></a>Post-hoc comparisons of means take a different form for repeated measures ANOVA. Typical methods such as Tukey HSD were designed for between-subjects effects, where it makes sense (assuming homogeneity of variance) to use a pooled error term. **However, for within-subjects (or repeated measures) effects, the error term is the Treatment x Subjects interaction, and the nature of the TxS interaction across all treatment levels can be very different than it is for any particular pair of treatment levels**.</span>
<span id="cb89-440"><a href="#cb89-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-441"><a href="#cb89-441" aria-hidden="true" tabindex="-1"></a>The typical recommendation (more detail on this in the following walkthrough) is to carry out pair-wise contrasts for a within-subjects factor using ordinary paired tests with an error term based only on the levels being compared .</span>
<span id="cb89-442"><a href="#cb89-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-443"><a href="#cb89-443" aria-hidden="true" tabindex="-1"></a>Because of this, post-hoc analysis involving repeated measures requires an additional argument in <span class="in">`emmeans()`</span>; invoking <span class="in">`model="multivariate"`</span></span>
<span id="cb89-444"><a href="#cb89-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-447"><a href="#cb89-447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-448"><a href="#cb89-448" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(within_aov, <span class="at">specs =</span> pairwise<span class="sc">~</span>Week, <span class="at">model=</span><span class="st">"multivariate"</span>)</span>
<span id="cb89-449"><a href="#cb89-449" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-450"><a href="#cb89-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-451"><a href="#cb89-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-452"><a href="#cb89-452" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`df`</span> (df = 8) of these tests are ***NOT*** the error df (df = 22) from the omnibus ANOVA.</span>
<span id="cb89-453"><a href="#cb89-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-454"><a href="#cb89-454" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 1 write up</span></span>
<span id="cb89-455"><a href="#cb89-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-458"><a href="#cb89-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-459"><a href="#cb89-459" aria-hidden="true" tabindex="-1"></a><span class="co"># adding to the plot we created above</span></span>
<span id="cb89-460"><a href="#cb89-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-461"><a href="#cb89-461" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_cowplot</span>()</span>
<span id="cb89-462"><a href="#cb89-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-463"><a href="#cb89-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-464"><a href="#cb89-464" aria-hidden="true" tabindex="-1"></a>*Figure 1.* Number of migraines as a function of Week. Note that Weeks 1 and 2 are baseline while Weeks 3, 4, and 5 are post relaxation therapy treatment.</span>
<span id="cb89-465"><a href="#cb89-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-466"><a href="#cb89-466" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; To test whether relaxation therapy had a positive effect for migraine suffers, we analyzed the number of migraines each individual reported over a 5 week period. The first two weeks were used as a baseline to establish a typical week for each person. The remaining three weeks each person was lead through relaxation therapy techniques. These data were submitted to a within-subjects ANOVA with Week as a factor.</span></span>
<span id="cb89-467"><a href="#cb89-467" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb89-468"><a href="#cb89-468" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Post hoc comparisions demonstrated the effectiveness of our treatment. While the number of migraines remained indifferent during the first two weeks (TukeyHSD, *p* \&gt;.05) there was a significant decrease in the number of migraines post treatment. As seen in Figure 1, the number of migraines in Weeks 3, 4, 5 we significantly lower than Weeks 1 and 2 (*p*s </span><span class="sc">\&lt;</span><span class="at"> .05).</span></span>
<span id="cb89-469"><a href="#cb89-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-470"><a href="#cb89-470" aria-hidden="true" tabindex="-1"></a><span class="sc">\*\*</span> note that you don't have to worry about the sphericity violation as it relates to the post hoc analyses---as you are only comparing two levels.</span>
<span id="cb89-471"><a href="#cb89-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-472"><a href="#cb89-472" aria-hidden="true" tabindex="-1"></a><span class="fu">## EXAMPLE 2</span></span>
<span id="cb89-473"><a href="#cb89-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-474"><a href="#cb89-474" aria-hidden="true" tabindex="-1"></a>Let's take a look at another example, using a experimental paradigm we are familiar with, scores as a function of lecture type.</span>
<span id="cb89-475"><a href="#cb89-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-476"><a href="#cb89-476" aria-hidden="true" tabindex="-1"></a><span class="fu">### loading in the data</span></span>
<span id="cb89-477"><a href="#cb89-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-478"><a href="#cb89-478" aria-hidden="true" tabindex="-1"></a>You note that this data is already in long format so no need to adjust.</span>
<span id="cb89-479"><a href="#cb89-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-482"><a href="#cb89-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-483"><a href="#cb89-483" aria-hidden="true" tabindex="-1"></a>example2_long <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/practice_datasets/withinEx2.csv"</span>)</span>
<span id="cb89-484"><a href="#cb89-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-485"><a href="#cb89-485" aria-hidden="true" tabindex="-1"></a>example2_long</span>
<span id="cb89-486"><a href="#cb89-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-487"><a href="#cb89-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-488"><a href="#cb89-488" aria-hidden="true" tabindex="-1"></a><span class="fu">### plotting the data</span></span>
<span id="cb89-489"><a href="#cb89-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-490"><a href="#cb89-490" aria-hidden="true" tabindex="-1"></a>Let's plot this data. Below, I put together the code for the means plot. But why don't you try to create a Spaghetti plot.</span>
<span id="cb89-491"><a href="#cb89-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-492"><a href="#cb89-492" aria-hidden="true" tabindex="-1"></a>This time for the means plot I'll make my points a little larger, lines a little thicker, and add caps to the error bars:</span>
<span id="cb89-493"><a href="#cb89-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-496"><a href="#cb89-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-497"><a href="#cb89-497" aria-hidden="true" tabindex="-1"></a>descriptiveStats <span class="ot">&lt;-</span> <span class="fu">withinSummary</span>(<span class="at">data=</span>example2_long,<span class="at">measurevar =</span> <span class="st">"Score"</span>,<span class="at">withinvars =</span> <span class="st">"Lecture"</span>,<span class="at">idvar =</span> <span class="st">"Subject"</span>)</span>
<span id="cb89-498"><a href="#cb89-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-499"><a href="#cb89-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-500"><a href="#cb89-500" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(descriptiveStats<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Lecture,<span class="at">y =</span> Score, <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb89-501"><a href="#cb89-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb89-502"><a href="#cb89-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb89-503"><a href="#cb89-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>Score<span class="sc">-</span>se, <span class="at">ymax=</span>Score<span class="sc">+</span>se), <span class="at">width=</span><span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb89-504"><a href="#cb89-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb89-505"><a href="#cb89-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb89-506"><a href="#cb89-506" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">lineheight =</span> .<span class="dv">55</span>),</span>
<span id="cb89-507"><a href="#cb89-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb89-508"><a href="#cb89-508" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb89-509"><a href="#cb89-509" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">25</span>,.<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb89-510"><a href="#cb89-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey50"</span>)) <span class="sc">+</span> </span>
<span id="cb89-511"><a href="#cb89-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Lecture"</span>) <span class="sc">+</span> </span>
<span id="cb89-512"><a href="#cb89-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb89-513"><a href="#cb89-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">25</span>,.<span class="dv">25</span>,.<span class="dv">25</span>,.<span class="dv">25</span>),<span class="st">"in"</span>)) <span class="sc">+</span> </span>
<span id="cb89-514"><a href="#cb89-514" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-515"><a href="#cb89-515" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stack legend boxes horizontally:</span></span>
<span id="cb89-516"><a href="#cb89-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.box =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb89-517"><a href="#cb89-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-518"><a href="#cb89-518" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(p)</span>
<span id="cb89-519"><a href="#cb89-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-520"><a href="#cb89-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-521"><a href="#cb89-521" aria-hidden="true" tabindex="-1"></a>Maybe not the best plot, but wanted to show you how to tweak things.</span>
<span id="cb89-522"><a href="#cb89-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-523"><a href="#cb89-523" aria-hidden="true" tabindex="-1"></a><span class="fu">### running the ANOVA:</span></span>
<span id="cb89-524"><a href="#cb89-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-525"><a href="#cb89-525" aria-hidden="true" tabindex="-1"></a>As before, let's run this using afex:</span>
<span id="cb89-526"><a href="#cb89-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-529"><a href="#cb89-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-530"><a href="#cb89-530" aria-hidden="true" tabindex="-1"></a>within_aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(</span>
<span id="cb89-531"><a href="#cb89-531" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">"Subject"</span>, </span>
<span id="cb89-532"><a href="#cb89-532" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"Score"</span>, </span>
<span id="cb89-533"><a href="#cb89-533" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> example2_long,</span>
<span id="cb89-534"><a href="#cb89-534" aria-hidden="true" tabindex="-1"></a>  <span class="at">between =</span> <span class="cn">NULL</span>,</span>
<span id="cb89-535"><a href="#cb89-535" aria-hidden="true" tabindex="-1"></a>  <span class="at">within =</span> <span class="st">"Lecture"</span>,</span>
<span id="cb89-536"><a href="#cb89-536" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="dv">3</span>, </span>
<span id="cb89-537"><a href="#cb89-537" aria-hidden="true" tabindex="-1"></a>  <span class="at">return =</span> <span class="st">"afex_aov"</span>, </span>
<span id="cb89-538"><a href="#cb89-538" aria-hidden="true" tabindex="-1"></a>  <span class="at">anova_table=</span><span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>, <span class="at">correction=</span><span class="st">"none"</span>))</span>
<span id="cb89-539"><a href="#cb89-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-540"><a href="#cb89-540" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(within_aov)</span>
<span id="cb89-541"><a href="#cb89-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-542"><a href="#cb89-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-543"><a href="#cb89-543" aria-hidden="true" tabindex="-1"></a>You'll notice that in this example the data failed the Mauchly Test for Sphericity ($p$ = .0123). As I mentioned above in this case you'll need to make the appropriate corrections. GG corrections are the "industry standard" (you typically see these in psych literature). HF corrections are not as conservative, and are appropriate in instances where the GG eps <span class="sc">\&gt;</span> 0.75. In this case we'll use the GG correction. My advice, just rerun the ANOVA with <span class="in">`correction="GG"`</span>:</span>
<span id="cb89-544"><a href="#cb89-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-547"><a href="#cb89-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-548"><a href="#cb89-548" aria-hidden="true" tabindex="-1"></a>within_aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(</span>
<span id="cb89-549"><a href="#cb89-549" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">"Subject"</span>, </span>
<span id="cb89-550"><a href="#cb89-550" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv =</span> <span class="st">"Score"</span>, </span>
<span id="cb89-551"><a href="#cb89-551" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> example2_long,</span>
<span id="cb89-552"><a href="#cb89-552" aria-hidden="true" tabindex="-1"></a>  <span class="at">between =</span> <span class="cn">NULL</span>,</span>
<span id="cb89-553"><a href="#cb89-553" aria-hidden="true" tabindex="-1"></a>  <span class="at">within =</span> <span class="st">"Lecture"</span>,</span>
<span id="cb89-554"><a href="#cb89-554" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="dv">3</span>, </span>
<span id="cb89-555"><a href="#cb89-555" aria-hidden="true" tabindex="-1"></a>  <span class="at">return =</span> <span class="st">"afex_aov"</span>, </span>
<span id="cb89-556"><a href="#cb89-556" aria-hidden="true" tabindex="-1"></a>  <span class="at">anova_table=</span><span class="fu">list</span>(<span class="at">es =</span> <span class="st">"pes"</span>, </span>
<span id="cb89-557"><a href="#cb89-557" aria-hidden="true" tabindex="-1"></a>                   <span class="at">correction=</span><span class="st">"GG"</span>,</span>
<span id="cb89-558"><a href="#cb89-558" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sig_symbols =</span> <span class="fu">rep</span>(<span class="st">""</span>, <span class="dv">4</span>)</span>
<span id="cb89-559"><a href="#cb89-559" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb89-560"><a href="#cb89-560" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-561"><a href="#cb89-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-562"><a href="#cb89-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-563"><a href="#cb89-563" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(within_aov)</span>
<span id="cb89-564"><a href="#cb89-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-565"><a href="#cb89-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-566"><a href="#cb89-566" aria-hidden="true" tabindex="-1"></a><span class="fu">### post-hocs and follow-ups</span></span>
<span id="cb89-567"><a href="#cb89-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-568"><a href="#cb89-568" aria-hidden="true" tabindex="-1"></a>Remember again, that any simple effects / post hoc comparisons need to be "multivariate")</span>
<span id="cb89-569"><a href="#cb89-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-572"><a href="#cb89-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-573"><a href="#cb89-573" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(within_aov, </span>
<span id="cb89-574"><a href="#cb89-574" aria-hidden="true" tabindex="-1"></a>        <span class="at">spec=</span> <span class="st">"Lecture"</span>, </span>
<span id="cb89-575"><a href="#cb89-575" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="st">"multivariate"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-576"><a href="#cb89-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>(<span class="at">adjust=</span><span class="st">"tukey"</span>)</span>
<span id="cb89-577"><a href="#cb89-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-578"><a href="#cb89-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-579"><a href="#cb89-579" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example write up</span></span>
<span id="cb89-580"><a href="#cb89-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-581"><a href="#cb89-581" aria-hidden="true" tabindex="-1"></a>Again I need to get my summary stats for the write up. Since I'm not doing any custom contrasts I can just pull the cell values from my summary table:</span>
<span id="cb89-582"><a href="#cb89-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-585"><a href="#cb89-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-586"><a href="#cb89-586" aria-hidden="true" tabindex="-1"></a>descriptiveStats<span class="sc">$</span>Actual</span>
<span id="cb89-587"><a href="#cb89-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-588"><a href="#cb89-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-589"><a href="#cb89-589" aria-hidden="true" tabindex="-1"></a>And now for the write-up:</span>
<span id="cb89-590"><a href="#cb89-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-591"><a href="#cb89-591" aria-hidden="true" tabindex="-1"></a>... to test this hypothesis we ran a within subjects ANOVA. Due to a violation of the sphericity assumption, we used Greenhouse-Geisser corrected degress of freedom. Our analysis revealed a significant effect for Lecture, $F$(1.26, 13.88) = 12.31, $p$ = .002, $\eta_p^2$ = .53. Post-hoc analyses revealed participants scores in the Physical condition ($M$ ± $SE$: 40.0 ± 3.12) was significantly greater than both History (34.5 ± 2.4) and Social (26.0 ± 4.4) scores ($p$s <span class="sc">\&lt;</span> .05). History and Social were not different from one another.</span>
<span id="cb89-592"><a href="#cb89-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-593"><a href="#cb89-593" aria-hidden="true" tabindex="-1"></a>Take a look at the next walkthrough for an example of factorial repeated measures ANOVA.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Written by <a href="https://tehrandav.is">Tehran Davis</a> of PSYC 7014.</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>