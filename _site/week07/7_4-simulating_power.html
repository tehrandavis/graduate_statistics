<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>tehrandav.is - Simulating Power!!!</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">tehrandav.is</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="https://tehrandav.is">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Simulating Power!!!</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../walkthroughs.html" class="sidebar-item-text sidebar-link">PSYC 7014</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">TOPIC 1 INTRO to R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_1-Rmarkdown_basics.html" class="sidebar-item-text sidebar-link">Rmarkdown Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_2-objects_assignment_functions.html" class="sidebar-item-text sidebar-link">Objects, assignment, and functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_3-install_packages.html" class="sidebar-item-text sidebar-link">Installing and loading an <code>R</code> package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_4-loading_data.html" class="sidebar-item-text sidebar-link">Loading in Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_5-leveling-up.html" class="sidebar-item-text sidebar-link">Leveling-up</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">TOPIC 2: DESCRIPTIVE STATS and CENTRAL TENDENCY</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_1-structure_data.html" class="sidebar-item-text sidebar-link">The structure of your data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_2-central_tendency.html" class="sidebar-item-text sidebar-link">Measures of central tendency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_3-summary_tables.html" class="sidebar-item-text sidebar-link">Creating summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_4-means_other_models.html" class="sidebar-item-text sidebar-link">Means and other models</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">TOPIC 3: DATA VISUALIZATION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_1-basic_ggplot.html" class="sidebar-item-text sidebar-link">Basic ggplotting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_2-more_adv_ggplot.html" class="sidebar-item-text sidebar-link">More advanced ggPlots</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">TOPIC 4: DISTRIBUTIONS and NHST</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="sidebar-item-text sidebar-link">Building intuitions about probability and NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_3-sampling_distributions_and_seeing_the_logic_of_nhst.html" class="sidebar-item-text sidebar-link">Sampling distributions and seeing the logic of NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_4-more_examples.html" class="sidebar-item-text sidebar-link">More examples of distributions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_5-bias_variance.html" class="sidebar-item-text sidebar-link">Bias in sample variance estimates</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">TOPIC 5: CORRELATION AND REGRESSION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_2_correlations.html" class="sidebar-item-text sidebar-link">Correlations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_3_regressions.html" class="sidebar-item-text sidebar-link">Regression, pt.&nbsp;1: Running the model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_4_plotting.html" class="sidebar-item-text sidebar-link">Plotting regression data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_5_diagnostics.html" class="sidebar-item-text sidebar-link">Regression model diagnostics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_6_example_report.html" class="sidebar-item-text sidebar-link">Example Report</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">TOPIC 6: T-TESTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_1_t-test.html" class="sidebar-item-text sidebar-link">Testing differences in means / t-test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_2_t-test-null-model.html" class="sidebar-item-text sidebar-link">Thinking about nothing (aka the null)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_3_t-test-lm.html" class="sidebar-item-text sidebar-link">t-test? It’s just a linear model</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">TOPIC 7: POWER &amp; EFFECT SIZES</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_1-effect_size.html" class="sidebar-item-text sidebar-link">Effect Size</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_2-power.html" class="sidebar-item-text sidebar-link">Power</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_3-power_es_sig_tests.html" class="sidebar-item-text sidebar-link">Power, Effect sizes, and Significance testing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_4-simulating_power.html" class="sidebar-item-text sidebar-link active">Simulating Power!!!</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">TOPIC 8: INTRO to ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_1-one-way-anova.html" class="sidebar-item-text sidebar-link">The One-way ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_2-anova-regression.html" class="sidebar-item-text sidebar-link">ANOVA and Regression</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">TOPIC 9: ANOVA: CONTRASTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_1-posthocs.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;1: post hoc tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_2-planned_contrasts.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;2: planned contrasts</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">TOPIC 10: ANOVA: FACTORIAL ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_1-main_effects.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - The omnibus ANOVA and Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_2-factorial_w_post_hocs.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - Post hoc analysis of Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_3-advanced_example_and_apa.html" class="sidebar-item-text sidebar-link">Template for Analysis &amp; APA Style</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">TOPIC 11: ANOVA + INTERACTIONS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_1-interactions.html" class="sidebar-item-text sidebar-link">Analysis of Variance: the Factorial ANOVA - Interactions &amp; Simple Effects ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_2-higher_order_anova.html" class="sidebar-item-text sidebar-link">Dealing with Higher Order Factorial ANOVA</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">TOPIC 12: WITHIN SUBJECTS / REPEATED MEASURES ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_1-afex_ANOVA.html" class="sidebar-item-text sidebar-link">afex is for ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_2-repeated_measures_anova.html" class="sidebar-item-text sidebar-link">Within Subjects / Repeated Measures ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_3-factorial_rma.html" class="sidebar-item-text sidebar-link">Factorial RM-ANOVA and simple effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_4-sphericity.html" class="sidebar-item-text sidebar-link">Sphericity: Variances and Co-Variances</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_5-spss_rma.html" class="sidebar-item-text sidebar-link">Running a RM-ANOVA in SPSS</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">TOPIC 13: MIXED ANOVA (BS + WS)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/13_1-mixed_effects_anova.html" class="sidebar-item-text sidebar-link">Mixed-effects ANOVA (BS + WS)</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#the-general-procedure" id="toc-the-general-procedure" class="nav-link active" data-scroll-target="#the-general-procedure">The general procedure</a></li>
  <li><a href="#revisiting-an-example-using-a-t-test" id="toc-revisiting-an-example-using-a-t-test" class="nav-link" data-scroll-target="#revisiting-an-example-using-a-t-test">Revisiting an example using a t-test</a></li>
  <li><a href="#simulated-power-analysis-an-example-part-1" id="toc-simulated-power-analysis-an-example-part-1" class="nav-link" data-scroll-target="#simulated-power-analysis-an-example-part-1">Simulated power analysis, an example, part 1</a></li>
  <li><a href="#simulated-power-analysis-an-example-part-2" id="toc-simulated-power-analysis-an-example-part-2" class="nav-link" data-scroll-target="#simulated-power-analysis-an-example-part-2">Simulated power analysis, an example, part 2</a></li>
  <li><a href="#no-one-man-should-have-all-that-superpower" id="toc-no-one-man-should-have-all-that-superpower" class="nav-link" data-scroll-target="#no-one-man-should-have-all-that-superpower">No one man should have all that <code>Superpower</code></a></li>
  <li>
<a href="#moving-forward" id="toc-moving-forward" class="nav-link" data-scroll-target="#moving-forward">Moving forward</a>
  <ul class="collapse">
<li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources">Additional resources</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Simulating Power!!!</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, cowplot, infer, glue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/7k/6v7xmh35305_vjzy660s9_q40000gs/T//RtmpkLd9zM/downloaded_packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
infer installed</code></pre>
</div>
</div>
<p>Note that the <code>pwr</code> package in R is limited to what it can do. It can only perform basic power analyses. For more complex power calculations, like those tied to more complex models including factorial and repeated measures ANOVA, you will need to download <strong>gpower</strong> a free stand-alone power software or you have to find other packages in R or build a Monte-Carlo simulation. In this walkthrough I’ll build intuitions on how to do the latter. To do this I’ll be leveraging an assumed and a known:</p>
<ol type="1">
<li>I am <strong>assuming</strong> that you are somewhat comfortable with the notion of simulating data, given your experiences in the past few weeks. We are going to be leveraging some of the tools and ideas that you used when building your sampling distributions using simulated data (e.g., bootstrapping).</li>
<li>I am leveraging a <strong>known</strong> consequence of the definition of power. Namely a designs power is the probability that it will correctly reject the null hypothesis. Restated, its the probability that you will get a significant result (<em>p</em> &lt; <span class="math inline">\(\alpha\)</span>) given that there is a true difference or relationship in your data.</li>
</ol>
<p>Together, (1) and (2) mean that given a certain set of parameters, including mean differences, variability, sample size and <span class="math inline">\(\alpha\)</span> if I simulate collecting data and running a test 100 times, and 80 of those times my test yields a significant result, then my power is .80.</p>
<p>Let’s revisit our previous example to build some intuitions.</p>
<section id="the-general-procedure" class="level2"><h2 class="anchored" data-anchor-id="the-general-procedure">The general procedure</h2>
<p>Each of the examples in this walkthrough are going to follow a common procedure:</p>
<ol type="1">
<li>identify your hypothesized result.</li>
<li>run a series of simulations, randomizing data given parameters consistent with (1).</li>
<li>test each simulation given your criterion of significance (typically <span class="math inline">\(\alpha\)</span>).</li>
</ol></section><section id="revisiting-an-example-using-a-t-test" class="level2"><h2 class="anchored" data-anchor-id="revisiting-an-example-using-a-t-test">Revisiting an example using a t-test</h2>
<p>I think a good place to start is revisiting our examples from a few weeks back. The the walkthrough on <strong>Power</strong> we ran an <em>a priori</em> power analysis provided some combination of:</p>
<ul>
<li><p>an effect size</p></li>
<li><p>a given sample size</p></li>
<li><p>a desired power</p></li>
<li><p>and a performed test including significance level.</p></li>
</ul>
<p>We noted that to perform a power analysis we needed to know values for 3 out of 4, where the goal of the analysis is to calculate the 4th. For example, tin the typical power analysis we want to know the number of participants that we will need for our study given a known effect size, <code>d=.4</code> and a desired power-level, typically .8. In the case that we are running a independent (two) sample t-test with an <span class="math inline">\(\alpha\)</span> of .05, we can run this analysis algorithmically by calling the following in <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">8</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"two"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 99.08032
              d = 0.4
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p>In this case, our output indicates that we will need approximately 100 participants per group.</p>
</section><section id="simulated-power-analysis-an-example-part-1" class="level2"><h2 class="anchored" data-anchor-id="simulated-power-analysis-an-example-part-1">Simulated power analysis, an example, part 1</h2>
<p>As an alternative, we might also elect to run our power analysis using Monte Carlo simulation methods. In this simple case we start by creating simulated samples given our effect size parameter. For example, starting with an effect size of <code>d=.40</code> we can create 2 groups, a control group with a standard distribution (M = 0, SD = 1) and an experimental group with a mean of 0.4, and SD = 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>control_group <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>experimental_group <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="fl">0.4</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then run a independent samples t-test comparing the two groups</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> control_group, <span class="at">y =</span> experimental_group, <span class="at">paired =</span> F, <span class="at">var.equal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  control_group and experimental_group
t = -3.4104, df = 198, p-value = 0.000786
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.7725038 -0.2064459
sample estimates:
 mean of x  mean of y 
-0.1386661  0.3508088 </code></pre>
</div>
</div>
<p>Now lets simulate this process 1000 times. First, we build a tibble that simulates 1000 <code>control</code> and <code>experimental</code> samples of size <code>n = 100</code>. Each row in the tibble <code>sample_simulations</code> contains a list containing the <code>control_sample</code>, a list containing the <code>experimental_sample</code> and their respective means.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">library</span>(infer)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">library</span>(broom)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a>sample_simulations <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">mutate</span>(<span class="at">control_sample =</span> <span class="fu">map</span>(simulation,<span class="sc">~</span><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb9-7"><a href="#cb9-7"></a>         <span class="at">experimental_sample =</span> <span class="fu">map</span>(simulation,<span class="sc">~</span><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>,<span class="at">mean =</span> <span class="fl">0.4</span>,<span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb9-8"><a href="#cb9-8"></a>         <span class="at">mean_control =</span> <span class="fu">map_dbl</span>(control_sample, <span class="sc">~</span><span class="fu">mean</span>(.)),</span>
<span id="cb9-9"><a href="#cb9-9"></a>         <span class="at">mean_experimental =</span> <span class="fu">map_dbl</span>(experimental_sample, <span class="sc">~</span><span class="fu">mean</span>(.))</span>
<span id="cb9-10"><a href="#cb9-10"></a>         )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then follow this up by running a simulation <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> for each row in the <code>sample_simulations</code>. The tibble <code>t_test_simulations</code>, contains the <code>tidy()</code> output for each <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb10-2"><a href="#cb10-2"></a>t_test_simulations <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="cf">for</span> (test_sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb10-5"><a href="#cb10-5"></a>  control <span class="ot">&lt;-</span> sample_simulations<span class="sc">$</span>control_sample[test_sim] <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb10-6"><a href="#cb10-6"></a>  experimental <span class="ot">&lt;-</span> sample_simulations<span class="sc">$</span>experimental_sample[test_sim] <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb10-7"><a href="#cb10-7"></a>  t_test_results <span class="ot">&lt;-</span> <span class="fu">t.test</span>(control,experimental,<span class="at">paired=</span>F,<span class="at">var.equal=</span>T)</span>
<span id="cb10-8"><a href="#cb10-8"></a>  t_test_simulations <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(t_test_simulations,<span class="fu">tidy</span>(t_test_results))</span>
<span id="cb10-9"><a href="#cb10-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s take a look at the distribution of <code>p.values</code> from our simulations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>t_statistic_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(t_test_simulations, <span class="fu">aes</span>(<span class="at">x=</span>statistic)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">theme_cowplot</span>()</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a>p_value_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(t_test_simulations, <span class="fu">aes</span>(<span class="at">x=</span>p.value)) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">theme_cowplot</span>()</span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(t_statistic_plot, p_value_plot,<span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7_4-simulating_power_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, we can ask ourselves what percentage of our obtained p-values are <em>p</em> &lt; .05.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">mean</span>(t_test_simulations<span class="sc">$</span>p.value<span class="sc">&lt;</span>.<span class="dv">05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.788</code></pre>
</div>
</div>
<p>This is the simulated power, and matches the power obtained using <code>pwr.t.test</code>.</p>
</section><section id="simulated-power-analysis-an-example-part-2" class="level2"><h2 class="anchored" data-anchor-id="simulated-power-analysis-an-example-part-2">Simulated power analysis, an example, part 2</h2>
<p>We can reconfigure our simulations to ask a more practical question: how many participants do we need to reach our desired power. In this case, I’m going to start with a realistic minimum number of participants, 10 per group, and work my way up by 5s to a realistic maximum of 200.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>participants <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">200</span>,<span class="dv">5</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>simulations <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s redo the simulation above, but this time running 1000 simulations per <code>n_participants</code>. First we create an empty tibble crossing <code>n_participants</code> and <code>n_simulations.</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>sample_simulations <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n_participants =</span> <span class="fu">rep</span>(participants, </span>
<span id="cb15-2"><a href="#cb15-2"></a>                                                  <span class="at">each =</span> <span class="fu">length</span>(simulations)</span>
<span id="cb15-3"><a href="#cb15-3"></a>                                                  ),</span>
<span id="cb15-4"><a href="#cb15-4"></a>                             <span class="at">n_simulations =</span> <span class="fu">rep</span>(simulations, </span>
<span id="cb15-5"><a href="#cb15-5"></a>                                                <span class="at">times =</span> <span class="fu">length</span>(participants)</span>
<span id="cb15-6"><a href="#cb15-6"></a>                                                  ),</span>
<span id="cb15-7"><a href="#cb15-7"></a>                             )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then run the sample simulations, running 1000 simulations for each sample size of <code>n_participants</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>sample_simulations <span class="ot">&lt;-</span> sample_simulations <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">mutate</span>(<span class="at">control_sample =</span> <span class="fu">map</span>(n_participants,<span class="sc">~</span><span class="fu">rnorm</span>(.,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb16-3"><a href="#cb16-3"></a>         <span class="at">experimental_sample =</span> <span class="fu">map</span>(n_participants,<span class="sc">~</span><span class="fu">rnorm</span>(.,<span class="at">mean =</span> <span class="fl">0.4</span>,<span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb16-4"><a href="#cb16-4"></a>         <span class="at">mean_control =</span> <span class="fu">map_dbl</span>(control_sample, <span class="sc">~</span><span class="fu">mean</span>(.)),</span>
<span id="cb16-5"><a href="#cb16-5"></a>         <span class="at">mean_experimental =</span> <span class="fu">map_dbl</span>(experimental_sample, <span class="sc">~</span><span class="fu">mean</span>(.))</span>
<span id="cb16-6"><a href="#cb16-6"></a>         ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then run a <code>t.test</code> for each simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>t_test_simulations <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="cf">for</span> (test_sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sample_simulations)){</span>
<span id="cb17-4"><a href="#cb17-4"></a>  control <span class="ot">&lt;-</span> sample_simulations<span class="sc">$</span>control_sample[test_sim] <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb17-5"><a href="#cb17-5"></a>  experimental <span class="ot">&lt;-</span> sample_simulations<span class="sc">$</span>experimental_sample[test_sim] <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb17-6"><a href="#cb17-6"></a>  t_test_results <span class="ot">&lt;-</span> <span class="fu">t.test</span>(control,experimental,<span class="at">paired=</span>F,<span class="at">var.equal=</span>T)</span>
<span id="cb17-7"><a href="#cb17-7"></a>  t_test_simulations <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(t_test_simulations,<span class="fu">tidy</span>(t_test_results))</span>
<span id="cb17-8"><a href="#cb17-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally we combine our two tables…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>simulation_outcomes <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(sample_simulations, t_test_simulations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>generate a summary table containing the proportion of tests that yielded a significant result…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>power_table <span class="ot">&lt;-</span> simulation_outcomes <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(n_participants) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">mean</span>(p.value<span class="sc">&lt;</span>.<span class="dv">05</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and plot, here the horizontal line represents desired power of .80. Essentially we a looking for the first point that is above this line, which is at about 100 participants.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(power_table, <span class="fu">aes</span>(<span class="at">x =</span> n_participants, <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">8</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7_4-simulating_power_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="no-one-man-should-have-all-that-superpower" class="level1"><h1>No one man should have all that <code>Superpower</code>
</h1>
<p>The two examples above were to provide a gist of how to conduct a simple power analysis using simulation methods. Moving forward, we’ll ramp up the complexity of our designs by including ANOVA. One thing that is apparent is that creating the simulated datasets as above may become a little cumbersome. Fortunately for us, there are packages in <code>R</code> that do the heavy lifting in this process for us.</p>
<p>A relatively new, but powerful (haha) package is <code>Superpower</code> (haha) developed by Daniel Lakens and Aaron Caldwell. A paper outlining this package can be found <a href="https://psyarxiv.com/baxsf/">here</a>. Let’s load in the package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(Superpower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/7k/6v7xmh35305_vjzy660s9_q40000gs/T//RtmpkLd9zM/downloaded_packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Superpower installed</code></pre>
</div>
</div>
<p>The first step is to consider the design and predicted effects of your anticipated data set. For example in our general example above we have a between-groups design with 2 factors. We had an estimated effect size of Cohen’s <em>d</em> = 0.4. We elected to run a t-test given this design, although FWIW we could have also run an ANOVA.</p>
<p>We can input this information into <code>Superpower</code> using <code>ANOVA_design()</code>:</p>
<ul>
<li><p><code>design</code> is the combination of number of type of factor (within = “w”, between = “b”) and number of levels. Here we have 1 between factor with 2 levels (“control”, “experimental”), hence “2b”</p></li>
<li><p><code>n</code> = number of total participants</p></li>
<li><p><code>mu</code> = our hypothesized means</p></li>
<li><p><code>sd</code> = our hypothesized standard deviations</p></li>
<li><p><code>labelnames</code> = the labels for our conditions</p></li>
<li><p><code>plot</code> = do you want to see a plot of your hypothetical data</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">library</span>(Superpower)</span>
<span id="cb24-2"><a href="#cb24-2"></a>my_ANOVA_design <span class="ot">&lt;-</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> <span class="st">"2b"</span>,</span>
<span id="cb24-3"><a href="#cb24-3"></a>                             <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>                             <span class="at">mu =</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">4</span>), </span>
<span id="cb24-5"><a href="#cb24-5"></a>                             <span class="at">sd =</span> <span class="dv">1</span>,</span>
<span id="cb24-6"><a href="#cb24-6"></a>                             <span class="at">labelnames =</span><span class="fu">c</span>(<span class="st">"condition"</span>,<span class="st">"control"</span>, <span class="st">"experimental"</span>),</span>
<span id="cb24-7"><a href="#cb24-7"></a>                             <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7_4-simulating_power_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>my_ANOVA_design</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The design is specified as: 2b
Summary of means (mu) and standard deviations (SD)
   mu SD    condition
1 0.0  1      control
2 0.4  1 experimental

Correlation Matrix
             control experimental
control            1            0
experimental       0            1</code></pre>
</div>
</div>
<p>From here you would take your <code>design_result</code> and plug it into the <code>ANOVA_power</code>, including (but not limited to) the following arguments:</p>
<ul>
<li><p><code>alpha_level</code>: p value</p></li>
<li><p><code>correction</code>: in the case that you have a repeated measures design, you can run your analysis assuming that you correct for potential sphericity violations</p></li>
<li><p><code>p_adjust</code>: assuming you anticipate multiple comparisons, run your power analysis accounting for familywise error adjustments</p></li>
<li><p><code>nsims</code>: how many simulations to run</p></li>
<li><p><code>seed</code>: equivalent to <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code> for reproducibility</p></li>
<li><p><code>verbose</code>: do you want it to print the output?</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">ANOVA_power</span>(<span class="at">design_result =</span> my_ANOVA_design,</span>
<span id="cb27-2"><a href="#cb27-2"></a>            <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb27-3"><a href="#cb27-3"></a>            <span class="at">correction =</span> <span class="st">"none"</span>,</span>
<span id="cb27-4"><a href="#cb27-4"></a>            <span class="at">p_adjust =</span> <span class="st">"none"</span>,</span>
<span id="cb27-5"><a href="#cb27-5"></a>            <span class="at">nsims =</span> <span class="dv">1000</span>,</span>
<span id="cb27-6"><a href="#cb27-6"></a>            <span class="at">seed =</span> <span class="dv">2020</span>,</span>
<span id="cb27-7"><a href="#cb27-7"></a>            <span class="at">verbose =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power and Effect sizes for ANOVA tests
                power effect_size
anova_condition    82     0.04254

Power and Effect sizes for pairwise comparisons (t-tests)
                                           power effect_size
p_condition_control_condition_experimental    82      0.3998</code></pre>
</div>
</div>
<p>The output provides estimates of power based upon the provided parameters. For our purposes, the pairwise t-test, we would refer to the outputs labelled <code>pairwise</code></p>
</section><section id="moving-forward" class="level1"><h1>Moving forward</h1>
<p>For now, this is where I leave you. The goals here were to provide you with a conceptual basis for how we can run power analyses using simulations as well as an introductory example. In future walkthroughs, I will show an example of how to conduct a power analysis given each of the designs that we will encounter. For those that want to get a head start I would check out these two wonderful resources from the authors of <code>Superpower</code></p>
<section id="additional-resources" class="level2"><h2 class="anchored" data-anchor-id="additional-resources">Additional resources</h2>
<ul>
<li><p><strong>The Superpower Github repository</strong> (<a href="https://github.com/arcaldwell49/Superpower" class="uri">https://github.com/arcaldwell49/Superpower</a>) provides a more comprehensive walkthrough of <code>Superpower</code> using slightly more complex examples than provided here.</p></li>
<li><p><em>Power Analysis with Superpower</em> (<a href="https://aaroncaldwell.us/SuperpowerBook/" class="uri">https://aaroncaldwell.us/SuperpowerBook/</a>): is a fully comprehensive web-based text that goes into great detail with how to conduct power analyses for complex ANOVA designs.</p></li>
</ul>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb29" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1"></a><span class="co">---</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="an">title:</span><span class="co"> 'Simulating Power!!!'</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">---</span></span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="in">```{r}</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, cowplot, infer, glue)</span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="in">```</span></span>
<span id="cb29-10"><a href="#cb29-10"></a></span>
<span id="cb29-11"><a href="#cb29-11"></a>Note that the <span class="in">`pwr`</span> package in R is limited to what it can do. It can only perform basic power analyses. For more complex power calculations, like those tied to more complex models including factorial and repeated measures ANOVA, you will need to download **gpower** a free stand-alone power software or you have to find other packages in R or build a Monte-Carlo simulation. In this walkthrough I'll build intuitions on how to do the latter. To do this I'll be leveraging an assumed and a known:</span>
<span id="cb29-12"><a href="#cb29-12"></a></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="ss">1.  </span>I am **assuming** that you are somewhat comfortable with the notion of simulating data, given your experiences in the past few weeks. We are going to be leveraging some of the tools and ideas that you used when building your sampling distributions using simulated data (e.g., bootstrapping).</span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="ss">2.  </span>I am leveraging a **known** consequence of the definition of power. Namely a designs power is the probability that it will correctly reject the null hypothesis. Restated, its the probability that you will get a significant result (*p* <span class="sc">\&lt;</span> $\alpha$) given that there is a true difference or relationship in your data.</span>
<span id="cb29-15"><a href="#cb29-15"></a></span>
<span id="cb29-16"><a href="#cb29-16"></a>Together, (1) and (2) mean that given a certain set of parameters, including mean differences, variability, sample size and $\alpha$ if I simulate collecting data and running a test 100 times, and 80 of those times my test yields a significant result, then my power is .80.</span>
<span id="cb29-17"><a href="#cb29-17"></a></span>
<span id="cb29-18"><a href="#cb29-18"></a>Let's revisit our previous example to build some intuitions.</span>
<span id="cb29-19"><a href="#cb29-19"></a></span>
<span id="cb29-20"><a href="#cb29-20"></a><span class="fu">## The general procedure</span></span>
<span id="cb29-21"><a href="#cb29-21"></a></span>
<span id="cb29-22"><a href="#cb29-22"></a>Each of the examples in this walkthrough are going to follow a common procedure:</span>
<span id="cb29-23"><a href="#cb29-23"></a></span>
<span id="cb29-24"><a href="#cb29-24"></a><span class="ss">1.  </span>identify your hypothesized result.</span>
<span id="cb29-25"><a href="#cb29-25"></a><span class="ss">2.  </span>run a series of simulations, randomizing data given parameters consistent with (1).</span>
<span id="cb29-26"><a href="#cb29-26"></a><span class="ss">3.  </span>test each simulation given your criterion of significance (typically $\alpha$).</span>
<span id="cb29-27"><a href="#cb29-27"></a></span>
<span id="cb29-28"><a href="#cb29-28"></a><span class="fu">## Revisiting an example using a t-test</span></span>
<span id="cb29-29"><a href="#cb29-29"></a></span>
<span id="cb29-30"><a href="#cb29-30"></a>I think a good place to start is revisiting our examples from a few weeks back. The the walkthrough on **Power** we ran an *a priori* power analysis provided some combination of:</span>
<span id="cb29-31"><a href="#cb29-31"></a></span>
<span id="cb29-32"><a href="#cb29-32"></a><span class="ss">-   </span>an effect size</span>
<span id="cb29-33"><a href="#cb29-33"></a></span>
<span id="cb29-34"><a href="#cb29-34"></a><span class="ss">-   </span>a given sample size</span>
<span id="cb29-35"><a href="#cb29-35"></a></span>
<span id="cb29-36"><a href="#cb29-36"></a><span class="ss">-   </span>a desired power</span>
<span id="cb29-37"><a href="#cb29-37"></a></span>
<span id="cb29-38"><a href="#cb29-38"></a><span class="ss">-   </span>and a performed test including significance level.</span>
<span id="cb29-39"><a href="#cb29-39"></a></span>
<span id="cb29-40"><a href="#cb29-40"></a>We noted that to perform a power analysis we needed to know values for 3 out of 4, where the goal of the analysis is to calculate the 4th. For example, tin the typical power analysis we want to know the number of participants that we will need for our study given a known effect size, <span class="in">`d=.4`</span> and a desired power-level, typically .8. In the case that we are running a independent (two) sample t-test with an $\alpha$ of .05, we can run this analysis algorithmically by calling the following in <span class="in">`R`</span>:</span>
<span id="cb29-41"><a href="#cb29-41"></a></span>
<span id="cb29-44"><a href="#cb29-44"></a><span class="in">```{r}</span></span>
<span id="cb29-45"><a href="#cb29-45"></a><span class="fu">library</span>(pwr)</span>
<span id="cb29-46"><a href="#cb29-46"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">8</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb29-47"><a href="#cb29-47"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"two"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span>
<span id="cb29-48"><a href="#cb29-48"></a><span class="in">```</span></span>
<span id="cb29-49"><a href="#cb29-49"></a></span>
<span id="cb29-50"><a href="#cb29-50"></a>In this case, our output indicates that we will need approximately 100 participants per group.</span>
<span id="cb29-51"><a href="#cb29-51"></a></span>
<span id="cb29-52"><a href="#cb29-52"></a><span class="fu">## Simulated power analysis, an example, part 1</span></span>
<span id="cb29-53"><a href="#cb29-53"></a></span>
<span id="cb29-54"><a href="#cb29-54"></a>As an alternative, we might also elect to run our power analysis using Monte Carlo simulation methods. In this simple case we start by creating simulated samples given our effect size parameter. For example, starting with an effect size of <span class="in">`d=.40`</span> we can create 2 groups, a control group with a standard distribution (M = 0, SD = 1) and an experimental group with a mean of 0.4, and SD = 1</span>
<span id="cb29-55"><a href="#cb29-55"></a></span>
<span id="cb29-58"><a href="#cb29-58"></a><span class="in">```{r}</span></span>
<span id="cb29-59"><a href="#cb29-59"></a>control_group <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb29-60"><a href="#cb29-60"></a>experimental_group <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="fl">0.4</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb29-61"><a href="#cb29-61"></a><span class="in">```</span></span>
<span id="cb29-62"><a href="#cb29-62"></a></span>
<span id="cb29-63"><a href="#cb29-63"></a>We then run a independent samples t-test comparing the two groups</span>
<span id="cb29-64"><a href="#cb29-64"></a></span>
<span id="cb29-67"><a href="#cb29-67"></a><span class="in">```{r}</span></span>
<span id="cb29-68"><a href="#cb29-68"></a><span class="fu">t.test</span>(<span class="at">x =</span> control_group, <span class="at">y =</span> experimental_group, <span class="at">paired =</span> F, <span class="at">var.equal =</span> T)</span>
<span id="cb29-69"><a href="#cb29-69"></a><span class="in">```</span></span>
<span id="cb29-70"><a href="#cb29-70"></a></span>
<span id="cb29-71"><a href="#cb29-71"></a>Now lets simulate this process 1000 times. First, we build a tibble that simulates 1000 <span class="in">`control`</span> and <span class="in">`experimental`</span> samples of size <span class="in">`n = 100`</span>. Each row in the tibble <span class="in">`sample_simulations`</span> contains a list containing the <span class="in">`control_sample`</span>, a list containing the <span class="in">`experimental_sample`</span> and their respective means.</span>
<span id="cb29-72"><a href="#cb29-72"></a></span>
<span id="cb29-75"><a href="#cb29-75"></a><span class="in">```{r}</span></span>
<span id="cb29-76"><a href="#cb29-76"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb29-77"><a href="#cb29-77"></a><span class="fu">library</span>(infer)</span>
<span id="cb29-78"><a href="#cb29-78"></a><span class="fu">library</span>(broom)</span>
<span id="cb29-79"><a href="#cb29-79"></a></span>
<span id="cb29-80"><a href="#cb29-80"></a>sample_simulations <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-81"><a href="#cb29-81"></a>  <span class="fu">mutate</span>(<span class="at">control_sample =</span> <span class="fu">map</span>(simulation,<span class="sc">~</span><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb29-82"><a href="#cb29-82"></a>         <span class="at">experimental_sample =</span> <span class="fu">map</span>(simulation,<span class="sc">~</span><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>,<span class="at">mean =</span> <span class="fl">0.4</span>,<span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb29-83"><a href="#cb29-83"></a>         <span class="at">mean_control =</span> <span class="fu">map_dbl</span>(control_sample, <span class="sc">~</span><span class="fu">mean</span>(.)),</span>
<span id="cb29-84"><a href="#cb29-84"></a>         <span class="at">mean_experimental =</span> <span class="fu">map_dbl</span>(experimental_sample, <span class="sc">~</span><span class="fu">mean</span>(.))</span>
<span id="cb29-85"><a href="#cb29-85"></a>         )  </span>
<span id="cb29-86"><a href="#cb29-86"></a><span class="in">```</span></span>
<span id="cb29-87"><a href="#cb29-87"></a></span>
<span id="cb29-88"><a href="#cb29-88"></a>We then follow this up by running a simulation <span class="in">`t.test()`</span> for each row in the <span class="in">`sample_simulations`</span>. The tibble <span class="in">`t_test_simulations`</span>, contains the <span class="in">`tidy()`</span> output for each <span class="in">`t.test()`</span></span>
<span id="cb29-89"><a href="#cb29-89"></a></span>
<span id="cb29-92"><a href="#cb29-92"></a><span class="in">```{r}</span></span>
<span id="cb29-93"><a href="#cb29-93"></a><span class="fu">library</span>(broom)</span>
<span id="cb29-94"><a href="#cb29-94"></a>t_test_simulations <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb29-95"><a href="#cb29-95"></a></span>
<span id="cb29-96"><a href="#cb29-96"></a><span class="cf">for</span> (test_sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb29-97"><a href="#cb29-97"></a>  control <span class="ot">&lt;-</span> sample_simulations<span class="sc">$</span>control_sample[test_sim] <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb29-98"><a href="#cb29-98"></a>  experimental <span class="ot">&lt;-</span> sample_simulations<span class="sc">$</span>experimental_sample[test_sim] <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb29-99"><a href="#cb29-99"></a>  t_test_results <span class="ot">&lt;-</span> <span class="fu">t.test</span>(control,experimental,<span class="at">paired=</span>F,<span class="at">var.equal=</span>T)</span>
<span id="cb29-100"><a href="#cb29-100"></a>  t_test_simulations <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(t_test_simulations,<span class="fu">tidy</span>(t_test_results))</span>
<span id="cb29-101"><a href="#cb29-101"></a>}</span>
<span id="cb29-102"><a href="#cb29-102"></a><span class="in">```</span></span>
<span id="cb29-103"><a href="#cb29-103"></a></span>
<span id="cb29-104"><a href="#cb29-104"></a>Let's take a look at the distribution of <span class="in">`p.values`</span> from our simulations:</span>
<span id="cb29-105"><a href="#cb29-105"></a></span>
<span id="cb29-108"><a href="#cb29-108"></a><span class="in">```{r}</span></span>
<span id="cb29-109"><a href="#cb29-109"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb29-110"><a href="#cb29-110"></a></span>
<span id="cb29-111"><a href="#cb29-111"></a>t_statistic_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(t_test_simulations, <span class="fu">aes</span>(<span class="at">x=</span>statistic)) <span class="sc">+</span></span>
<span id="cb29-112"><a href="#cb29-112"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">theme_cowplot</span>()</span>
<span id="cb29-113"><a href="#cb29-113"></a></span>
<span id="cb29-114"><a href="#cb29-114"></a>p_value_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(t_test_simulations, <span class="fu">aes</span>(<span class="at">x=</span>p.value)) <span class="sc">+</span></span>
<span id="cb29-115"><a href="#cb29-115"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">theme_cowplot</span>()</span>
<span id="cb29-116"><a href="#cb29-116"></a></span>
<span id="cb29-117"><a href="#cb29-117"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(t_statistic_plot, p_value_plot,<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb29-118"><a href="#cb29-118"></a><span class="in">```</span></span>
<span id="cb29-119"><a href="#cb29-119"></a></span>
<span id="cb29-120"><a href="#cb29-120"></a>Finally, we can ask ourselves what percentage of our obtained p-values are *p* <span class="sc">\&lt;</span> .05.</span>
<span id="cb29-121"><a href="#cb29-121"></a></span>
<span id="cb29-124"><a href="#cb29-124"></a><span class="in">```{r}</span></span>
<span id="cb29-125"><a href="#cb29-125"></a><span class="fu">mean</span>(t_test_simulations<span class="sc">$</span>p.value<span class="sc">&lt;</span>.<span class="dv">05</span>)</span>
<span id="cb29-126"><a href="#cb29-126"></a><span class="in">```</span></span>
<span id="cb29-127"><a href="#cb29-127"></a></span>
<span id="cb29-128"><a href="#cb29-128"></a>This is the simulated power, and matches the power obtained using <span class="in">`pwr.t.test`</span>.</span>
<span id="cb29-129"><a href="#cb29-129"></a></span>
<span id="cb29-130"><a href="#cb29-130"></a><span class="fu">## Simulated power analysis, an example, part 2</span></span>
<span id="cb29-131"><a href="#cb29-131"></a></span>
<span id="cb29-132"><a href="#cb29-132"></a>We can reconfigure our simulations to ask a more practical question: how many participants do we need to reach our desired power. In this case, I'm going to start with a realistic minimum number of participants, 10 per group, and work my way up by 5s to a realistic maximum of 200.</span>
<span id="cb29-133"><a href="#cb29-133"></a></span>
<span id="cb29-136"><a href="#cb29-136"></a><span class="in">```{r}</span></span>
<span id="cb29-137"><a href="#cb29-137"></a>participants <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">200</span>,<span class="dv">5</span>)</span>
<span id="cb29-138"><a href="#cb29-138"></a></span>
<span id="cb29-139"><a href="#cb29-139"></a>simulations <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb29-140"><a href="#cb29-140"></a><span class="in">```</span></span>
<span id="cb29-141"><a href="#cb29-141"></a></span>
<span id="cb29-142"><a href="#cb29-142"></a>Now let's redo the simulation above, but this time running 1000 simulations per <span class="in">`n_participants`</span>. First we create an empty tibble crossing <span class="in">`n_participants`</span> and <span class="in">`n_simulations.`</span></span>
<span id="cb29-143"><a href="#cb29-143"></a></span>
<span id="cb29-146"><a href="#cb29-146"></a><span class="in">```{r}</span></span>
<span id="cb29-147"><a href="#cb29-147"></a>sample_simulations <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n_participants =</span> <span class="fu">rep</span>(participants, </span>
<span id="cb29-148"><a href="#cb29-148"></a>                                                  <span class="at">each =</span> <span class="fu">length</span>(simulations)</span>
<span id="cb29-149"><a href="#cb29-149"></a>                                                  ),</span>
<span id="cb29-150"><a href="#cb29-150"></a>                             <span class="at">n_simulations =</span> <span class="fu">rep</span>(simulations, </span>
<span id="cb29-151"><a href="#cb29-151"></a>                                                <span class="at">times =</span> <span class="fu">length</span>(participants)</span>
<span id="cb29-152"><a href="#cb29-152"></a>                                                  ),</span>
<span id="cb29-153"><a href="#cb29-153"></a>                             )</span>
<span id="cb29-154"><a href="#cb29-154"></a><span class="in">```</span></span>
<span id="cb29-155"><a href="#cb29-155"></a></span>
<span id="cb29-156"><a href="#cb29-156"></a>We then run the sample simulations, running 1000 simulations for each sample size of <span class="in">`n_participants`</span></span>
<span id="cb29-157"><a href="#cb29-157"></a></span>
<span id="cb29-160"><a href="#cb29-160"></a><span class="in">```{r}</span></span>
<span id="cb29-161"><a href="#cb29-161"></a>sample_simulations <span class="ot">&lt;-</span> sample_simulations <span class="sc">%&gt;%</span> </span>
<span id="cb29-162"><a href="#cb29-162"></a>  <span class="fu">mutate</span>(<span class="at">control_sample =</span> <span class="fu">map</span>(n_participants,<span class="sc">~</span><span class="fu">rnorm</span>(.,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb29-163"><a href="#cb29-163"></a>         <span class="at">experimental_sample =</span> <span class="fu">map</span>(n_participants,<span class="sc">~</span><span class="fu">rnorm</span>(.,<span class="at">mean =</span> <span class="fl">0.4</span>,<span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb29-164"><a href="#cb29-164"></a>         <span class="at">mean_control =</span> <span class="fu">map_dbl</span>(control_sample, <span class="sc">~</span><span class="fu">mean</span>(.)),</span>
<span id="cb29-165"><a href="#cb29-165"></a>         <span class="at">mean_experimental =</span> <span class="fu">map_dbl</span>(experimental_sample, <span class="sc">~</span><span class="fu">mean</span>(.))</span>
<span id="cb29-166"><a href="#cb29-166"></a>         ) </span>
<span id="cb29-167"><a href="#cb29-167"></a><span class="in">```</span></span>
<span id="cb29-168"><a href="#cb29-168"></a></span>
<span id="cb29-169"><a href="#cb29-169"></a>We then run a <span class="in">`t.test`</span> for each simulation:</span>
<span id="cb29-170"><a href="#cb29-170"></a></span>
<span id="cb29-173"><a href="#cb29-173"></a><span class="in">```{r}</span></span>
<span id="cb29-174"><a href="#cb29-174"></a>t_test_simulations <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb29-175"><a href="#cb29-175"></a></span>
<span id="cb29-176"><a href="#cb29-176"></a><span class="cf">for</span> (test_sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sample_simulations)){</span>
<span id="cb29-177"><a href="#cb29-177"></a>  control <span class="ot">&lt;-</span> sample_simulations<span class="sc">$</span>control_sample[test_sim] <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb29-178"><a href="#cb29-178"></a>  experimental <span class="ot">&lt;-</span> sample_simulations<span class="sc">$</span>experimental_sample[test_sim] <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb29-179"><a href="#cb29-179"></a>  t_test_results <span class="ot">&lt;-</span> <span class="fu">t.test</span>(control,experimental,<span class="at">paired=</span>F,<span class="at">var.equal=</span>T)</span>
<span id="cb29-180"><a href="#cb29-180"></a>  t_test_simulations <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(t_test_simulations,<span class="fu">tidy</span>(t_test_results))</span>
<span id="cb29-181"><a href="#cb29-181"></a>}</span>
<span id="cb29-182"><a href="#cb29-182"></a></span>
<span id="cb29-183"><a href="#cb29-183"></a><span class="in">```</span></span>
<span id="cb29-184"><a href="#cb29-184"></a></span>
<span id="cb29-185"><a href="#cb29-185"></a>Finally we combine our two tables...</span>
<span id="cb29-186"><a href="#cb29-186"></a></span>
<span id="cb29-189"><a href="#cb29-189"></a><span class="in">```{r}</span></span>
<span id="cb29-190"><a href="#cb29-190"></a>simulation_outcomes <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(sample_simulations, t_test_simulations)</span>
<span id="cb29-191"><a href="#cb29-191"></a><span class="in">```</span></span>
<span id="cb29-192"><a href="#cb29-192"></a></span>
<span id="cb29-193"><a href="#cb29-193"></a>generate a summary table containing the proportion of tests that yielded a significant result...</span>
<span id="cb29-194"><a href="#cb29-194"></a></span>
<span id="cb29-197"><a href="#cb29-197"></a><span class="in">```{r}</span></span>
<span id="cb29-198"><a href="#cb29-198"></a>power_table <span class="ot">&lt;-</span> simulation_outcomes <span class="sc">%&gt;%</span> </span>
<span id="cb29-199"><a href="#cb29-199"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(n_participants) <span class="sc">%&gt;%</span></span>
<span id="cb29-200"><a href="#cb29-200"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">mean</span>(p.value<span class="sc">&lt;</span>.<span class="dv">05</span>))</span>
<span id="cb29-201"><a href="#cb29-201"></a><span class="in">```</span></span>
<span id="cb29-202"><a href="#cb29-202"></a></span>
<span id="cb29-203"><a href="#cb29-203"></a>and plot, here the horizontal line represents desired power of .80. Essentially we a looking for the first point that is above this line, which is at about 100 participants.</span>
<span id="cb29-204"><a href="#cb29-204"></a></span>
<span id="cb29-207"><a href="#cb29-207"></a><span class="in">```{r}</span></span>
<span id="cb29-208"><a href="#cb29-208"></a><span class="fu">ggplot</span>(power_table, <span class="fu">aes</span>(<span class="at">x =</span> n_participants, <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb29-209"><a href="#cb29-209"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-210"><a href="#cb29-210"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb29-211"><a href="#cb29-211"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">8</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>)</span>
<span id="cb29-212"><a href="#cb29-212"></a><span class="in">```</span></span>
<span id="cb29-213"><a href="#cb29-213"></a></span>
<span id="cb29-214"><a href="#cb29-214"></a><span class="fu"># No one man should have all that `Superpower`</span></span>
<span id="cb29-215"><a href="#cb29-215"></a></span>
<span id="cb29-216"><a href="#cb29-216"></a>The two examples above were to provide a gist of how to conduct a simple power analysis using simulation methods. Moving forward, we'll ramp up the complexity of our designs by including ANOVA. One thing that is apparent is that creating the simulated datasets as above may become a little cumbersome. Fortunately for us, there are packages in <span class="in">`R`</span> that do the heavy lifting in this process for us.</span>
<span id="cb29-217"><a href="#cb29-217"></a></span>
<span id="cb29-218"><a href="#cb29-218"></a>A relatively new, but powerful (haha) package is <span class="in">`Superpower`</span> (haha) developed by Daniel Lakens and Aaron Caldwell. A paper outlining this package can be found <span class="co">[</span><span class="ot">here</span><span class="co">](https://psyarxiv.com/baxsf/)</span>. Let's load in the package:</span>
<span id="cb29-219"><a href="#cb29-219"></a></span>
<span id="cb29-222"><a href="#cb29-222"></a><span class="in">```{r}</span></span>
<span id="cb29-223"><a href="#cb29-223"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(Superpower)</span>
<span id="cb29-224"><a href="#cb29-224"></a><span class="in">```</span></span>
<span id="cb29-225"><a href="#cb29-225"></a></span>
<span id="cb29-226"><a href="#cb29-226"></a>The first step is to consider the design and predicted effects of your anticipated data set. For example in our general example above we have a between-groups design with 2 factors. We had an estimated effect size of Cohen's *d* = 0.4. We elected to run a t-test given this design, although FWIW we could have also run an ANOVA.</span>
<span id="cb29-227"><a href="#cb29-227"></a></span>
<span id="cb29-228"><a href="#cb29-228"></a>We can input this information into <span class="in">`Superpower`</span> using <span class="in">`ANOVA_design()`</span>:</span>
<span id="cb29-229"><a href="#cb29-229"></a></span>
<span id="cb29-230"><a href="#cb29-230"></a><span class="ss">-   </span><span class="in">`design`</span> is the combination of number of type of factor (within = "w", between = "b") and number of levels. Here we have 1 between factor with 2 levels ("control", "experimental"), hence "2b"</span>
<span id="cb29-231"><a href="#cb29-231"></a></span>
<span id="cb29-232"><a href="#cb29-232"></a><span class="ss">-   </span><span class="in">`n`</span> = number of total participants</span>
<span id="cb29-233"><a href="#cb29-233"></a></span>
<span id="cb29-234"><a href="#cb29-234"></a><span class="ss">-   </span><span class="in">`mu`</span> = our hypothesized means</span>
<span id="cb29-235"><a href="#cb29-235"></a></span>
<span id="cb29-236"><a href="#cb29-236"></a><span class="ss">-   </span><span class="in">`sd`</span> = our hypothesized standard deviations</span>
<span id="cb29-237"><a href="#cb29-237"></a></span>
<span id="cb29-238"><a href="#cb29-238"></a><span class="ss">-   </span><span class="in">`labelnames`</span> = the labels for our conditions</span>
<span id="cb29-239"><a href="#cb29-239"></a></span>
<span id="cb29-240"><a href="#cb29-240"></a><span class="ss">-   </span><span class="in">`plot`</span> = do you want to see a plot of your hypothetical data</span>
<span id="cb29-241"><a href="#cb29-241"></a></span>
<span id="cb29-244"><a href="#cb29-244"></a><span class="in">```{r}</span></span>
<span id="cb29-245"><a href="#cb29-245"></a><span class="fu">library</span>(Superpower)</span>
<span id="cb29-246"><a href="#cb29-246"></a>my_ANOVA_design <span class="ot">&lt;-</span><span class="fu">ANOVA_design</span>(<span class="at">design =</span> <span class="st">"2b"</span>,</span>
<span id="cb29-247"><a href="#cb29-247"></a>                             <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb29-248"><a href="#cb29-248"></a>                             <span class="at">mu =</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">4</span>), </span>
<span id="cb29-249"><a href="#cb29-249"></a>                             <span class="at">sd =</span> <span class="dv">1</span>,</span>
<span id="cb29-250"><a href="#cb29-250"></a>                             <span class="at">labelnames =</span><span class="fu">c</span>(<span class="st">"condition"</span>,<span class="st">"control"</span>, <span class="st">"experimental"</span>),</span>
<span id="cb29-251"><a href="#cb29-251"></a>                             <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-252"><a href="#cb29-252"></a></span>
<span id="cb29-253"><a href="#cb29-253"></a>my_ANOVA_design</span>
<span id="cb29-254"><a href="#cb29-254"></a><span class="in">```</span></span>
<span id="cb29-255"><a href="#cb29-255"></a></span>
<span id="cb29-256"><a href="#cb29-256"></a>From here you would take your <span class="in">`design_result`</span> and plug it into the <span class="in">`ANOVA_power`</span>, including (but not limited to) the following arguments:</span>
<span id="cb29-257"><a href="#cb29-257"></a></span>
<span id="cb29-258"><a href="#cb29-258"></a><span class="ss">-   </span><span class="in">`alpha_level`</span>: p value</span>
<span id="cb29-259"><a href="#cb29-259"></a></span>
<span id="cb29-260"><a href="#cb29-260"></a><span class="ss">-   </span><span class="in">`correction`</span>: in the case that you have a repeated measures design, you can run your analysis assuming that you correct for potential sphericity violations</span>
<span id="cb29-261"><a href="#cb29-261"></a></span>
<span id="cb29-262"><a href="#cb29-262"></a><span class="ss">-   </span><span class="in">`p_adjust`</span>: assuming you anticipate multiple comparisons, run your power analysis accounting for familywise error adjustments</span>
<span id="cb29-263"><a href="#cb29-263"></a></span>
<span id="cb29-264"><a href="#cb29-264"></a><span class="ss">-   </span><span class="in">`nsims`</span>: how many simulations to run</span>
<span id="cb29-265"><a href="#cb29-265"></a></span>
<span id="cb29-266"><a href="#cb29-266"></a><span class="ss">-   </span><span class="in">`seed`</span>: equivalent to <span class="in">`set.seed()`</span> for reproducibility</span>
<span id="cb29-267"><a href="#cb29-267"></a></span>
<span id="cb29-268"><a href="#cb29-268"></a><span class="ss">-   </span><span class="in">`verbose`</span>: do you want it to print the output?</span>
<span id="cb29-269"><a href="#cb29-269"></a></span>
<span id="cb29-272"><a href="#cb29-272"></a><span class="in">```{r}</span></span>
<span id="cb29-273"><a href="#cb29-273"></a><span class="fu">ANOVA_power</span>(<span class="at">design_result =</span> my_ANOVA_design,</span>
<span id="cb29-274"><a href="#cb29-274"></a>            <span class="at">alpha_level =</span> .<span class="dv">05</span>,</span>
<span id="cb29-275"><a href="#cb29-275"></a>            <span class="at">correction =</span> <span class="st">"none"</span>,</span>
<span id="cb29-276"><a href="#cb29-276"></a>            <span class="at">p_adjust =</span> <span class="st">"none"</span>,</span>
<span id="cb29-277"><a href="#cb29-277"></a>            <span class="at">nsims =</span> <span class="dv">1000</span>,</span>
<span id="cb29-278"><a href="#cb29-278"></a>            <span class="at">seed =</span> <span class="dv">2020</span>,</span>
<span id="cb29-279"><a href="#cb29-279"></a>            <span class="at">verbose =</span> F)</span>
<span id="cb29-280"><a href="#cb29-280"></a><span class="in">```</span></span>
<span id="cb29-281"><a href="#cb29-281"></a></span>
<span id="cb29-282"><a href="#cb29-282"></a>The output provides estimates of power based upon the provided parameters. For our purposes, the pairwise t-test, we would refer to the outputs labelled <span class="in">`pairwise`</span></span>
<span id="cb29-283"><a href="#cb29-283"></a></span>
<span id="cb29-284"><a href="#cb29-284"></a><span class="fu"># Moving forward</span></span>
<span id="cb29-285"><a href="#cb29-285"></a></span>
<span id="cb29-286"><a href="#cb29-286"></a>For now, this is where I leave you. The goals here were to provide you with a conceptual basis for how we can run power analyses using simulations as well as an introductory example. In future walkthroughs, I will show an example of how to conduct a power analysis given each of the designs that we will encounter. For those that want to get a head start I would check out these two wonderful resources from the authors of <span class="in">`Superpower`</span></span>
<span id="cb29-287"><a href="#cb29-287"></a></span>
<span id="cb29-288"><a href="#cb29-288"></a><span class="fu">## Additional resources</span></span>
<span id="cb29-289"><a href="#cb29-289"></a></span>
<span id="cb29-290"><a href="#cb29-290"></a><span class="ss">-   </span>**The Superpower Github repository** (<span class="ot">&lt;https://github.com/arcaldwell49/Superpower&gt;</span>) provides a more comprehensive walkthrough of <span class="in">`Superpower`</span> using slightly more complex examples than provided here.</span>
<span id="cb29-291"><a href="#cb29-291"></a></span>
<span id="cb29-292"><a href="#cb29-292"></a><span class="ss">-   </span>*Power Analysis with Superpower* (<span class="ot">&lt;https://aaroncaldwell.us/SuperpowerBook/&gt;</span>): is a fully comprehensive web-based text that goes into great detail with how to conduct power analyses for complex ANOVA designs.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>