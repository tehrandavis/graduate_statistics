<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>tehrandav.is - Mixed-effects ANOVA (BS + WS)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">tehrandav.is</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="https://tehrandav.is">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Mixed-effects ANOVA (BS + WS)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../walkthroughs.html" class="sidebar-item-text sidebar-link">PSYC 7014</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">TOPIC 1 INTRO to R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_1-Rmarkdown_basics.html" class="sidebar-item-text sidebar-link">Rmarkdown Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_2-objects_assignment_functions.html" class="sidebar-item-text sidebar-link">Objects, assignment, and functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_3-install_packages.html" class="sidebar-item-text sidebar-link">Installing and loading an <code>R</code> package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_4-loading_data.html" class="sidebar-item-text sidebar-link">Loading in Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_5-leveling-up.html" class="sidebar-item-text sidebar-link">Leveling-up</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">TOPIC 2: DESCRIPTIVE STATS and CENTRAL TENDENCY</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_1-structure_data.html" class="sidebar-item-text sidebar-link">The structure of your data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_2-central_tendency.html" class="sidebar-item-text sidebar-link">Measures of central tendency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_3-summary_tables.html" class="sidebar-item-text sidebar-link">Creating summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_4-means_other_models.html" class="sidebar-item-text sidebar-link">Means and other models</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">TOPIC 3: DATA VISUALIZATION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_1-basic_ggplot.html" class="sidebar-item-text sidebar-link">Basic ggplotting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_2-more_adv_ggplot.html" class="sidebar-item-text sidebar-link">More advanced ggPlots</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">TOPIC 4: DISTRIBUTIONS and NHST</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="sidebar-item-text sidebar-link">Building intuitions about probability and NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_3-sampling_distributions_and_seeing_the_logic_of_nhst.html" class="sidebar-item-text sidebar-link">Sampling distributions and seeing the logic of NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_4-more_examples.html" class="sidebar-item-text sidebar-link">More examples of distributions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_5-bias_variance.html" class="sidebar-item-text sidebar-link">Bias in sample variance estimates</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">TOPIC 5: CORRELATION AND REGRESSION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_2_correlations.html" class="sidebar-item-text sidebar-link">Correlations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_3_regressions.html" class="sidebar-item-text sidebar-link">Regression, pt.&nbsp;1: Running the model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_4_plotting.html" class="sidebar-item-text sidebar-link">Plotting regression data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_5_diagnostics.html" class="sidebar-item-text sidebar-link">Regression model diagnostics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_6_example_report.html" class="sidebar-item-text sidebar-link">Example Report</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">TOPIC 6: T-TESTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_1_t-test.html" class="sidebar-item-text sidebar-link">Testing differences in means / t-test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_2_t-test-null-model.html" class="sidebar-item-text sidebar-link">Thinking about nothing (aka the null)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_3_t-test-lm.html" class="sidebar-item-text sidebar-link">t-test? It’s just a linear model</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">TOPIC 7: POWER &amp; EFFECT SIZES</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_1-effect_size.html" class="sidebar-item-text sidebar-link">Effect Size</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_2-power.html" class="sidebar-item-text sidebar-link">Power</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_3-power_es_sig_tests.html" class="sidebar-item-text sidebar-link">Power, Effect sizes, and Significance testing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_4-simulating_power.html" class="sidebar-item-text sidebar-link">Simulating Power!!!</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">TOPIC 8: INTRO to ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_1-one-way-anova.html" class="sidebar-item-text sidebar-link">The One-way ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_2-anova-regression.html" class="sidebar-item-text sidebar-link">ANOVA and Regression</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">TOPIC 9: ANOVA: CONTRASTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_1-posthocs.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;1: post hoc tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_2-planned_contrasts.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;2: planned contrasts</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">TOPIC 10: ANOVA: FACTORIAL ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_1-main_effects.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - The omnibus ANOVA and Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_2-factorial_w_post_hocs.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - Post hoc analysis of Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_3-advanced_example_and_apa.html" class="sidebar-item-text sidebar-link">Template for Analysis &amp; APA Style</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">TOPIC 11: ANOVA + INTERACTIONS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_1-interactions.html" class="sidebar-item-text sidebar-link">Analysis of Variance: the Factorial ANOVA - Interactions &amp; Simple Effects ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_2-higher_order_anova.html" class="sidebar-item-text sidebar-link">Dealing with Higher Order Factorial ANOVA</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">TOPIC 12: WITHIN SUBJECTS / REPEATED MEASURES ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_1-afex_ANOVA.html" class="sidebar-item-text sidebar-link">afex is for ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_2-repeated_measures_anova.html" class="sidebar-item-text sidebar-link">Within Subjects / Repeated Measures ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_3-factorial_rma.html" class="sidebar-item-text sidebar-link">Factorial RM-ANOVA and simple effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_4-sphericity.html" class="sidebar-item-text sidebar-link">Sphericity: Variances and Co-Variances</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_5-spss_rma.html" class="sidebar-item-text sidebar-link">Running a RM-ANOVA in SPSS</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">TOPIC 13: MIXED ANOVA (BS + WS)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/13_1-mixed_effects_anova.html" class="sidebar-item-text sidebar-link active">Mixed-effects ANOVA (BS + WS)</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#tldr" id="toc-tldr" class="nav-link active" data-scroll-target="#tldr">TL;DR</a></li>
  <li>
<a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example 1:</a>
  <ul class="collapse">
<li><a href="#data-import-and-wrangling" id="toc-data-import-and-wrangling" class="nav-link" data-scroll-target="#data-import-and-wrangling">data import and wrangling</a></li>
  <li><a href="#testing-the-homogeneity-of-covariances" id="toc-testing-the-homogeneity-of-covariances" class="nav-link" data-scroll-target="#testing-the-homogeneity-of-covariances">testing the homogeneity of covariances</a></li>
  <li><a href="#plotting-the-data" id="toc-plotting-the-data" class="nav-link" data-scroll-target="#plotting-the-data">plotting the data</a></li>
  <li><a href="#running-our-anova" id="toc-running-our-anova" class="nav-link" data-scroll-target="#running-our-anova">Running our ANOVA:</a></li>
  <li><a href="#simple-effects" id="toc-simple-effects" class="nav-link" data-scroll-target="#simple-effects">simple effects</a></li>
  </ul>
</li>
  <li>
<a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example 2:</a>
  <ul class="collapse">
<li><a href="#data-import-and-wrangling-1" id="toc-data-import-and-wrangling-1" class="nav-link" data-scroll-target="#data-import-and-wrangling-1">data import and wrangling</a></li>
  <li><a href="#plotting-the-data-1" id="toc-plotting-the-data-1" class="nav-link" data-scroll-target="#plotting-the-data-1">plotting the data</a></li>
  <li><a href="#testing-our-assumptions" id="toc-testing-our-assumptions" class="nav-link" data-scroll-target="#testing-our-assumptions">testing our assumptions</a></li>
  <li><a href="#run-your-omnibus-anova" id="toc-run-your-omnibus-anova" class="nav-link" data-scroll-target="#run-your-omnibus-anova">Run your omnibus ANOVA:</a></li>
  <li><a href="#simple-effects-1" id="toc-simple-effects-1" class="nav-link" data-scroll-target="#simple-effects-1">simple effects:</a></li>
  </ul>
</li>
  <li><a href="#to-pool-or-not-to-pool-this-is-the-yada-yada-yada" id="toc-to-pool-or-not-to-pool-this-is-the-yada-yada-yada" class="nav-link" data-scroll-target="#to-pool-or-not-to-pool-this-is-the-yada-yada-yada">to pool or not to pool, this is the yada yada yada</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Mixed-effects ANOVA (BS + WS)</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>For our final trick with ANOVA, we will be covering mixed effects designs. Mixed models sometimes go by many names (mixed effects model, multi-level model, growth-curve models) depending on the structure of the data that is being analyzed. For this week we will be focusing on Mixed effects ANOVA.</p>
<p>This walk-though assumes the following packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, <span class="co">#tidy goodness</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>               cowplot, <span class="co"># easy clean plots</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>               afex, <span class="co"># ANOVA</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>               Rmisc, <span class="co"># summary tables</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>               emmeans, <span class="co"># contrasts</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>               heplots) <span class="co"># homogeneity of covariance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tldr" class="level2"><h2 class="anchored" data-anchor-id="tldr">TL;DR</h2>
<ul>
<li>Mixed ANOVA involve both between-subjects factors and within-subjects factors</li>
<li>Mixed ANOVA designs are more likely to give rise to sphericity violations</li>
<li>In addition to testing for sphericity, we also need to test for homogeneity of covariance matrices (and subsequently homogeneity of variance)</li>
<li>when considering simple effects and post-hoc tests, keep it <code>multivariate</code>.</li>
</ul>
<p><strong>Example:</strong></p>
<ol type="1">
<li>loading in data</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>example <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab14-4.dat"</span>, </span>
<span id="cb2-2"><a href="#cb2-2"></a>                      <span class="at">delim=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 24 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
dbl (7): Group, Int1, Int2, Int3, Int4, Int5, Int6

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>data wrangling:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># create subject column</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>example <span class="ot">&lt;-</span>  example <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">"SubjectID"</span> <span class="ot">=</span> <span class="fu">seq_along</span>(example<span class="sc">$</span>Group)) </span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># data in long format</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>example_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> example, </span>
<span id="cb4-5"><a href="#cb4-5"></a>                                    <span class="at">names_to =</span> <span class="st">"Interval"</span>, </span>
<span id="cb4-6"><a href="#cb4-6"></a>                                    <span class="at">values_to =</span> <span class="st">"Activity"</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a>                                    <span class="at">col =</span> <span class="fu">contains</span>(<span class="st">"Int"</span>))</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># convert 'Interval' to factor:</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>example_long<span class="sc">$</span>Interval <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(example_long<span class="sc">$</span>Interval)</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co"># Name the dummy variables for 'Group' &amp; convert to factor:</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>example_long<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example_long<span class="sc">$</span>Group,</span>
<span id="cb4-14"><a href="#cb4-14"></a>                                    <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Control"</span>,</span>
<span id="cb4-15"><a href="#cb4-15"></a>                                    <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Same"</span>,</span>
<span id="cb4-16"><a href="#cb4-16"></a>                                    <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Different"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Bypassing normality test and plotting…</p>
<ol start="3" type="1">
<li>Box’s M test for homogeneity of covariance matrices</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Within Subjects dependent variables need to be in wide format</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>example_wide <span class="ot">&lt;-</span> example_long <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Interval"</span>, </span>
<span id="cb5-3"><a href="#cb5-3"></a>                                                    <span class="at">values_from =</span> <span class="st">"Activity"</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># box's M</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># boxM(withinSubjects columns, betweenSubjects column)</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>heplots<span class="sc">::</span><span class="fu">boxM</span>(example_wide[,<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>], example_wide<span class="sc">$</span>Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  example_wide[, 3:8]
Chi-Sq (approx.) = 44.272, df = 42, p-value = 0.376</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Run the Anova</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>example_anova <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"SubjectID"</span>,</span>
<span id="cb7-2"><a href="#cb7-2"></a>                              <span class="at">dv =</span> <span class="st">"Activity"</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                              <span class="at">data =</span> example_long,</span>
<span id="cb7-4"><a href="#cb7-4"></a>                              <span class="at">between =</span> <span class="st">"Group"</span>,</span>
<span id="cb7-5"><a href="#cb7-5"></a>                              <span class="at">within =</span> <span class="st">"Interval"</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>                              <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb7-7"><a href="#cb7-7"></a>                              <span class="at">return =</span> <span class="st">"afex_aov"</span>,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                              <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"GG"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: Group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>example_anova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: Activity
          Effect          df      MSE         F  pes p.value
1          Group       2, 21 18320.10   7.80 ** .426    .003
2       Interval 3.28, 68.98  4076.58 29.85 *** .587   &lt;.001
3 Group:Interval 6.57, 68.98  4076.58   3.02 ** .223    .009
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Test simple effects and post-hocs using <code>model=multivariate</code>
</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">joint_tests</span>(example_anova, <span class="at">by=</span><span class="st">"Group"</span>, <span class="at">model=</span><span class="st">"multivariate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Group = Control:
 model term df1 df2 F.ratio p.value
 Interval     5  21   6.045  0.0013

Group = Same:
 model term df1 df2 F.ratio p.value
 Interval     5  21   9.667  0.0001

Group = Different:
 model term df1 df2 F.ratio p.value
 Interval     5  21  13.786  &lt;.0001</code></pre>
</div>
</div>
<p>Simple effects tests revealed significant effects for all three groups. Time for the post-hoc follow-ups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">emmeans</span>(example_anova, <span class="at">by=</span><span class="st">"Group"</span>, <span class="at">spec =</span> pairwise<span class="sc">~</span>Interval, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
Group = Control:
 Interval emmean   SE df lower.CL upper.CL
 Int1      213.9 28.3 21    155.1      273
 Int2       93.2 31.4 21     28.0      158
 Int3       96.5 22.1 21     50.5      142
 Int4      128.6 24.0 21     78.8      178
 Int5      122.9 21.6 21     78.0      168
 Int6      130.1 25.6 21     77.0      183

Group = Same:
 Interval emmean   SE df lower.CL upper.CL
 Int1      354.6 28.3 21    295.9      413
 Int2      266.2 31.4 21    201.0      331
 Int3      221.0 22.1 21    175.0      267
 Int4      170.0 24.0 21    120.1      220
 Int5      198.6 21.6 21    153.8      243
 Int6      178.6 25.6 21    125.5      232

Group = Different:
 Interval emmean   SE df lower.CL upper.CL
 Int1      290.1 28.3 21    231.4      349
 Int2       98.2 31.4 21     33.0      163
 Int3      108.5 22.1 21     62.5      154
 Int4      109.0 24.0 21     59.1      159
 Int5      123.5 21.6 21     78.7      168
 Int6      138.6 25.6 21     85.5      192

Confidence level used: 0.95 

$contrasts
Group = Control:
 contrast    estimate   SE df t.ratio p.value
 Int1 - Int2   120.62 24.6 21   4.894  0.0010
 Int1 - Int3   117.38 27.0 21   4.352  0.0033
 Int1 - Int4    85.25 34.7 21   2.458  0.1820
 Int1 - Int5    91.00 27.5 21   3.304  0.0346
 Int1 - Int6    83.75 31.2 21   2.688  0.1199
 Int2 - Int3    -3.25 20.7 21  -0.157  1.0000
 Int2 - Int4   -35.38 30.7 21  -1.152  0.8538
 Int2 - Int5   -29.62 26.9 21  -1.100  0.8757
 Int2 - Int6   -36.88 27.4 21  -1.343  0.7584
 Int3 - Int4   -32.12 19.7 21  -1.627  0.5912
 Int3 - Int5   -26.38 20.3 21  -1.297  0.7832
 Int3 - Int6   -33.62 17.8 21  -1.885  0.4374
 Int4 - Int5     5.75 21.9 21   0.263  0.9998
 Int4 - Int6    -1.50 21.4 21  -0.070  1.0000
 Int5 - Int6    -7.25 29.5 21  -0.246  0.9999

Group = Same:
 contrast    estimate   SE df t.ratio p.value
 Int1 - Int2    88.38 24.6 21   3.586  0.0188
 Int1 - Int3   133.62 27.0 21   4.954  0.0008
 Int1 - Int4   184.62 34.7 21   5.322  0.0004
 Int1 - Int5   156.00 27.5 21   5.663  0.0002
 Int1 - Int6   176.00 31.2 21   5.648  0.0002
 Int2 - Int3    45.25 20.7 21   2.191  0.2829
 Int2 - Int4    96.25 30.7 21   3.135  0.0493
 Int2 - Int5    67.62 26.9 21   2.512  0.1654
 Int2 - Int6    87.62 27.4 21   3.192  0.0438
 Int3 - Int4    51.00 19.7 21   2.582  0.1457
 Int3 - Int5    22.38 20.3 21   1.101  0.8757
 Int3 - Int6    42.38 17.8 21   2.376  0.2094
 Int4 - Int5   -28.62 21.9 21  -1.310  0.7766
 Int4 - Int6    -8.62 21.4 21  -0.403  0.9984
 Int5 - Int6    20.00 29.5 21   0.678  0.9826

Group = Different:
 contrast    estimate   SE df t.ratio p.value
 Int1 - Int2   191.88 24.6 21   7.785  &lt;.0001
 Int1 - Int3   181.62 27.0 21   6.734  &lt;.0001
 Int1 - Int4   181.12 34.7 21   5.222  0.0004
 Int1 - Int5   166.62 27.5 21   6.049  0.0001
 Int1 - Int6   151.50 31.2 21   4.862  0.0010
 Int2 - Int3   -10.25 20.7 21  -0.496  0.9958
 Int2 - Int4   -10.75 30.7 21  -0.350  0.9992
 Int2 - Int5   -25.25 26.9 21  -0.938  0.9319
 Int2 - Int6   -40.38 27.4 21  -1.471  0.6853
 Int3 - Int4    -0.50 19.7 21  -0.025  1.0000
 Int3 - Int5   -15.00 20.3 21  -0.738  0.9747
 Int3 - Int6   -30.12 17.8 21  -1.689  0.5531
 Int4 - Int5   -14.50 21.9 21  -0.663  0.9841
 Int4 - Int6   -29.62 21.4 21  -1.385  0.7351
 Int5 - Int6   -15.12 29.5 21  -0.513  0.9951

P value adjustment: tukey method for comparing a family of 6 estimates </code></pre>
</div>
</div>
</section><section id="example-1" class="level2"><h2 class="anchored" data-anchor-id="example-1">Example 1:</h2>
<p>In terms of new concepts, we are continuing our theme of “well, nothing terribly new being raised this week”. You’ve done between-subjects (BS) ANOVA, you’ve done within-subjects (WS) ANOVA, you’ve done simple linear regression… now we are simply combining what you know.</p>
<section id="data-import-and-wrangling" class="level3"><h3 class="anchored" data-anchor-id="data-import-and-wrangling">data import and wrangling</h3>
<p>First we import the data. Here’s a little background:</p>
<blockquote class="blockquote">
<p>King (1986) investigated motor activity in rats following injection of the drug midazolam. The ﬁrst time that this drug is injected, it typically leads to a distinct decrease in motor activity. Like morphine, however, a tolerance for midazolam develops rapidly. King wished to know whether that acquired tolerance could be explained on the basis of a conditioned tolerance related to the physical context in which the drug was administered, as in Siegel’s work. He used three groups, collecting the crucial data (presented in the table below) on only the last day, which was the test day. During pretesting, two groups of animals were repeatedly injected with midazolam over several days, whereas the Control group was injected with physiological saline. On the test day, one group—the “Same” group—was injected with midazolam in the same environment in which it had earlier been injected. The “Different” group was also injected with midazolam, but in a different environment. Finally, the Control group was injected with midazolam for the ﬁrst time. This Control group should thus show the typical initial response to the drug (decreased ambulatory behavior), whereas the Same group should show the normal tolerance effect—that is, they should decrease their activity little or not at all in response to the drug on the last trial. If King is correct, however, the Different group should respond similarly to the Control group, because although they have had several exposures to the drug, they are receiving it in a novel context and any conditioned tolerance that might have developed will not have the necessary cues required for its elicitation. The dependent variable in Table 14.4 is a measure of ambulatory behavior, in arbitrary units. Again, the ﬁrst letter of the name of a variable is used as a subscript to indicate what set of means we are referring to. Because the drug is known to be metabolized over a period of approximately 1 hour, King recorded his data in 5-minute blocks, or Intervals. We would expect to see the effect of the drug increase for the ﬁrst few intervals and then slowly taper off. Our analysis uses the ﬁrst six blocks of data.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>example1 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab14-4.dat"</span>, </span>
<span id="cb15-2"><a href="#cb15-2"></a>                       <span class="at">delim=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 24 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
dbl (7): Group, Int1, Int2, Int3, Int4, Int5, Int6

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>example1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 7
   Group  Int1  Int2  Int3  Int4  Int5  Int6
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     1   150    44    71    59   132    74
 2     1   335   270   156   160   118   230
 3     1   149    52    91   115    43   154
 4     1   159    31   127   212    71   224
 5     1   159     0    35    75    71    34
 6     1   292   125   184   246   225   170
 7     1   297   187    66    96   209    74
 8     1   170    37    42    66   114    81
 9     2   346   175   177   192   239   140
10     2   426   329   236    76   102   232
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>The data above is in wide format. I need to get it into long format before submitting it for further analysis. Before doing so, however, I also need to add a <code>SubjectID</code> to let <code>R</code> know which data belongs to which subject. If you are presented with repeated measures or within subjects data with no subject column, it’s easiest to create your <code>SubjectID</code> column BEFORE you <code>pivot_longer()</code> (conversely if you only have between subjects data then I would add your <code>SubjectID</code> after gathering:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># create subject column</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># seq_along on Group ensures that every between participant gets a unique ID</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>example1 <span class="ot">&lt;-</span>  example1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">"SubjectID"</span> <span class="ot">=</span> <span class="fu">seq_along</span>(example1<span class="sc">$</span>Group)) </span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co"># data is in wide format, needs to be long format for R,</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co"># notice that I only need to collapse the "Interval" columns (2 through 7):</span></span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a>example1_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> example1,</span>
<span id="cb19-9"><a href="#cb19-9"></a>                                     <span class="co"># get columns that contain "Int":</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>                                     <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"Int"</span>), </span>
<span id="cb19-11"><a href="#cb19-11"></a>                                     <span class="at">names_to =</span> <span class="st">"Interval"</span>, </span>
<span id="cb19-12"><a href="#cb19-12"></a>                                     <span class="at">values_to =</span> <span class="st">"Activity"</span>)</span>
<span id="cb19-13"><a href="#cb19-13"></a></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co"># convert 'Interval' to factor:</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>example1_long<span class="sc">$</span>Interval <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(example1_long<span class="sc">$</span>Interval)</span>
<span id="cb19-16"><a href="#cb19-16"></a></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co"># Name the dummy variables for 'Group' &amp; convert to factor:</span></span>
<span id="cb19-18"><a href="#cb19-18"></a>example1_long<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example1_long<span class="sc">$</span>Group,</span>
<span id="cb19-19"><a href="#cb19-19"></a>                                     <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Control"</span>,</span>
<span id="cb19-20"><a href="#cb19-20"></a>                                     <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Same"</span>,</span>
<span id="cb19-21"><a href="#cb19-21"></a>                                     <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Different"</span>)</span>
<span id="cb19-22"><a href="#cb19-22"></a></span>
<span id="cb19-23"><a href="#cb19-23"></a>example1_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 144 × 4
   Group   SubjectID Interval Activity
   &lt;fct&gt;       &lt;int&gt; &lt;fct&gt;       &lt;dbl&gt;
 1 Control         1 Int1          150
 2 Control         1 Int2           44
 3 Control         1 Int3           71
 4 Control         1 Int4           59
 5 Control         1 Int5          132
 6 Control         1 Int6           74
 7 Control         2 Int1          335
 8 Control         2 Int2          270
 9 Control         2 Int3          156
10 Control         2 Int4          160
# ℹ 134 more rows</code></pre>
</div>
</div>
</section><section id="testing-the-homogeneity-of-covariances" class="level3"><h3 class="anchored" data-anchor-id="testing-the-homogeneity-of-covariances">testing the homogeneity of covariances</h3>
<p>Our assumptions tests have been pretty standard every week: tests for normality, tests for homogeneity of variance. Last week, with WS-ANOVA we introduced a new wrinkle, instead of explicitly testing for homogeneity of variance (as with BS-ANOVA), for WS-ANOVA we instead test for sphericity, which we described as “homogeneity of the sums of variances-covariances”. In last week’s lecture I walked thru an example of sphericity noting the properties of the variance / covariance matrix and in particular how to assess sphericity.</p>
<p>The sphericity assumption is tested for each WS-ANOVA independent variable with more than 2-levels. So if you have a 3 (e.g., Condition) × 3 (e.g., Time) Within Subject ANOVA, you will have two sphericity tests, one for independent variable “Condition” and another for “Time”. For the sake of example, for now lets just assume that you have the one WS-ANOVA independent variable, “Time”. The covariance matrix for Time would take the general form:</p>
<p><span class="math display">\[
\left[\begin{array}{cc}
Var_1 &amp; Cov_{12} &amp; Cov_{13}\\
Cov_{12} &amp; Var_2 &amp; Cov_{23}\\
Cov_{13} &amp; Cov_{23} &amp; Var_3\\
\end{array}\right]
\]</span></p>
<p>Now let’s consider if we have Time crossed with a between factor, “Group” with two levels. Typically for between factors we need to assess homogeneity of variance, and to a degree that remains true here. But at the same time (ha) each independent Group is confounded by “Time”. Or to think about it the reverse, the effect “Time” is nested in two independent Groups of people, and as such may play out differently within each group. As a result we need to assess the sphericity of “Time” within each of our two independent groups.</p>
<p><span class="math display">\[
Group A\left[\begin{array}{cc}
Var_1 &amp; Cov_{12} &amp; Cov_{13}\\
Cov_{12} &amp; Var_2 &amp; Cov_{23}\\
Cov_{13} &amp; Cov_{23} &amp; Var_3\\
\end{array}\right]
=
GroupB\left[\begin{array}{cc}
Var_1 &amp; Cov_{12} &amp; Cov_{13}\\
Cov_{12} &amp; Var_2 &amp; Cov_{23}\\
Cov_{13} &amp; Cov_{23} &amp; Var_3\\
\end{array}\right]
\]</span></p>
<p>To address both of these considerations, we need to run a series of tests. Neither of these tests alone is a silver bullet, but taken together they should offer a window into whether we have any serious problems with our data.</p>
<section id="test-1-boxs-m" class="level4"><h4 class="anchored" data-anchor-id="test-1-boxs-m">Test 1: Box’s <code>M</code>
</h4>
<p>In his 1953 paper, <em>Non-Normality And Tests On Variances</em> George Box makes the declaration:</p>
<blockquote class="blockquote">
<p>To make the preliminary test on variances is rather like putting to sea in a rowing boat to find out whether conditions are sufficiently calm for an ocean liner to leave port!</p>
</blockquote>
<p>This reinforces our in class discussions about the robustness of ANOVA. Nonetheless, we should still test to get an impression of how far we are deviating from our assumptions. Here, we are testing for homogeneity of covariance matrices. To do so we will use Box’s (1949) <a href="https://en.wikiversity.org/wiki/Box%27s_M">M test</a> (be sure to check the class website for a link to the original article). In short, the test compares the product of the log determinants of the separate covariance matrices to the log determinant of the pooled covariance matrix, analogous to a likelihood ratio test. See <a href="https://www.mathsisfun.com/algebra/matrix-determinant.html">here</a> for how determinants are calculated. The test statistic uses a chi-square approximation. This test can be found in the <code>heplots</code> package.</p>
<section id="running-the-boxm-getting-the-data-in-wide-format" class="level5"><h5 class="anchored" data-anchor-id="running-the-boxm-getting-the-data-in-wide-format">Running the <code>boxM</code>: getting the data in WIDE format?!?!?</h5>
<p>Well, this is awkward. In order to test this assumption the data needs structured with the within variable in wide format… which is exactly the way that it was when we originally downloaded it. In order to go from long format to wide format we can use the <code>pivot_wider()</code> function (or in this case we could just use our original data frame).</p>
<p>In this case we want our dependent variable <code>Activity</code> to be spread across differing columns of <code>Interval</code>. The generic form of the <code>pivot_wider()</code> function is <code>pivot_wider(names_from = "column that has IV names", values_from = "column that contains DV")</code>. Based on our needs then:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>example1_wide <span class="ot">&lt;-</span> example1_long <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Interval"</span>, <span class="at">values_from =</span> <span class="st">"Activity"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>example1_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 8
   Group   SubjectID  Int1  Int2  Int3  Int4  Int5  Int6
   &lt;fct&gt;       &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Control         1   150    44    71    59   132    74
 2 Control         2   335   270   156   160   118   230
 3 Control         3   149    52    91   115    43   154
 4 Control         4   159    31   127   212    71   224
 5 Control         5   159     0    35    75    71    34
 6 Control         6   292   125   184   246   225   170
 7 Control         7   297   187    66    96   209    74
 8 Control         8   170    37    42    66   114    81
 9 Same            9   346   175   177   192   239   140
10 Same           10   426   329   236    76   102   232
# ℹ 14 more rows</code></pre>
</div>
</div>
<p><strong>Important</strong> note that we only <code>pivot_wider()</code> our within-subjects data. We DO NOT <code>pivot_wider()</code> the between subjects data. In this case, we leave <code>Group</code> alone!</p>
<p><code>example1_wide</code> gets us back to where we started (sorry for running you in circles), but I wanted to show you how this is done in case you get your data in long format. Now that the data is in wide format, we can check for the homogeneity of covariance matrices using <code>boxM</code>.</p>
</section><section id="using-the-boxm-test." class="level5"><h5 class="anchored" data-anchor-id="using-the-boxm-test.">Using the <code>boxM</code> test.</h5>
<p>The call for the <code>boxM</code> takes two arguments</p>
<ul>
<li>the within-subject columns</li>
<li>the between subject column</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>ws_columns <span class="ot">&lt;-</span> example1_wide <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"Int"</span>))</span>
<span id="cb23-2"><a href="#cb23-2"></a>bs_column <span class="ot">&lt;-</span> example1_wide<span class="sc">$</span>Group</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a>heplots<span class="sc">::</span><span class="fu">boxM</span>(ws_columns,bs_column)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  ws_columns
Chi-Sq (approx.) = 44.272, df = 42, p-value = 0.376</code></pre>
</div>
</div>
<p>Note that we typically only concern ourselves with <code>boxM</code> if <span class="math inline">\(p\)</span> &lt; .001. Why so conservative you ask? Because <code>boxM</code> is typically underpowered for small samples and overly sensitive with larger sample sizes (Cohen, 2008). Then why use it, you may ask… ahh it’s just step 1 my young Padawan.</p>
<p>In either case these data look good.</p>
</section></section><section id="test-2-our-friend-levene-and-its-cousin-brown-forsythe" class="level4"><h4 class="anchored" data-anchor-id="test-2-our-friend-levene-and-its-cousin-brown-forsythe">Test 2: Our friend Levene (and its cousin Brown-Forsythe)</h4>
<p>Let’s assume that we failed <code>boxM</code>, what the next step? We can run Levene’s Test for homogeneity of variance, or Brown-Forsythe if we have concerns about the normality of the data. Recall that both can be called from <code><a href="https://rdrr.io/pkg/car/man/leveneTest.html">car::leveneTest()</a></code> where Levene’s is <code>mean centered</code> and Brown-Forsythe is <code>median centered</code>. In this case we run separate tests on the between subjects <code>Group</code> and the BS × WS interaction, in this case <code>Group * Interval</code>.</p>
<p><strong>Note that do do this we return to our data in long format.</strong></p>
<p>Here I’ll run Brown-Forsythe</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Brown-Forsythe for Group only</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">leveneTest</span>(Activity<span class="sc">~</span>Group,<span class="at">data =</span> example1_long, <span class="at">center=</span><span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "median")
       Df F value Pr(&gt;F)
group   2  1.0099 0.3669
      141               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Brown-Forsythe for Group * Interval interaction.</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">leveneTest</span>(Activity<span class="sc">~</span>Group<span class="sc">*</span>Interval,<span class="at">data =</span> example1_long, <span class="at">center=</span><span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "median")
       Df F value Pr(&gt;F)
group  17  0.4772 0.9592
      126               </code></pre>
</div>
</div>
<p>In this case we are particularly concerned with the outcome of the <code>Group*Interval</code> interaction. If this interaction had been significant (<span class="math inline">\(p\)</span> &lt; .05), coupled with a significant <code>boxM</code> (<span class="math inline">\(p\)</span> &lt; .001) then we would have cause for concern.</p>
<p>I’ll say it one more time with feeling—you should be concerned about your data if:</p>
<ul>
<li>the <code>boxM</code> test is significant (<span class="math inline">\(p\)</span> &lt; .001) AND</li>
<li>the Levene’s test of a model that crosses the BS variable * WS variable is significant (<span class="math inline">\(p\)</span> &lt; .05)</li>
</ul></section><section id="what-to-do-if-you-violate-both-tests" class="level4"><h4 class="anchored" data-anchor-id="what-to-do-if-you-violate-both-tests">What to do if you violate both tests?</h4>
<p><strong>You shouldn’t run the mixed ANOVA. Instead:</strong></p>
<ul>
<li>run separate WS-ANOVA for <code>Interval</code> on each <code>Group</code>
</li>
<li>run a BS-ANOVA on <code>Group</code> collapsing <code>Interval</code> into means (e.g., take <code>mean(Int1,Int2, etc...</code>)</li>
</ul>
<p>This means that you do not test for between subjects interactions.</p>
<p><strong><em>Wait?!??!?! What?!?!?</em></strong></p>
<p>Well, technically you would not test between subjects interactions, but this might not be practical if the between subjects interaction is what you were most interested in. Better, just <strong>proceed with caution</strong>!!!</p>
<p>For the sake of example, assume that these data failed both tests. To run separate WS-ANOVA for interval for each group, we could use <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> from the <code>tidyverse</code> to isolate different groups. For example, to filter for <code>Control</code> and run the subsequent ANOVA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>control_data <span class="ot">&lt;-</span> example1_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Group<span class="sc">==</span><span class="st">"Control"</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a></span>
<span id="cb29-3"><a href="#cb29-3"></a>afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"SubjectID"</span>,</span>
<span id="cb29-4"><a href="#cb29-4"></a>             <span class="at">dv =</span> <span class="st">"Activity"</span>,</span>
<span id="cb29-5"><a href="#cb29-5"></a>             <span class="at">data =</span> control_data,</span>
<span id="cb29-6"><a href="#cb29-6"></a>             <span class="at">within =</span> <span class="st">"Interval"</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>             <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb29-8"><a href="#cb29-8"></a>             <span class="at">return =</span> <span class="st">"afex_aov"</span>,</span>
<span id="cb29-9"><a href="#cb29-9"></a>             <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: Activity
    Effect    df     MSE        F  pes p.value
1 Interval 5, 35 2685.67 5.69 *** .449   &lt;.001
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>That said, you can also use <code><a href="https://rdrr.io/r/base/split.html">split()</a></code> like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># split(data frame to split, column to split the data frame by)</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>byGroup <span class="ot">&lt;-</span> <span class="fu">split</span>(example1_long,example1_long<span class="sc">$</span>Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running <code>names(byGroup)</code> reveals this object holds three groups named “Control”, “Same”, &amp; “Different”.</p>
<p>Then we run each group separately, here’s <code>Control</code> again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"SubjectID"</span>,</span>
<span id="cb32-2"><a href="#cb32-2"></a>             <span class="at">dv =</span> <span class="st">"Activity"</span>,</span>
<span id="cb32-3"><a href="#cb32-3"></a>             <span class="at">data =</span> byGroup<span class="sc">$</span>Control,</span>
<span id="cb32-4"><a href="#cb32-4"></a>             <span class="at">within =</span> <span class="st">"Interval"</span>,</span>
<span id="cb32-5"><a href="#cb32-5"></a>             <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>             <span class="at">return =</span> <span class="st">"afex_aov"</span>,</span>
<span id="cb32-7"><a href="#cb32-7"></a>             <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We could run BS-ANOVA on each interval using similar methods.</p>
</section></section><section id="plotting-the-data" class="level3"><h3 class="anchored" data-anchor-id="plotting-the-data">plotting the data</h3>
<p>Now we can plot (not worrying about APA here). Given that interval is a within subjects variable we need to make the appropriate corrections to the error bars. For this we call on Morey (2008) recommendations and use the <code>withinSummary()</code> function from our helperFunctions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># grabbing custom function</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="fu">source</span>(<span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/custom_functions/withinSummary.R"</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># creating a summary table</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>repdata <span class="ot">&lt;-</span> <span class="fu">withinSummary</span>(<span class="at">data =</span> example1_long,</span>
<span id="cb33-6"><a href="#cb33-6"></a>                         <span class="at">measurevar =</span> <span class="st">"Activity"</span>,</span>
<span id="cb33-7"><a href="#cb33-7"></a>                         <span class="at">betweenvars =</span> <span class="st">"Group"</span>,</span>
<span id="cb33-8"><a href="#cb33-8"></a>                         <span class="at">withinvars =</span> <span class="st">"Interval"</span>,</span>
<span id="cb33-9"><a href="#cb33-9"></a>                         <span class="at">idvar =</span> <span class="st">"SubjectID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:lubridate':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    between, first, last</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    transpose</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">show</span>(repdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Actual
       Group Interval N Activity        sd       se       ci
1    Control     Int1 8  213.875  79.21118 28.00538 66.22220
2    Control     Int2 8   93.250  93.27341 32.97713 77.97852
3    Control     Int3 8   96.500  54.10308 19.12833 45.23130
4    Control     Int4 8  128.625  70.31346 24.85956 58.78352
5    Control     Int5 8  122.875  65.24117 23.06624 54.54299
6    Control     Int6 8  130.125  74.54708 26.35637 62.32292
7       Same     Int1 8  354.625  89.91415 31.78945 75.17011
8       Same     Int2 8  266.250 109.68754 38.78040 91.70108
9       Same     Int3 8  221.000  69.88153 24.70685 58.42242
10      Same     Int4 8  170.000  78.10798 27.61534 65.29991
11      Same     Int5 8  198.625  66.22243 23.41317 55.36334
12      Same     Int6 8  178.625  83.59415 29.55500 69.88646
13 Different     Int1 8  290.125  69.32210 24.50906 57.95473
14 Different     Int2 8   98.250  53.47563 18.90649 44.70674
15 Different     Int3 8  108.500  62.66236 22.15449 52.38704
16 Different     Int4 8  109.000  52.52754 18.57129 43.91413
17 Different     Int5 8  123.500  50.10275 17.71400 41.88695
18 Different     Int6 8  138.625  56.01514 19.80434 46.82983

$Corrected
       Group Interval N Activity ActivityNormed       sd        se       ci
1    Control     Int1 8  213.875       252.0208 42.93727 15.180619 35.89646
2    Control     Int2 8   93.250       131.3958 60.97203 21.556867 50.97389
3    Control     Int3 8   96.500       134.6458 29.69636 10.499249 24.82678
4    Control     Int4 8  128.625       166.7708 50.29608 17.782348 42.04857
5    Control     Int5 8  122.875       161.0208 61.46319 21.730519 51.38451
6    Control     Int6 8  130.125       168.2708 57.99589 20.504645 48.48578
7  Different     Int1 8  290.125       314.4792 62.57831 22.124775 52.31678
8  Different     Int2 8   98.250       122.6042 37.02406 13.089982 30.95289
9  Different     Int3 8  108.500       132.8542 35.38455 12.510329 29.58223
10 Different     Int4 8  109.000       133.3542 47.96854 16.959440 40.10270
11 Different     Int5 8  123.500       147.8542 24.64742  8.714178 20.60576
12 Different     Int6 8  138.625       162.9792 42.17568 14.911355 35.25975
13      Same     Int1 8  354.625       292.1250 81.80616 28.922844 68.39166
14      Same     Int2 8  266.250       203.7500 58.83091 20.799867 49.18387
15      Same     Int3 8  221.000       158.5000 27.46850  9.711581 22.96424
16      Same     Int4 8  170.000       107.5000 61.61729 21.785000 51.51334
17      Same     Int5 8  198.625       136.1250 56.19523 19.868015 46.98039
18      Same     Int6 8  178.625       116.1250 54.79954 19.374564 45.81356</code></pre>
</div>
</div>
<p>This contains the means (<code>Activity</code>), normed means (<code>ActivityNormed</code>), and estimates of distribution for each <code>Group</code> × <code>Interval</code> Condition. The normed means are calculated by removing the between-subject variability. This is accomplished be ensuring that each participant have the same average (see this link for background and calculations <a href="http://www.cogsci.nl/blog/tutorials/156-an-easy-way-to-create-graphs-with-within-subject-error-bars">link</a>, Values of se, ci, and sd are then calculated on this normed data. For or resulting plot, we use the raw data for our means and the corrected sd, se, or ci for our error bars.</p>
<p>Using ggplot, this can be accomplished by using the data from our summary table <code>repdata$Corrected</code> and using direct calls instead of <code>summary_stat</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># create universal position dodge</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co"># this takes care of points, errorbars, and lines</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>dodge_all <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(.<span class="dv">3</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co"># now plot:</span></span>
<span id="cb40-6"><a href="#cb40-6"></a></span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="fu">ggplot</span>(<span class="at">data =</span> repdata<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Interval,</span>
<span id="cb40-8"><a href="#cb40-8"></a>                                              <span class="at">y=</span>Activity,</span>
<span id="cb40-9"><a href="#cb40-9"></a>                                              <span class="at">group=</span>Group)</span>
<span id="cb40-10"><a href="#cb40-10"></a>       ) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Group, </span>
<span id="cb40-12"><a href="#cb40-12"></a>                      <span class="at">ymin=</span>Activity<span class="sc">-</span>se, </span>
<span id="cb40-13"><a href="#cb40-13"></a>                      <span class="at">ymax=</span>Activity<span class="sc">+</span>se), </span>
<span id="cb40-14"><a href="#cb40-14"></a>                  <span class="at">size=</span>.<span class="dv">5</span>, </span>
<span id="cb40-15"><a href="#cb40-15"></a>                  <span class="at">position =</span> dodge_all) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Group), <span class="at">size=</span><span class="dv">1</span>, <span class="at">position =</span> dodge_all) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="13_1-mixed_effects_anova_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now THESE are the error bars we’re looking for!</p>
<p>Remember however, when reporting the error values, you need to use the actual values and NOT the corrected ones from this plot. For this you would refer to the data in the <code>repdata$Actual</code> function.</p>
</section><section id="running-our-anova" class="level3"><h3 class="anchored" data-anchor-id="running-our-anova">Running our ANOVA:</h3>
<p>Running the ANOVA in <code>afex</code> is same as before, we just specify BOTH <code>within</code> and <code>between</code> IVs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>ex1.aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"SubjectID"</span>,</span>
<span id="cb42-2"><a href="#cb42-2"></a>                        <span class="at">dv =</span> <span class="st">"Activity"</span>,</span>
<span id="cb42-3"><a href="#cb42-3"></a>                        <span class="at">data =</span> example1_long,</span>
<span id="cb42-4"><a href="#cb42-4"></a>                        <span class="at">between =</span> <span class="st">"Group"</span>,</span>
<span id="cb42-5"><a href="#cb42-5"></a>                        <span class="at">within =</span> <span class="st">"Interval"</span>,</span>
<span id="cb42-6"><a href="#cb42-6"></a>                        <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb42-7"><a href="#cb42-7"></a>                        <span class="at">return =</span> <span class="st">"afex_aov"</span>,</span>
<span id="cb42-8"><a href="#cb42-8"></a>                        <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"GG"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: Group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>ex1.aov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: Activity
          Effect          df      MSE         F  pes p.value
1          Group       2, 21 18320.10   7.80 ** .426    .003
2       Interval 3.28, 68.98  4076.58 29.85 *** .587   &lt;.001
3 Group:Interval 6.57, 68.98  4076.58   3.02 ** .223    .009
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">summary</span>(ex1.aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

                Sum Sq num Df Error SS den Df  F value    Pr(&gt;F)    
(Intercept)    4113798      1   384722     21 224.5511 1.097e-12 ***
Group           285815      2   384722     21   7.8006  0.002928 ** 
Interval        399737      5   281199    105  29.8524 &lt; 2.2e-16 ***
Group:Interval   80820     10   281199    105   3.0178  0.002164 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

               Test statistic   p-value
Interval              0.21121 0.0088268
Group:Interval        0.21121 0.0088268


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

                GG eps Pr(&gt;F[GG])    
Interval       0.65694  4.469e-13 ***
Group:Interval 0.65694   0.009185 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                 HF eps   Pr(&gt;F[HF])
Interval       0.793258 2.449168e-15
Group:Interval 0.793258 5.142508e-03</code></pre>
</div>
</div>
<p>Note that sphericity has been violated. <strong>Indeed, mixed ANOVA designs are more likely to give rise to sphericity violations!!</strong> I therefore need to make the appropriate corrections for my ANOVA. In this case a simple re-run of the <code>aov_ez</code> setting <code>correction="GG"</code> should suffice.</p>
</section><section id="simple-effects" class="level3"><h3 class="anchored" data-anchor-id="simple-effects">simple effects</h3>
<p>There are two ways that I can attack the interaction. I can take a look at Interval effects on the different levels of Group; or I can take a look at Group effects on the different levels of Interval. In the first scenario, I’m looking for within effects on a level of a between factor. In the second scenario, I’m looking for between effects (Group) on a level of a within factor (Interval). How my simple effects ANOVA nests my within and between factors has implications for how I do my follow-up.</p>
<section id="by-group-repeated-measures" class="level4"><h4 class="anchored" data-anchor-id="by-group-repeated-measures">by Group (repeated measures)</h4>
<p>If I’m looking at a within effect, nested within a single level of a between factor (scenario 1), then I only need to run simple within-subjects ANOVAs for each between level that I’m interested in. So, for example if I’m interested in the effect of interval in all three groups, then I just run the separate within subjects ANOVA(s) and call it a day. This can be accomplished using <code>emmeans</code>. For clarity I’m going to rename <code>ex1.aov</code> from above and call it <code>mixed.aov</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># note mixed.aov is the same as ex1.aov</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>mixed.aov <span class="ot">&lt;-</span> ex1.aov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now <code>emmeans</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">joint_tests</span>(mixed.aov, <span class="at">by=</span><span class="st">"Group"</span>, <span class="at">model=</span><span class="st">"multivariate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Group = Control:
 model term df1 df2 F.ratio p.value
 Interval     5  21   6.045  0.0013

Group = Same:
 model term df1 df2 F.ratio p.value
 Interval     5  21   9.667  0.0001

Group = Different:
 model term df1 df2 F.ratio p.value
 Interval     5  21  13.786  &lt;.0001</code></pre>
</div>
</div>
<p>All three groups yielded a significant result. Time for some post-hoc analyses. Remember the top <code>$emmeans</code> give us the estimated means themselves and the <code>$contrasts</code> give us the p-values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">emmeans</span>(mixed.aov, <span class="at">by=</span><span class="st">"Group"</span>, <span class="at">spec=</span> pairwise<span class="sc">~</span>Interval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
Group = Control:
 Interval emmean   SE df lower.CL upper.CL
 Int1      213.9 28.3 21    155.1      273
 Int2       93.2 31.4 21     28.0      158
 Int3       96.5 22.1 21     50.5      142
 Int4      128.6 24.0 21     78.8      178
 Int5      122.9 21.6 21     78.0      168
 Int6      130.1 25.6 21     77.0      183

Group = Same:
 Interval emmean   SE df lower.CL upper.CL
 Int1      354.6 28.3 21    295.9      413
 Int2      266.2 31.4 21    201.0      331
 Int3      221.0 22.1 21    175.0      267
 Int4      170.0 24.0 21    120.1      220
 Int5      198.6 21.6 21    153.8      243
 Int6      178.6 25.6 21    125.5      232

Group = Different:
 Interval emmean   SE df lower.CL upper.CL
 Int1      290.1 28.3 21    231.4      349
 Int2       98.2 31.4 21     33.0      163
 Int3      108.5 22.1 21     62.5      154
 Int4      109.0 24.0 21     59.1      159
 Int5      123.5 21.6 21     78.7      168
 Int6      138.6 25.6 21     85.5      192

Confidence level used: 0.95 

$contrasts
Group = Control:
 contrast    estimate   SE df t.ratio p.value
 Int1 - Int2   120.62 24.6 21   4.894  0.0010
 Int1 - Int3   117.38 27.0 21   4.352  0.0033
 Int1 - Int4    85.25 34.7 21   2.458  0.1820
 Int1 - Int5    91.00 27.5 21   3.304  0.0346
 Int1 - Int6    83.75 31.2 21   2.688  0.1199
 Int2 - Int3    -3.25 20.7 21  -0.157  1.0000
 Int2 - Int4   -35.38 30.7 21  -1.152  0.8538
 Int2 - Int5   -29.62 26.9 21  -1.100  0.8757
 Int2 - Int6   -36.88 27.4 21  -1.343  0.7584
 Int3 - Int4   -32.12 19.7 21  -1.627  0.5912
 Int3 - Int5   -26.38 20.3 21  -1.297  0.7832
 Int3 - Int6   -33.62 17.8 21  -1.885  0.4374
 Int4 - Int5     5.75 21.9 21   0.263  0.9998
 Int4 - Int6    -1.50 21.4 21  -0.070  1.0000
 Int5 - Int6    -7.25 29.5 21  -0.246  0.9999

Group = Same:
 contrast    estimate   SE df t.ratio p.value
 Int1 - Int2    88.38 24.6 21   3.586  0.0188
 Int1 - Int3   133.62 27.0 21   4.954  0.0008
 Int1 - Int4   184.62 34.7 21   5.322  0.0004
 Int1 - Int5   156.00 27.5 21   5.663  0.0002
 Int1 - Int6   176.00 31.2 21   5.648  0.0002
 Int2 - Int3    45.25 20.7 21   2.191  0.2829
 Int2 - Int4    96.25 30.7 21   3.135  0.0493
 Int2 - Int5    67.62 26.9 21   2.512  0.1654
 Int2 - Int6    87.62 27.4 21   3.192  0.0438
 Int3 - Int4    51.00 19.7 21   2.582  0.1457
 Int3 - Int5    22.38 20.3 21   1.101  0.8757
 Int3 - Int6    42.38 17.8 21   2.376  0.2094
 Int4 - Int5   -28.62 21.9 21  -1.310  0.7766
 Int4 - Int6    -8.62 21.4 21  -0.403  0.9984
 Int5 - Int6    20.00 29.5 21   0.678  0.9826

Group = Different:
 contrast    estimate   SE df t.ratio p.value
 Int1 - Int2   191.88 24.6 21   7.785  &lt;.0001
 Int1 - Int3   181.62 27.0 21   6.734  &lt;.0001
 Int1 - Int4   181.12 34.7 21   5.222  0.0004
 Int1 - Int5   166.62 27.5 21   6.049  0.0001
 Int1 - Int6   151.50 31.2 21   4.862  0.0010
 Int2 - Int3   -10.25 20.7 21  -0.496  0.9958
 Int2 - Int4   -10.75 30.7 21  -0.350  0.9992
 Int2 - Int5   -25.25 26.9 21  -0.938  0.9319
 Int2 - Int6   -40.38 27.4 21  -1.471  0.6853
 Int3 - Int4    -0.50 19.7 21  -0.025  1.0000
 Int3 - Int5   -15.00 20.3 21  -0.738  0.9747
 Int3 - Int6   -30.12 17.8 21  -1.689  0.5531
 Int4 - Int5   -14.50 21.9 21  -0.663  0.9841
 Int4 - Int6   -29.62 21.4 21  -1.385  0.7351
 Int5 - Int6   -15.12 29.5 21  -0.513  0.9951

P value adjustment: tukey method for comparing a family of 6 estimates </code></pre>
</div>
</div>
</section></section></section><section id="example-2" class="level2"><h2 class="anchored" data-anchor-id="example-2">Example 2:</h2>
<p>Ok, let’s ramp up our complexity here. This time we’re using data with 1 within factor and 2 between factors. For background on this data:</p>
<blockquote class="blockquote">
<p>This is a study by St.&nbsp;Lawrence, Brasﬁeld, Shirley, Jefferson, Alleyne, and O’Bannon (1995) on an intervention program to reduce the risk of HIV infection among African-American adolescents. The study involved a comparison of two approaches, one of which was a standard 2hour educational program used as a control condition (EC) and the other was an 8-week behavioral skills training program (BST). Subjects were Male and Female adolescents, and measures were taken at Pretest, Posttest, and 6 and 12 months follow-up (FU6 and FU12). There were multiple dependent variables in the study, but the one that we will consider is log(freq + 1), where freq is the frequency of condom-protected intercourse. 4 This is a 2 x 2 x 4 repeated-measures design, with Intervention and Sex as between-subjects factors and Time as the within-subjects factor.</p>
</blockquote>
<section id="data-import-and-wrangling-1" class="level3"><h3 class="anchored" data-anchor-id="data-import-and-wrangling-1">data import and wrangling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>example2 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab14-7.dat"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 40 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr (5): Person, Pretest, Posttest, FU6, FU12
dbl (2): Condition, Sex

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>example2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 7
   Person Condition   Sex Pretest Posttest FU6   FU12 
   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;
 1 01             1     1 07      22       13    14   
 2 02             1     1 25      10       17    24   
 3 03             1     1 50      36       49    23   
 4 04             1     1 16      38       34    24   
 5 05             1     1 33      25       24    25   
 6 06             1     1 10      07       23    26   
 7 07             1     1 13      33       27    24   
 8 08             1     1 22      20       21    11   
 9 09             1     1 04      00       12    00   
10 10             1     1 17      16       20    10   
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>You note that this time around, there is a subject ID, <code>Person</code> so no need to add that. From here we can gather the data (in columns 4-7) into long format with Time as the created factor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>example2_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> example2, </span>
<span id="cb58-2"><a href="#cb58-2"></a>                                     <span class="at">cols =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>, </span>
<span id="cb58-3"><a href="#cb58-3"></a>                                     <span class="at">names_to=</span><span class="st">"Time"</span>, </span>
<span id="cb58-4"><a href="#cb58-4"></a>                                     <span class="at">values_to =</span><span class="st">"Freq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and give names to our number-coded variables in <code>Condition</code> and <code>Sex</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>example2_long<span class="sc">$</span>Condition <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example2_long<span class="sc">$</span>Condition, </span>
<span id="cb59-2"><a href="#cb59-2"></a>                                         <span class="st">"1"</span><span class="ot">=</span><span class="st">"BST"</span>, </span>
<span id="cb59-3"><a href="#cb59-3"></a>                                         <span class="st">"2"</span><span class="ot">=</span><span class="st">"EC"</span>)</span>
<span id="cb59-4"><a href="#cb59-4"></a></span>
<span id="cb59-5"><a href="#cb59-5"></a>example2_long<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example2_long<span class="sc">$</span>Sex, </span>
<span id="cb59-6"><a href="#cb59-6"></a>                                   <span class="st">"1"</span><span class="ot">=</span><span class="st">"M"</span>, </span>
<span id="cb59-7"><a href="#cb59-7"></a>                                   <span class="st">"2"</span><span class="ot">=</span><span class="st">"F"</span>)</span>
<span id="cb59-8"><a href="#cb59-8"></a></span>
<span id="cb59-9"><a href="#cb59-9"></a>example2_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160 × 5
   Person Condition Sex   Time     Freq 
   &lt;chr&gt;  &lt;fct&gt;     &lt;fct&gt; &lt;chr&gt;    &lt;chr&gt;
 1 01     BST       M     Pretest  07   
 2 01     BST       M     Posttest 22   
 3 01     BST       M     FU6      13   
 4 01     BST       M     FU12     14   
 5 02     BST       M     Pretest  25   
 6 02     BST       M     Posttest 10   
 7 02     BST       M     FU6      17   
 8 02     BST       M     FU12     24   
 9 03     BST       M     Pretest  50   
10 03     BST       M     Posttest 36   
# ℹ 150 more rows</code></pre>
</div>
</div>
<p>Also, for some reason this data set wants to treat our Freq values as a character string. This was the case from the first import, but it’s much easier to wait and address it now (only a single column call). This is a strange quirk of this example dataset and may not apply in all cases:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>example2_long<span class="sc">$</span>Freq <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(example2_long<span class="sc">$</span>Freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="plotting-the-data-1" class="level3"><h3 class="anchored" data-anchor-id="plotting-the-data-1">plotting the data</h3>
<p>First we need to create the data for the appropriate error bars</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>repdata <span class="ot">&lt;-</span> <span class="fu">withinSummary</span>(<span class="at">data =</span> example2_long,</span>
<span id="cb62-2"><a href="#cb62-2"></a>                         <span class="at">measurevar =</span> <span class="st">"Freq"</span>,</span>
<span id="cb62-3"><a href="#cb62-3"></a>                         <span class="at">betweenvars =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Sex"</span>), </span>
<span id="cb62-4"><a href="#cb62-4"></a>                         <span class="at">withinvars =</span> <span class="st">"Time"</span>,</span>
<span id="cb62-5"><a href="#cb62-5"></a>                         <span class="at">idvar =</span> <span class="st">"Person"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Automatically converting the following non-factors to factors: Time</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">show</span>(repdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Actual
   Condition Sex     Time  N Freq        sd       se        ci
1        BST   M     FU12 10 18.1  8.812239 2.786675  6.303896
2        BST   M      FU6 10 24.0 10.923980 3.454466  7.814544
3        BST   M Posttest 10 20.7 12.728359 4.025060  9.105319
4        BST   M  Pretest 10 19.7 13.727912 4.341147  9.820356
5        BST   F     FU12 10 10.2 12.682446 4.010542  9.072476
6        BST   F      FU6 10 13.6  8.821690 2.789663  6.310657
7        BST   F Posttest 10  9.8  8.978988 2.839405  6.423181
8        BST   F  Pretest 10  7.2 11.193252 3.539617  8.007170
9         EC   M     FU12 10 15.1 14.231811 4.500494 10.180824
10        EC   M      FU6 10  7.5 10.480140 3.314111  7.497040
11        EC   M Posttest 10 18.8 23.757104 7.512656 16.994809
12        EC   M  Pretest 10 29.5 25.123031 7.944600 17.971933
13        EC   F     FU12 10  9.5 15.211472 4.810290 10.881632
14        EC   F      FU6 10  9.7 12.138552 3.838547  8.683397
15        EC   F Posttest 10 10.0 13.063945 4.131182  9.345383
16        EC   F  Pretest 10 10.1 13.008117 4.113528  9.305446

$Corrected
   Condition Sex     Time  N Freq FreqNormed        sd       se        ci
1        BST   F     FU12 10 10.2   14.59375  8.346656 2.639444  5.970838
2        BST   F      FU6 10 13.6   17.99375  6.493872 2.053543  4.645436
3        BST   F Posttest 10  9.8   14.19375  7.837706 2.478500  5.606757
4        BST   F  Pretest 10  7.2   11.59375  8.382080 2.650646  5.996179
5        BST   M     FU12 10 18.1   12.06875  8.148449 2.576766  5.829049
6        BST   M      FU6 10 24.0   17.96875  4.914548 1.554116  3.515656
7        BST   M Posttest 10 20.7   14.66875  8.122956 2.568704  5.810812
8        BST   M  Pretest 10 19.7   13.66875  9.046229 2.860669  6.471282
9         EC   F     FU12 10  9.5   14.26875 10.573421 3.343609  7.563769
10        EC   F      FU6 10  9.7   14.46875 11.847996 3.746665  8.475545
11        EC   F Posttest 10 10.0   14.76875  6.878644 2.175218  4.920685
12        EC   F  Pretest 10 10.1   14.86875  4.814042 1.522334  3.443758
13        EC   M     FU12 10 15.1   11.96875 13.049230 4.126529  9.334857
14        EC   M      FU6 10  7.5    4.36875 14.446869 4.568501 10.334668
15        EC   M Posttest 10 18.8   15.66875 15.586111 4.928761 11.149632
16        EC   M  Pretest 10 29.5   26.36875 14.284445 4.517138 10.218476</code></pre>
</div>
</div>
<p>Now we can plot (let’s do some APA here):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># create universal position dodge</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>dodge_all <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(.<span class="dv">3</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a></span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="co"># now plot:</span></span>
<span id="cb66-5"><a href="#cb66-5"></a></span>
<span id="cb66-6"><a href="#cb66-6"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> repdata<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time,</span>
<span id="cb66-7"><a href="#cb66-7"></a>                                                   <span class="at">y=</span>Freq,</span>
<span id="cb66-8"><a href="#cb66-8"></a>                                                   <span class="at">group=</span><span class="fu">interaction</span>(Condition,Sex))) <span class="sc">+</span> </span>
<span id="cb66-9"><a href="#cb66-9"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Condition, <span class="at">ymin=</span>Freq<span class="sc">-</span>se, <span class="at">ymax=</span>Freq<span class="sc">+</span>se), <span class="at">size=</span>.<span class="dv">5</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Sex), <span class="at">size=</span><span class="dv">1</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span> </span>
<span id="cb66-11"><a href="#cb66-11"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb66-12"><a href="#cb66-12"></a>  <span class="co"># aesthetics</span></span>
<span id="cb66-13"><a href="#cb66-13"></a>  <span class="fu">theme</span>(</span>
<span id="cb66-14"><a href="#cb66-14"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">lineheight =</span> .<span class="dv">55</span>),</span>
<span id="cb66-15"><a href="#cb66-15"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb66-16"><a href="#cb66-16"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb66-17"><a href="#cb66-17"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">20</span>,.<span class="dv">85</span>)) <span class="sc">+</span></span>
<span id="cb66-18"><a href="#cb66-18"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey50"</span>)) <span class="sc">+</span> </span>
<span id="cb66-19"><a href="#cb66-19"></a>  <span class="fu">xlab</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Time"</span>) <span class="sc">+</span> </span>
<span id="cb66-20"><a href="#cb66-20"></a>  <span class="fu">ylab</span> (<span class="st">"Freq </span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb66-21"><a href="#cb66-21"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>),<span class="st">"in"</span>)) <span class="sc">+</span> </span>
<span id="cb66-22"><a href="#cb66-22"></a>  </span>
<span id="cb66-23"><a href="#cb66-23"></a>  <span class="co"># stack legend boxes horizontally:</span></span>
<span id="cb66-24"><a href="#cb66-24"></a>  <span class="fu">theme</span>(<span class="at">legend.box =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb66-25"><a href="#cb66-25"></a></span>
<span id="cb66-26"><a href="#cb66-26"></a><span class="fu">show</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="13_1-mixed_effects_anova_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The order along the x-axis is the reverse of what I’d like. Since I’m plotting using <code>repdata</code> I need to change the order of my levels there. I can change this by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>repdata<span class="sc">$</span>Corrected<span class="sc">$</span>Time <span class="ot">&lt;-</span> repdata<span class="sc">$</span>Corrected<span class="sc">$</span>Time <span class="sc">%&gt;%</span> <span class="fu">fct_relevel</span>(<span class="fu">c</span>(<span class="st">"Pretest"</span>,<span class="st">"Posttest"</span>,<span class="st">"FU6"</span>,<span class="st">"FU12"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and now re-plot (adjusting the position of my legend accordingly):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># create universal position dodge</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>dodge_all <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(.<span class="dv">3</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a></span>
<span id="cb68-4"><a href="#cb68-4"></a><span class="co"># now plot:</span></span>
<span id="cb68-5"><a href="#cb68-5"></a></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="fu">ggplot</span>(<span class="at">data =</span> repdata<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Freq,<span class="at">group=</span><span class="fu">interaction</span>(Condition,Sex))) <span class="sc">+</span> </span>
<span id="cb68-7"><a href="#cb68-7"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Condition, <span class="at">ymin=</span>Freq<span class="sc">-</span>se, <span class="at">ymax=</span>Freq<span class="sc">+</span>se), <span class="at">size=</span>.<span class="dv">5</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Sex), <span class="at">size=</span><span class="dv">1</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span> </span>
<span id="cb68-9"><a href="#cb68-9"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10"></a>  <span class="co"># APA ify</span></span>
<span id="cb68-11"><a href="#cb68-11"></a>  <span class="fu">theme</span>(</span>
<span id="cb68-12"><a href="#cb68-12"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">lineheight =</span> .<span class="dv">55</span>),</span>
<span id="cb68-13"><a href="#cb68-13"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb68-14"><a href="#cb68-14"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb68-15"><a href="#cb68-15"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">20</span>,.<span class="dv">85</span>)) <span class="sc">+</span></span>
<span id="cb68-16"><a href="#cb68-16"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey50"</span>)) <span class="sc">+</span> </span>
<span id="cb68-17"><a href="#cb68-17"></a>  <span class="fu">xlab</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Time"</span>) <span class="sc">+</span> </span>
<span id="cb68-18"><a href="#cb68-18"></a>  <span class="fu">ylab</span> (<span class="st">"Freq </span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb68-19"><a href="#cb68-19"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>),<span class="st">"in"</span>)) <span class="sc">+</span> </span>
<span id="cb68-20"><a href="#cb68-20"></a>  </span>
<span id="cb68-21"><a href="#cb68-21"></a>  <span class="co"># stack legend boxes horizontally:</span></span>
<span id="cb68-22"><a href="#cb68-22"></a>  <span class="fu">theme</span>(<span class="at">legend.box =</span> <span class="st">"horizontal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="13_1-mixed_effects_anova_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On to our assumptions tests!!</p>
</section><section id="testing-our-assumptions" class="level3"><h3 class="anchored" data-anchor-id="testing-our-assumptions">testing our assumptions</h3>
<section id="boxm" class="level4"><h4 class="anchored" data-anchor-id="boxm"><code>boxM</code></h4>
<p>I could just use the original <code>example2</code> object, but let’s spread for practice:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># get the data in wide format:</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>example2_wide <span class="ot">&lt;-</span> example2_long <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Time"</span>, <span class="at">values_from =</span> <span class="st">"Freq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and now <code>boxM</code>. Since we have two between variables, we’ll need to run a separate test for each:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>heplots<span class="sc">::</span><span class="fu">boxM</span>(example2_wide[,<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],example2_wide<span class="sc">$</span>Condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  example2_wide[, 4:7]
Chi-Sq (approx.) = 18.136, df = 10, p-value = 0.05271</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>heplots<span class="sc">::</span><span class="fu">boxM</span>(example2_wide[,<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],example2_wide<span class="sc">$</span>Sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  example2_wide[, 4:7]
Chi-Sq (approx.) = 17.018, df = 10, p-value = 0.07396</code></pre>
</div>
</div>
<p>In both cases we are fine (<span class="math inline">\(p\)</span> &gt; .001). Moving on to the ANOVA.</p>
</section></section><section id="run-your-omnibus-anova" class="level3"><h3 class="anchored" data-anchor-id="run-your-omnibus-anova">Run your omnibus ANOVA:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>ex2.aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"Person"</span>,<span class="at">dv =</span> <span class="st">"Freq"</span>,<span class="at">data =</span> example2_long,<span class="at">between =</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"Condition"</span>), <span class="at">within =</span> <span class="st">"Time"</span>,<span class="at">type =</span> <span class="dv">3</span>,<span class="at">return =</span> <span class="st">"afex_aov"</span>,<span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"GG"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Contrasts set to contr.sum for the following variables: Sex, Condition</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">summary</span>(ex2.aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.Anova.mlm(object$Anova, multivariate = FALSE): HF eps &gt; 1
treated as 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

                   Sum Sq num Df Error SS den Df F value    Pr(&gt;F)    
(Intercept)         34076      1    17961     36 68.2998 7.784e-10 ***
Sex                  3358      1    17961     36  6.7306  0.013623 *  
Condition             107      1    17961     36  0.2150  0.645687    
Sex:Condition          64      1    17961     36  0.1278  0.722825    
Time                  274      3    11006    108  0.8965  0.445578    
Sex:Time              780      3    11006    108  2.5511  0.059435 .  
Condition:Time       1378      3    11006    108  4.5068  0.005097 ** 
Sex:Condition:Time    476      3    11006    108  1.5583  0.203741    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Mauchly Tests for Sphericity

                   Test statistic p-value
Time                      0.90261 0.61479
Sex:Time                  0.90261 0.61479
Condition:Time            0.90261 0.61479
Sex:Condition:Time        0.90261 0.61479


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

                    GG eps Pr(&gt;F[GG])   
Time               0.93169   0.439966   
Sex:Time           0.93169   0.063958 . 
Condition:Time     0.93169   0.006289 **
Sex:Condition:Time 0.93169   0.206793   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                     HF eps  Pr(&gt;F[HF])
Time               1.018095 0.445577734
Sex:Time           1.018095 0.059434934
Condition:Time     1.018095 0.005097405
Sex:Condition:Time 1.018095 0.203741026</code></pre>
</div>
</div>
<p>Our Mauchly Tests for Sphericity pass, so no need to adjust our degrees of freedom.</p>
<p>And here we see a main effect for <code>Sex</code> and a <code>Condition:Time</code> interaction. Now to follow-up…</p>
</section><section id="simple-effects-1" class="level3"><h3 class="anchored" data-anchor-id="simple-effects-1">simple effects:</h3>
<p>Similar to our first example there are two ways in which we can address that Interaction. We can look for simple (within) effects for Time on each of the between factors (Condition) that we are interested in, or we can look at simple between effects for Condition on each Time level of interest. To help guide this decision, let’s replot the data focusing on this interaction (removing <code>Sex</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>simpleData <span class="ot">&lt;-</span> <span class="fu">withinSummary</span>(<span class="at">data =</span> example2_long,</span>
<span id="cb79-2"><a href="#cb79-2"></a>                            <span class="at">measurevar =</span> <span class="st">"Freq"</span>,</span>
<span id="cb79-3"><a href="#cb79-3"></a>                            <span class="at">betweenvars =</span> <span class="st">"Condition"</span>,</span>
<span id="cb79-4"><a href="#cb79-4"></a>                            <span class="at">withinvars =</span> <span class="st">"Time"</span>,</span>
<span id="cb79-5"><a href="#cb79-5"></a>                            <span class="at">id =</span> <span class="st">"Person"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Automatically converting the following non-factors to factors: Time</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co"># releveling and factoring</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>simpleData<span class="sc">$</span>Corrected<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">factor</span>(simpleData<span class="sc">$</span>Corrected<span class="sc">$</span>Time,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pretest"</span>,<span class="st">"Posttest"</span>,<span class="st">"FU6"</span>,<span class="st">"FU12"</span>))</span>
<span id="cb81-3"><a href="#cb81-3"></a></span>
<span id="cb81-4"><a href="#cb81-4"></a><span class="fu">ggplot</span>(<span class="at">data =</span> simpleData<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Freq,<span class="at">group=</span>Condition)) <span class="sc">+</span> </span>
<span id="cb81-5"><a href="#cb81-5"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Condition, <span class="at">ymin=</span>Freq<span class="sc">-</span>se, <span class="at">ymax=</span>Freq<span class="sc">+</span>se), <span class="at">size=</span>.<span class="dv">5</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6"></a>  <span class="fu">geom_line</span>(<span class="at">position =</span> dodge_all) <span class="sc">+</span> </span>
<span id="cb81-7"><a href="#cb81-7"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8"></a>  <span class="co"># aesthetics</span></span>
<span id="cb81-9"><a href="#cb81-9"></a>  <span class="fu">theme</span>(</span>
<span id="cb81-10"><a href="#cb81-10"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">lineheight =</span> .<span class="dv">55</span>),</span>
<span id="cb81-11"><a href="#cb81-11"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb81-12"><a href="#cb81-12"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb81-13"><a href="#cb81-13"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">20</span>,.<span class="dv">85</span>)) <span class="sc">+</span></span>
<span id="cb81-14"><a href="#cb81-14"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey50"</span>)) <span class="sc">+</span> </span>
<span id="cb81-15"><a href="#cb81-15"></a>  <span class="fu">xlab</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Time"</span>) <span class="sc">+</span> </span>
<span id="cb81-16"><a href="#cb81-16"></a>  <span class="fu">ylab</span> (<span class="st">"Freq </span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb81-17"><a href="#cb81-17"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>),<span class="st">"in"</span>)) <span class="sc">+</span> </span>
<span id="cb81-18"><a href="#cb81-18"></a>  </span>
<span id="cb81-19"><a href="#cb81-19"></a>  <span class="co"># stack legend boxes horizontally:</span></span>
<span id="cb81-20"><a href="#cb81-20"></a>  <span class="fu">theme</span>(<span class="at">legend.box =</span> <span class="st">"horizontal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="13_1-mixed_effects_anova_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="by-condition-within-nested-in-between" class="level4"><h4 class="anchored" data-anchor-id="by-condition-within-nested-in-between">by condition (within nested in between):</h4>
<p>Here we’re running a simple effects within ANOVA for Time on each level of Condition. <strong>Importantly, as <code>Time</code> is also nested within <code>Sex</code>, we need to also include Sex in our simple effects follow-ups</strong>. <code>emmeans</code> handles this for us:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>emmeans<span class="sc">::</span><span class="fu">joint_tests</span>(ex2.aov, <span class="at">by =</span> <span class="st">"Condition"</span>, <span class="at">model =</span> <span class="st">"multivariate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Condition = BST:
 model term df1 df2 F.ratio p.value
 Sex          1  36   4.357  0.0440
 Time         3  36   1.177  0.3322
 Sex:Time     3  36   0.173  0.9140

Condition = EC:
 model term df1 df2 F.ratio p.value
 Sex          1  36   2.502  0.1225
 Time         3  36   3.955  0.0155
 Sex:Time     3  36   3.677  0.0208</code></pre>
</div>
</div>
<p>Our analysis of the <code>BST</code> group uncovers a simple main effect for <code>Sex</code>; this is in agreement with the result of our omnibus ANOVA. Simply, for the <code>BST</code> group, <code>Sex</code> matters.</p>
<p>Our result for the <code>EC</code> group yields a Sex × Time interaction. Again, we needed to include <code>Sex</code> in this simple effects ANOVA as <code>Time</code> was nested underneath it. That is, we cannot take into account our <code>Time</code> effects without understanding that they are confounded with <code>Sex</code>. This actually ends up being important here as the interaction tells us that in the <code>EC</code> group, <code>Time</code> matters more for one <code>Sex</code> than it does another. You could then tease apart this interaction as you would typically do in a repeated measures ANOVA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>emmeans<span class="sc">::</span><span class="fu">joint_tests</span>(ex2.aov,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"Condition"</span>), <span class="at">model =</span> <span class="st">"multivariate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sex = M, Condition = BST:
 model term df1 df2 F.ratio p.value
 Time         3  36   0.704  0.5561

Sex = F, Condition = BST:
 model term df1 df2 F.ratio p.value
 Time         3  36   0.646  0.5906

Sex = M, Condition = EC:
 model term df1 df2 F.ratio p.value
 Time         3  36   7.627  0.0005

Sex = F, Condition = EC:
 model term df1 df2 F.ratio p.value
 Time         3  36   0.006  0.9994</code></pre>
</div>
</div>
<p>Here we only pay attention to instances where <code>Condition = EC</code>. We see that we have a significance effect for <code>Time</code> for men, but not for women. Now following that up:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">emmeans</span>(ex2.aov, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sex"</span>,<span class="st">"Condition"</span>), pairwise<span class="sc">~</span>Time, <span class="at">adjust=</span><span class="st">"tukey"</span>, <span class="at">model =</span> <span class="st">"multivariate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
Sex = M, Condition = BST:
 Time     emmean   SE df lower.CL upper.CL
 Pretest    19.7 5.28 36   8.9965     30.4
 Posttest   20.7 4.94 36  10.6732     30.7
 FU6        24.0 3.37 36  17.1649     30.8
 FU12       18.1 4.10 36   9.7846     26.4

Sex = F, Condition = BST:
 Time     emmean   SE df lower.CL upper.CL
 Pretest     7.2 5.28 36  -3.5035     17.9
 Posttest    9.8 4.94 36  -0.2268     19.8
 FU6        13.6 3.37 36   6.7649     20.4
 FU12       10.2 4.10 36   1.8846     18.5

Sex = M, Condition = EC:
 Time     emmean   SE df lower.CL upper.CL
 Pretest    29.5 5.28 36  18.7965     40.2
 Posttest   18.8 4.94 36   8.7732     28.8
 FU6         7.5 3.37 36   0.6649     14.3
 FU12       15.1 4.10 36   6.7846     23.4

Sex = F, Condition = EC:
 Time     emmean   SE df lower.CL upper.CL
 Pretest    10.1 5.28 36  -0.6035     20.8
 Posttest   10.0 4.94 36  -0.0268     20.0
 FU6         9.7 3.37 36   2.8649     16.5
 FU12        9.5 4.10 36   1.1846     17.8

Confidence level used: 0.95 

$contrasts
Sex = M, Condition = BST:
 contrast           estimate   SE df t.ratio p.value
 Pretest - Posttest     -1.0 3.99 36  -0.251  0.9944
 Pretest - FU6          -4.3 4.68 36  -0.919  0.7948
 Pretest - FU12          1.6 4.61 36   0.347  0.9854
 Posttest - FU6         -3.3 4.75 36  -0.694  0.8986
 Posttest - FU12         2.6 4.84 36   0.537  0.9494
 FU6 - FU12              5.9 4.15 36   1.420  0.4952

Sex = F, Condition = BST:
 contrast           estimate   SE df t.ratio p.value
 Pretest - Posttest     -2.6 3.99 36  -0.652  0.9140
 Pretest - FU6          -6.4 4.68 36  -1.368  0.5270
 Pretest - FU12         -3.0 4.61 36  -0.651  0.9146
 Posttest - FU6         -3.8 4.75 36  -0.800  0.8542
 Posttest - FU12        -0.4 4.84 36  -0.083  0.9998
 FU6 - FU12              3.4 4.15 36   0.819  0.8453

Sex = M, Condition = EC:
 contrast           estimate   SE df t.ratio p.value
 Pretest - Posttest     10.7 3.99 36   2.685  0.0510
 Pretest - FU6          22.0 4.68 36   4.703  0.0002
 Pretest - FU12         14.4 4.61 36   3.124  0.0177
 Posttest - FU6         11.3 4.75 36   2.378  0.0998
 Posttest - FU12         3.7 4.84 36   0.764  0.8698
 FU6 - FU12             -7.6 4.15 36  -1.830  0.2764

Sex = F, Condition = EC:
 contrast           estimate   SE df t.ratio p.value
 Pretest - Posttest      0.1 3.99 36   0.025  1.0000
 Pretest - FU6           0.4 4.68 36   0.086  0.9998
 Pretest - FU12          0.6 4.61 36   0.130  0.9992
 Posttest - FU6          0.3 4.75 36   0.063  0.9999
 Posttest - FU12         0.5 4.84 36   0.103  0.9996
 FU6 - FU12              0.2 4.15 36   0.048  1.0000

P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
</div>
<p>A ton of output here, but we are only concerned with <code>Sex = M, Condition = EC</code>.</p>
</section><section id="by-time-between-nested-in-within" class="level4"><h4 class="anchored" data-anchor-id="by-time-between-nested-in-within">by Time (between nested in within):</h4>
<p>Now to look at the alternative, our <code>Condition</code> effects on each level of <code>Time</code>. We can either run this using <code>joint_tests()</code> or because <code>Condition</code> only has two levels we can do multiple pairwise comparisons using <code>emmeans()</code>.</p>
<p>Here’s the <code>joint_tests</code> output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="fu">joint_tests</span>(ex2.aov, <span class="at">by =</span> <span class="st">"Time"</span>, <span class="at">model=</span><span class="st">"multivariate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time = Pretest:
 model term    df1 df2 F.ratio p.value
 Sex             1  36   9.134  0.0046
 Condition       1  36   1.448  0.2368
 Sex:Condition   1  36   0.427  0.5175

Time = Posttest:
 model term    df1 df2 F.ratio p.value
 Sex             1  36   3.969  0.0540
 Condition       1  36   0.030  0.8645
 Sex:Condition   1  36   0.045  0.8330

Time = FU6:
 model term    df1 df2 F.ratio p.value
 Sex             1  36   1.480  0.2317
 Condition       1  36   9.160  0.0045
 Sex:Condition   1  36   3.494  0.0697

Time = FU12:
 model term    df1 df2 F.ratio p.value
 Sex             1  36   2.710  0.1084
 Condition       1  36   0.204  0.6545
 Sex:Condition   1  36   0.079  0.7807</code></pre>
</div>
</div>
<p>Here’s the <code>emmeans</code> output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="fu">emmeans</span>(ex2.aov, <span class="at">by =</span> <span class="st">"Time"</span>, <span class="at">specs =</span> pairwise<span class="sc">~</span>Condition, <span class="at">model=</span><span class="st">"multivariate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
Time = Pretest:
 Condition emmean   SE df lower.CL upper.CL
 BST         13.4 3.73 36     5.88     21.0
 EC          19.8 3.73 36    12.23     27.4

Time = Posttest:
 Condition emmean   SE df lower.CL upper.CL
 BST         15.2 3.50 36     8.16     22.3
 EC          14.4 3.50 36     7.31     21.5

Time = FU6:
 Condition emmean   SE df lower.CL upper.CL
 BST         18.8 2.38 36    13.97     23.6
 EC           8.6 2.38 36     3.77     13.4

Time = FU12:
 Condition emmean   SE df lower.CL upper.CL
 BST         14.2 2.90 36     8.27     20.0
 EC          12.3 2.90 36     6.42     18.2

Results are averaged over the levels of: Sex 
Confidence level used: 0.95 

$contrasts
Time = Pretest:
 contrast estimate   SE df t.ratio p.value
 BST - EC    -6.35 5.28 36  -1.203  0.2368

Time = Posttest:
 contrast estimate   SE df t.ratio p.value
 BST - EC     0.85 4.94 36   0.172  0.8645

Time = FU6:
 contrast estimate   SE df t.ratio p.value
 BST - EC    10.20 3.37 36   3.027  0.0045

Time = FU12:
 contrast estimate   SE df t.ratio p.value
 BST - EC     1.85 4.10 36   0.451  0.6545

Results are averaged over the levels of: Sex </code></pre>
</div>
</div>
<p>The results revealed a significant effect for <code>Sex</code> on the <code>Pretest</code> Time condition. More importantly in terms of our interaction, they revealed a significant effect for <code>Condition</code> only on the <code>FU6</code> Time condition.</p>
</section></section></section><section id="to-pool-or-not-to-pool-this-is-the-yada-yada-yada" class="level2"><h2 class="anchored" data-anchor-id="to-pool-or-not-to-pool-this-is-the-yada-yada-yada">to pool or not to pool, this is the yada yada yada</h2>
<p>At this point you may have a few questions regarding simple effects ANOVA. In particular, the question of when and whether to pool your variances (i.e., use the error from the omnibus ANOVA) or not. If you want the short answer on my recommendation, here you go:</p>
<p><strong>Only pool variances (<code>model="univariate"</code>) if you are running a Between Subjects ANOVA, assuming homogeneity of variances has not been violated. That’s it. Any other designs use the error terms associated with the specific tests that you are running (<code>model="multivariate"</code>). This is the least risky way of performing your follow-up analysis. I realize we lose power this way, but sorry, that sucks… its a consequence of the design you choose. My feeling, better to be more conservative. That said, for what its worth, you already GAINED a bit of power by choosing a within-subjects design in the first place!</strong></p>
<p>Why this recommendation? In any design that has a within-subject factor we are almost guaranteed to see some deviations in compound symmetry (and sphericity). In fact, the entire point of the analysis is to account for this. Put another way, the within-subjects ANOVA relaxes the homogeneity assumption, AND implicitly concedes that when conducting your within-subject simple effects follow-ups that you are not granted that variances are similar from one level to the next. So, in within-subjects designs the recommendation is to NOT pool your variances, see <a href="https://link.springer.com/article/10.1007/BF02293733">Boik (1981)</a>.</p>
<p>This goes for post-hocs as well.</p>
<p>One of these days I’ll get around to developing simulations to help elucidate why this is an issue. But for now… keep it <code>multivariate</code>.</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb92" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb92-1"><a href="#cb92-1"></a><span class="co">---</span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="an">title:</span><span class="co"> "Mixed-effects ANOVA (BS + WS)"</span></span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="co">---</span></span>
<span id="cb92-4"><a href="#cb92-4"></a></span>
<span id="cb92-5"><a href="#cb92-5"></a>For our final trick with ANOVA, we will be covering mixed effects designs. Mixed models sometimes go by many names (mixed effects model, multi-level model, growth-curve models) depending on the structure of the data that is being analyzed. For this week we will be focusing on Mixed effects ANOVA.</span>
<span id="cb92-6"><a href="#cb92-6"></a></span>
<span id="cb92-7"><a href="#cb92-7"></a>This walk-though assumes the following packages:</span>
<span id="cb92-8"><a href="#cb92-8"></a></span>
<span id="cb92-11"><a href="#cb92-11"></a><span class="in">```{r}</span></span>
<span id="cb92-12"><a href="#cb92-12"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, <span class="co">#tidy goodness</span></span>
<span id="cb92-13"><a href="#cb92-13"></a>               cowplot, <span class="co"># easy clean plots</span></span>
<span id="cb92-14"><a href="#cb92-14"></a>               afex, <span class="co"># ANOVA</span></span>
<span id="cb92-15"><a href="#cb92-15"></a>               Rmisc, <span class="co"># summary tables</span></span>
<span id="cb92-16"><a href="#cb92-16"></a>               emmeans, <span class="co"># contrasts</span></span>
<span id="cb92-17"><a href="#cb92-17"></a>               heplots) <span class="co"># homogeneity of covariance</span></span>
<span id="cb92-18"><a href="#cb92-18"></a><span class="in">```</span></span>
<span id="cb92-19"><a href="#cb92-19"></a></span>
<span id="cb92-20"><a href="#cb92-20"></a><span class="fu">## TL;DR</span></span>
<span id="cb92-21"><a href="#cb92-21"></a></span>
<span id="cb92-22"><a href="#cb92-22"></a><span class="ss">-   </span>Mixed ANOVA involve both between-subjects factors and within-subjects factors</span>
<span id="cb92-23"><a href="#cb92-23"></a><span class="ss">-   </span>Mixed ANOVA designs are more likely to give rise to sphericity violations</span>
<span id="cb92-24"><a href="#cb92-24"></a><span class="ss">-   </span>In addition to testing for sphericity, we also need to test for homogeneity of covariance matrices (and subsequently homogeneity of variance)</span>
<span id="cb92-25"><a href="#cb92-25"></a><span class="ss">-   </span>when considering simple effects and post-hoc tests, keep it <span class="in">`multivariate`</span>.</span>
<span id="cb92-26"><a href="#cb92-26"></a></span>
<span id="cb92-27"><a href="#cb92-27"></a>**Example:**</span>
<span id="cb92-28"><a href="#cb92-28"></a></span>
<span id="cb92-29"><a href="#cb92-29"></a><span class="ss">1.  </span>loading in data</span>
<span id="cb92-30"><a href="#cb92-30"></a></span>
<span id="cb92-33"><a href="#cb92-33"></a><span class="in">```{r}</span></span>
<span id="cb92-34"><a href="#cb92-34"></a>example <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab14-4.dat"</span>, </span>
<span id="cb92-35"><a href="#cb92-35"></a>                      <span class="at">delim=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb92-36"><a href="#cb92-36"></a><span class="in">```</span></span>
<span id="cb92-37"><a href="#cb92-37"></a></span>
<span id="cb92-38"><a href="#cb92-38"></a><span class="ss">2.  </span>data wrangling:</span>
<span id="cb92-39"><a href="#cb92-39"></a></span>
<span id="cb92-42"><a href="#cb92-42"></a><span class="in">```{r}</span></span>
<span id="cb92-43"><a href="#cb92-43"></a><span class="co"># create subject column</span></span>
<span id="cb92-44"><a href="#cb92-44"></a>example <span class="ot">&lt;-</span>  example <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">"SubjectID"</span> <span class="ot">=</span> <span class="fu">seq_along</span>(example<span class="sc">$</span>Group)) </span>
<span id="cb92-45"><a href="#cb92-45"></a><span class="co"># data in long format</span></span>
<span id="cb92-46"><a href="#cb92-46"></a>example_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> example, </span>
<span id="cb92-47"><a href="#cb92-47"></a>                                    <span class="at">names_to =</span> <span class="st">"Interval"</span>, </span>
<span id="cb92-48"><a href="#cb92-48"></a>                                    <span class="at">values_to =</span> <span class="st">"Activity"</span>,</span>
<span id="cb92-49"><a href="#cb92-49"></a>                                    <span class="at">col =</span> <span class="fu">contains</span>(<span class="st">"Int"</span>))</span>
<span id="cb92-50"><a href="#cb92-50"></a></span>
<span id="cb92-51"><a href="#cb92-51"></a><span class="co"># convert 'Interval' to factor:</span></span>
<span id="cb92-52"><a href="#cb92-52"></a>example_long<span class="sc">$</span>Interval <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(example_long<span class="sc">$</span>Interval)</span>
<span id="cb92-53"><a href="#cb92-53"></a></span>
<span id="cb92-54"><a href="#cb92-54"></a><span class="co"># Name the dummy variables for 'Group' &amp; convert to factor:</span></span>
<span id="cb92-55"><a href="#cb92-55"></a>example_long<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example_long<span class="sc">$</span>Group,</span>
<span id="cb92-56"><a href="#cb92-56"></a>                                    <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Control"</span>,</span>
<span id="cb92-57"><a href="#cb92-57"></a>                                    <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Same"</span>,</span>
<span id="cb92-58"><a href="#cb92-58"></a>                                    <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Different"</span>)</span>
<span id="cb92-59"><a href="#cb92-59"></a><span class="in">```</span></span>
<span id="cb92-60"><a href="#cb92-60"></a></span>
<span id="cb92-61"><a href="#cb92-61"></a>Bypassing normality test and plotting...</span>
<span id="cb92-62"><a href="#cb92-62"></a></span>
<span id="cb92-63"><a href="#cb92-63"></a><span class="ss">3.  </span>Box's M test for homogeneity of covariance matrices</span>
<span id="cb92-64"><a href="#cb92-64"></a></span>
<span id="cb92-67"><a href="#cb92-67"></a><span class="in">```{r}</span></span>
<span id="cb92-68"><a href="#cb92-68"></a><span class="co"># Within Subjects dependent variables need to be in wide format</span></span>
<span id="cb92-69"><a href="#cb92-69"></a>example_wide <span class="ot">&lt;-</span> example_long <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Interval"</span>, </span>
<span id="cb92-70"><a href="#cb92-70"></a>                                                    <span class="at">values_from =</span> <span class="st">"Activity"</span>)</span>
<span id="cb92-71"><a href="#cb92-71"></a></span>
<span id="cb92-72"><a href="#cb92-72"></a><span class="co"># box's M</span></span>
<span id="cb92-73"><a href="#cb92-73"></a><span class="co"># boxM(withinSubjects columns, betweenSubjects column)</span></span>
<span id="cb92-74"><a href="#cb92-74"></a>heplots<span class="sc">::</span><span class="fu">boxM</span>(example_wide[,<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>], example_wide<span class="sc">$</span>Group)</span>
<span id="cb92-75"><a href="#cb92-75"></a><span class="in">```</span></span>
<span id="cb92-76"><a href="#cb92-76"></a></span>
<span id="cb92-77"><a href="#cb92-77"></a><span class="ss">4.  </span>Run the Anova</span>
<span id="cb92-78"><a href="#cb92-78"></a></span>
<span id="cb92-81"><a href="#cb92-81"></a><span class="in">```{r}</span></span>
<span id="cb92-82"><a href="#cb92-82"></a>example_anova <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"SubjectID"</span>,</span>
<span id="cb92-83"><a href="#cb92-83"></a>                              <span class="at">dv =</span> <span class="st">"Activity"</span>,</span>
<span id="cb92-84"><a href="#cb92-84"></a>                              <span class="at">data =</span> example_long,</span>
<span id="cb92-85"><a href="#cb92-85"></a>                              <span class="at">between =</span> <span class="st">"Group"</span>,</span>
<span id="cb92-86"><a href="#cb92-86"></a>                              <span class="at">within =</span> <span class="st">"Interval"</span>,</span>
<span id="cb92-87"><a href="#cb92-87"></a>                              <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb92-88"><a href="#cb92-88"></a>                              <span class="at">return =</span> <span class="st">"afex_aov"</span>,</span>
<span id="cb92-89"><a href="#cb92-89"></a>                              <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"GG"</span>))</span>
<span id="cb92-90"><a href="#cb92-90"></a></span>
<span id="cb92-91"><a href="#cb92-91"></a>example_anova</span>
<span id="cb92-92"><a href="#cb92-92"></a><span class="in">```</span></span>
<span id="cb92-93"><a href="#cb92-93"></a></span>
<span id="cb92-94"><a href="#cb92-94"></a><span class="ss">5.  </span>Test simple effects and post-hocs using <span class="in">`model=multivariate`</span></span>
<span id="cb92-95"><a href="#cb92-95"></a></span>
<span id="cb92-98"><a href="#cb92-98"></a><span class="in">```{r}</span></span>
<span id="cb92-99"><a href="#cb92-99"></a><span class="fu">joint_tests</span>(example_anova, <span class="at">by=</span><span class="st">"Group"</span>, <span class="at">model=</span><span class="st">"multivariate"</span>)</span>
<span id="cb92-100"><a href="#cb92-100"></a><span class="in">```</span></span>
<span id="cb92-101"><a href="#cb92-101"></a></span>
<span id="cb92-102"><a href="#cb92-102"></a>Simple effects tests revealed significant effects for all three groups. Time for the post-hoc follow-ups:</span>
<span id="cb92-103"><a href="#cb92-103"></a></span>
<span id="cb92-106"><a href="#cb92-106"></a><span class="in">```{r}</span></span>
<span id="cb92-107"><a href="#cb92-107"></a><span class="fu">emmeans</span>(example_anova, <span class="at">by=</span><span class="st">"Group"</span>, <span class="at">spec =</span> pairwise<span class="sc">~</span>Interval, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb92-108"><a href="#cb92-108"></a><span class="in">```</span></span>
<span id="cb92-109"><a href="#cb92-109"></a></span>
<span id="cb92-110"><a href="#cb92-110"></a><span class="fu">## Example 1:</span></span>
<span id="cb92-111"><a href="#cb92-111"></a></span>
<span id="cb92-112"><a href="#cb92-112"></a>In terms of new concepts, we are continuing our theme of "well, nothing terribly new being raised this week". You've done between-subjects (BS) ANOVA, you've done within-subjects (WS) ANOVA, you've done simple linear regression... now we are simply combining what you know.</span>
<span id="cb92-113"><a href="#cb92-113"></a></span>
<span id="cb92-114"><a href="#cb92-114"></a><span class="fu">### data import and wrangling</span></span>
<span id="cb92-115"><a href="#cb92-115"></a></span>
<span id="cb92-116"><a href="#cb92-116"></a>First we import the data. Here's a little background:</span>
<span id="cb92-117"><a href="#cb92-117"></a></span>
<span id="cb92-118"><a href="#cb92-118"></a><span class="at">&gt; King (1986) investigated motor activity in rats following injection of the drug midazolam. The ﬁrst time that this drug is injected, it typically leads to a distinct decrease in motor activity. Like morphine, however, a tolerance for midazolam develops rapidly. King wished to know whether that acquired tolerance could be explained on the basis of a conditioned tolerance related to the physical context in which the drug was administered, as in Siegel's work. He used three groups, collecting the crucial data (presented in the table below) on only the last day, which was the test day. During pretesting, two groups of animals were repeatedly injected with midazolam over several days, whereas the Control group was injected with physiological saline. On the test day, one group---the "Same" group---was injected with midazolam in the same environment in which it had earlier been injected. The "Different" group was also injected with midazolam, but in a different environment. Finally, the Control group was injected with midazolam for the ﬁrst time. This Control group should thus show the typical initial response to the drug (decreased ambulatory behavior), whereas the Same group should show the normal tolerance effect---that is, they should decrease their activity little or not at all in response to the drug on the last trial. If King is correct, however, the Different group should respond similarly to the Control group, because although they have had several exposures to the drug, they are receiving it in a novel context and any conditioned tolerance that might have developed will not have the necessary cues required for its elicitation. The dependent variable in Table 14.4 is a measure of ambulatory behavior, in arbitrary units. Again, the ﬁrst letter of the name of a variable is used as a subscript to indicate what set of means we are referring to. Because the drug is known to be metabolized over a period of approximately 1 hour, King recorded his data in 5-minute blocks, or Intervals. We would expect to see the effect of the drug increase for the ﬁrst few intervals and then slowly taper off. Our analysis uses the ﬁrst six blocks of data.</span></span>
<span id="cb92-119"><a href="#cb92-119"></a></span>
<span id="cb92-122"><a href="#cb92-122"></a><span class="in">```{r}</span></span>
<span id="cb92-123"><a href="#cb92-123"></a>example1 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab14-4.dat"</span>, </span>
<span id="cb92-124"><a href="#cb92-124"></a>                       <span class="at">delim=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb92-125"><a href="#cb92-125"></a></span>
<span id="cb92-126"><a href="#cb92-126"></a>example1</span>
<span id="cb92-127"><a href="#cb92-127"></a><span class="in">```</span></span>
<span id="cb92-128"><a href="#cb92-128"></a></span>
<span id="cb92-129"><a href="#cb92-129"></a>The data above is in wide format. I need to get it into long format before submitting it for further analysis. Before doing so, however, I also need to add a <span class="in">`SubjectID`</span> to let <span class="in">`R`</span> know which data belongs to which subject. If you are presented with repeated measures or within subjects data with no subject column, it's easiest to create your <span class="in">`SubjectID`</span> column BEFORE you <span class="in">`pivot_longer()`</span> (conversely if you only have between subjects data then I would add your <span class="in">`SubjectID`</span> after gathering:</span>
<span id="cb92-130"><a href="#cb92-130"></a></span>
<span id="cb92-133"><a href="#cb92-133"></a><span class="in">```{r}</span></span>
<span id="cb92-134"><a href="#cb92-134"></a><span class="co"># create subject column</span></span>
<span id="cb92-135"><a href="#cb92-135"></a><span class="co"># seq_along on Group ensures that every between participant gets a unique ID</span></span>
<span id="cb92-136"><a href="#cb92-136"></a>example1 <span class="ot">&lt;-</span>  example1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">"SubjectID"</span> <span class="ot">=</span> <span class="fu">seq_along</span>(example1<span class="sc">$</span>Group)) </span>
<span id="cb92-137"><a href="#cb92-137"></a></span>
<span id="cb92-138"><a href="#cb92-138"></a><span class="co"># data is in wide format, needs to be long format for R,</span></span>
<span id="cb92-139"><a href="#cb92-139"></a><span class="co"># notice that I only need to collapse the "Interval" columns (2 through 7):</span></span>
<span id="cb92-140"><a href="#cb92-140"></a></span>
<span id="cb92-141"><a href="#cb92-141"></a>example1_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> example1,</span>
<span id="cb92-142"><a href="#cb92-142"></a>                                     <span class="co"># get columns that contain "Int":</span></span>
<span id="cb92-143"><a href="#cb92-143"></a>                                     <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"Int"</span>), </span>
<span id="cb92-144"><a href="#cb92-144"></a>                                     <span class="at">names_to =</span> <span class="st">"Interval"</span>, </span>
<span id="cb92-145"><a href="#cb92-145"></a>                                     <span class="at">values_to =</span> <span class="st">"Activity"</span>)</span>
<span id="cb92-146"><a href="#cb92-146"></a></span>
<span id="cb92-147"><a href="#cb92-147"></a><span class="co"># convert 'Interval' to factor:</span></span>
<span id="cb92-148"><a href="#cb92-148"></a>example1_long<span class="sc">$</span>Interval <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(example1_long<span class="sc">$</span>Interval)</span>
<span id="cb92-149"><a href="#cb92-149"></a></span>
<span id="cb92-150"><a href="#cb92-150"></a><span class="co"># Name the dummy variables for 'Group' &amp; convert to factor:</span></span>
<span id="cb92-151"><a href="#cb92-151"></a>example1_long<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example1_long<span class="sc">$</span>Group,</span>
<span id="cb92-152"><a href="#cb92-152"></a>                                     <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Control"</span>,</span>
<span id="cb92-153"><a href="#cb92-153"></a>                                     <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Same"</span>,</span>
<span id="cb92-154"><a href="#cb92-154"></a>                                     <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Different"</span>)</span>
<span id="cb92-155"><a href="#cb92-155"></a></span>
<span id="cb92-156"><a href="#cb92-156"></a>example1_long</span>
<span id="cb92-157"><a href="#cb92-157"></a><span class="in">```</span></span>
<span id="cb92-158"><a href="#cb92-158"></a></span>
<span id="cb92-159"><a href="#cb92-159"></a><span class="fu">### testing the homogeneity of covariances</span></span>
<span id="cb92-160"><a href="#cb92-160"></a></span>
<span id="cb92-161"><a href="#cb92-161"></a>Our assumptions tests have been pretty standard every week: tests for normality, tests for homogeneity of variance. Last week, with WS-ANOVA we introduced a new wrinkle, instead of explicitly testing for homogeneity of variance (as with BS-ANOVA), for WS-ANOVA we instead test for sphericity, which we described as "homogeneity of the sums of variances-covariances". In last week's lecture I walked thru an example of sphericity noting the properties of the variance / covariance matrix and in particular how to assess sphericity.</span>
<span id="cb92-162"><a href="#cb92-162"></a></span>
<span id="cb92-163"><a href="#cb92-163"></a>The sphericity assumption is tested for each WS-ANOVA independent variable with more than 2-levels. So if you have a 3 (e.g., Condition) × 3 (e.g., Time) Within Subject ANOVA, you will have two sphericity tests, one for independent variable "Condition" and another for "Time". For the sake of example, for now lets just assume that you have the one WS-ANOVA independent variable, "Time". The covariance matrix for Time would take the general form:</span>
<span id="cb92-164"><a href="#cb92-164"></a></span>
<span id="cb92-165"><a href="#cb92-165"></a>$$</span>
<span id="cb92-166"><a href="#cb92-166"></a>\left[\begin{array}{cc} </span>
<span id="cb92-167"><a href="#cb92-167"></a>Var_1 &amp; Cov_{12} &amp; Cov_{13}<span class="sc">\\</span></span>
<span id="cb92-168"><a href="#cb92-168"></a>Cov_{12} &amp; Var_2 &amp; Cov_{23}<span class="sc">\\</span></span>
<span id="cb92-169"><a href="#cb92-169"></a>Cov_{13} &amp; Cov_{23} &amp; Var_3<span class="sc">\\</span></span>
<span id="cb92-170"><a href="#cb92-170"></a>\end{array}\right]</span>
<span id="cb92-171"><a href="#cb92-171"></a>$$</span>
<span id="cb92-172"><a href="#cb92-172"></a></span>
<span id="cb92-173"><a href="#cb92-173"></a>Now let's consider if we have Time crossed with a between factor, "Group" with two levels. Typically for between factors we need to assess homogeneity of variance, and to a degree that remains true here. But at the same time (ha) each independent Group is confounded by "Time". Or to think about it the reverse, the effect "Time" is nested in two independent Groups of people, and as such may play out differently within each group. As a result we need to assess the sphericity of "Time" within each of our two independent groups.</span>
<span id="cb92-174"><a href="#cb92-174"></a></span>
<span id="cb92-175"><a href="#cb92-175"></a>$$</span>
<span id="cb92-176"><a href="#cb92-176"></a>Group A\left[\begin{array}{cc} </span>
<span id="cb92-177"><a href="#cb92-177"></a>Var_1 &amp; Cov_{12} &amp; Cov_{13}<span class="sc">\\</span></span>
<span id="cb92-178"><a href="#cb92-178"></a>Cov_{12} &amp; Var_2 &amp; Cov_{23}<span class="sc">\\</span></span>
<span id="cb92-179"><a href="#cb92-179"></a>Cov_{13} &amp; Cov_{23} &amp; Var_3<span class="sc">\\</span></span>
<span id="cb92-180"><a href="#cb92-180"></a>\end{array}\right]</span>
<span id="cb92-181"><a href="#cb92-181"></a>=</span>
<span id="cb92-182"><a href="#cb92-182"></a>GroupB\left[\begin{array}{cc} </span>
<span id="cb92-183"><a href="#cb92-183"></a>Var_1 &amp; Cov_{12} &amp; Cov_{13}<span class="sc">\\</span></span>
<span id="cb92-184"><a href="#cb92-184"></a>Cov_{12} &amp; Var_2 &amp; Cov_{23}<span class="sc">\\</span></span>
<span id="cb92-185"><a href="#cb92-185"></a>Cov_{13} &amp; Cov_{23} &amp; Var_3<span class="sc">\\</span></span>
<span id="cb92-186"><a href="#cb92-186"></a>\end{array}\right]</span>
<span id="cb92-187"><a href="#cb92-187"></a>$$</span>
<span id="cb92-188"><a href="#cb92-188"></a></span>
<span id="cb92-189"><a href="#cb92-189"></a>To address both of these considerations, we need to run a series of tests. Neither of these tests alone is a silver bullet, but taken together they should offer a window into whether we have any serious problems with our data.</span>
<span id="cb92-190"><a href="#cb92-190"></a></span>
<span id="cb92-191"><a href="#cb92-191"></a><span class="fu">#### Test 1: Box's `M`</span></span>
<span id="cb92-192"><a href="#cb92-192"></a></span>
<span id="cb92-193"><a href="#cb92-193"></a>In his 1953 paper, *Non-Normality And Tests On Variances* George Box makes the declaration:</span>
<span id="cb92-194"><a href="#cb92-194"></a></span>
<span id="cb92-195"><a href="#cb92-195"></a><span class="at">&gt; To make the preliminary test on variances is rather like putting to sea in a rowing boat to find out whether conditions are sufficiently calm for an ocean liner to leave port!</span></span>
<span id="cb92-196"><a href="#cb92-196"></a></span>
<span id="cb92-197"><a href="#cb92-197"></a>This reinforces our in class discussions about the robustness of ANOVA. Nonetheless, we should still test to get an impression of how far we are deviating from our assumptions. Here, we are testing for homogeneity of covariance matrices. To do so we will use Box's (1949) <span class="co">[</span><span class="ot">M test</span><span class="co">](https://en.wikiversity.org/wiki/Box%27s_M)</span> (be sure to check the class website for a link to the original article). In short, the test compares the product of the log determinants of the separate covariance matrices to the log determinant of the pooled covariance matrix, analogous to a likelihood ratio test. See <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.mathsisfun.com/algebra/matrix-determinant.html)</span> for how determinants are calculated. The test statistic uses a chi-square approximation. This test can be found in the <span class="in">`heplots`</span> package.</span>
<span id="cb92-198"><a href="#cb92-198"></a></span>
<span id="cb92-199"><a href="#cb92-199"></a><span class="fu">##### Running the `boxM`: getting the data in WIDE format?!?!?</span></span>
<span id="cb92-200"><a href="#cb92-200"></a></span>
<span id="cb92-201"><a href="#cb92-201"></a>Well, this is awkward. In order to test this assumption the data needs structured with the within variable in wide format... which is exactly the way that it was when we originally downloaded it. In order to go from long format to wide format we can use the <span class="in">`pivot_wider()`</span> function (or in this case we could just use our original data frame).</span>
<span id="cb92-202"><a href="#cb92-202"></a></span>
<span id="cb92-203"><a href="#cb92-203"></a>In this case we want our dependent variable <span class="in">`Activity`</span> to be spread across differing columns of <span class="in">`Interval`</span>. The generic form of the <span class="in">`pivot_wider()`</span> function is <span class="in">`pivot_wider(names_from = "column that has IV names", values_from = "column that contains DV")`</span>. Based on our needs then:</span>
<span id="cb92-204"><a href="#cb92-204"></a></span>
<span id="cb92-207"><a href="#cb92-207"></a><span class="in">```{r}</span></span>
<span id="cb92-208"><a href="#cb92-208"></a>example1_wide <span class="ot">&lt;-</span> example1_long <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Interval"</span>, <span class="at">values_from =</span> <span class="st">"Activity"</span>)</span>
<span id="cb92-209"><a href="#cb92-209"></a>example1_wide</span>
<span id="cb92-210"><a href="#cb92-210"></a><span class="in">```</span></span>
<span id="cb92-211"><a href="#cb92-211"></a></span>
<span id="cb92-212"><a href="#cb92-212"></a>**Important** note that we only <span class="in">`pivot_wider()`</span> our within-subjects data. We DO NOT <span class="in">`pivot_wider()`</span> the between subjects data. In this case, we leave <span class="in">`Group`</span> alone!</span>
<span id="cb92-213"><a href="#cb92-213"></a></span>
<span id="cb92-214"><a href="#cb92-214"></a><span class="in">`example1_wide`</span> gets us back to where we started (sorry for running you in circles), but I wanted to show you how this is done in case you get your data in long format. Now that the data is in wide format, we can check for the homogeneity of covariance matrices using <span class="in">`boxM`</span>.</span>
<span id="cb92-215"><a href="#cb92-215"></a></span>
<span id="cb92-216"><a href="#cb92-216"></a><span class="fu">##### Using the `boxM` test.</span></span>
<span id="cb92-217"><a href="#cb92-217"></a></span>
<span id="cb92-218"><a href="#cb92-218"></a>The call for the <span class="in">`boxM`</span> takes two arguments</span>
<span id="cb92-219"><a href="#cb92-219"></a></span>
<span id="cb92-220"><a href="#cb92-220"></a><span class="ss">-   </span>the within-subject columns</span>
<span id="cb92-221"><a href="#cb92-221"></a><span class="ss">-   </span>the between subject column</span>
<span id="cb92-222"><a href="#cb92-222"></a></span>
<span id="cb92-225"><a href="#cb92-225"></a><span class="in">```{r}</span></span>
<span id="cb92-226"><a href="#cb92-226"></a>ws_columns <span class="ot">&lt;-</span> example1_wide <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"Int"</span>))</span>
<span id="cb92-227"><a href="#cb92-227"></a>bs_column <span class="ot">&lt;-</span> example1_wide<span class="sc">$</span>Group</span>
<span id="cb92-228"><a href="#cb92-228"></a></span>
<span id="cb92-229"><a href="#cb92-229"></a>heplots<span class="sc">::</span><span class="fu">boxM</span>(ws_columns,bs_column)</span>
<span id="cb92-230"><a href="#cb92-230"></a><span class="in">```</span></span>
<span id="cb92-231"><a href="#cb92-231"></a></span>
<span id="cb92-232"><a href="#cb92-232"></a>Note that we typically only concern ourselves with <span class="in">`boxM`</span> if $p$ <span class="sc">\&lt;</span> .001. Why so conservative you ask? Because <span class="in">`boxM`</span> is typically underpowered for small samples and overly sensitive with larger sample sizes (Cohen, 2008). Then why use it, you may ask... ahh it's just step 1 my young Padawan.</span>
<span id="cb92-233"><a href="#cb92-233"></a></span>
<span id="cb92-234"><a href="#cb92-234"></a>In either case these data look good.</span>
<span id="cb92-235"><a href="#cb92-235"></a></span>
<span id="cb92-236"><a href="#cb92-236"></a><span class="fu">#### Test 2: Our friend Levene (and its cousin Brown-Forsythe)</span></span>
<span id="cb92-237"><a href="#cb92-237"></a></span>
<span id="cb92-238"><a href="#cb92-238"></a>Let's assume that we failed <span class="in">`boxM`</span>, what the next step? We can run Levene's Test for homogeneity of variance, or Brown-Forsythe if we have concerns about the normality of the data. Recall that both can be called from <span class="in">`car::leveneTest()`</span> where Levene's is <span class="in">`mean centered`</span> and Brown-Forsythe is <span class="in">`median centered`</span>. In this case we run separate tests on the between subjects <span class="in">`Group`</span> and the BS × WS interaction, in this case <span class="in">`Group * Interval`</span>.</span>
<span id="cb92-239"><a href="#cb92-239"></a></span>
<span id="cb92-240"><a href="#cb92-240"></a>**Note that do do this we return to our data in long format.**</span>
<span id="cb92-241"><a href="#cb92-241"></a></span>
<span id="cb92-242"><a href="#cb92-242"></a>Here I'll run Brown-Forsythe</span>
<span id="cb92-243"><a href="#cb92-243"></a></span>
<span id="cb92-246"><a href="#cb92-246"></a><span class="in">```{r}</span></span>
<span id="cb92-247"><a href="#cb92-247"></a><span class="co"># Brown-Forsythe for Group only</span></span>
<span id="cb92-248"><a href="#cb92-248"></a><span class="fu">leveneTest</span>(Activity<span class="sc">~</span>Group,<span class="at">data =</span> example1_long, <span class="at">center=</span><span class="st">"median"</span>)</span>
<span id="cb92-249"><a href="#cb92-249"></a></span>
<span id="cb92-250"><a href="#cb92-250"></a><span class="co"># Brown-Forsythe for Group * Interval interaction.</span></span>
<span id="cb92-251"><a href="#cb92-251"></a><span class="fu">leveneTest</span>(Activity<span class="sc">~</span>Group<span class="sc">*</span>Interval,<span class="at">data =</span> example1_long, <span class="at">center=</span><span class="st">"median"</span>)</span>
<span id="cb92-252"><a href="#cb92-252"></a><span class="in">```</span></span>
<span id="cb92-253"><a href="#cb92-253"></a></span>
<span id="cb92-254"><a href="#cb92-254"></a>In this case we are particularly concerned with the outcome of the <span class="in">`Group*Interval`</span> interaction. If this interaction had been significant ($p$ <span class="sc">\&lt;</span> .05), coupled with a significant <span class="in">`boxM`</span> ($p$ <span class="sc">\&lt;</span> .001) then we would have cause for concern.</span>
<span id="cb92-255"><a href="#cb92-255"></a></span>
<span id="cb92-256"><a href="#cb92-256"></a>I'll say it one more time with feeling---you should be concerned about your data if:</span>
<span id="cb92-257"><a href="#cb92-257"></a></span>
<span id="cb92-258"><a href="#cb92-258"></a><span class="ss">-   </span>the <span class="in">`boxM`</span> test is significant ($p$ <span class="sc">\&lt;</span> .001) AND</span>
<span id="cb92-259"><a href="#cb92-259"></a><span class="ss">-   </span>the Levene's test of a model that crosses the BS variable <span class="sc">\*</span> WS variable is significant ($p$ <span class="sc">\&lt;</span> .05)</span>
<span id="cb92-260"><a href="#cb92-260"></a></span>
<span id="cb92-261"><a href="#cb92-261"></a><span class="fu">#### What to do if you violate both tests?</span></span>
<span id="cb92-262"><a href="#cb92-262"></a></span>
<span id="cb92-263"><a href="#cb92-263"></a>**You shouldn't run the mixed ANOVA. Instead:**</span>
<span id="cb92-264"><a href="#cb92-264"></a></span>
<span id="cb92-265"><a href="#cb92-265"></a><span class="ss">-   </span>run separate WS-ANOVA for <span class="in">`Interval`</span> on each <span class="in">`Group`</span></span>
<span id="cb92-266"><a href="#cb92-266"></a><span class="ss">-   </span>run a BS-ANOVA on <span class="in">`Group`</span> collapsing <span class="in">`Interval`</span> into means (e.g., take <span class="in">`mean(Int1,Int2, etc...`</span>)</span>
<span id="cb92-267"><a href="#cb92-267"></a></span>
<span id="cb92-268"><a href="#cb92-268"></a>This means that you do not test for between subjects interactions.</span>
<span id="cb92-269"><a href="#cb92-269"></a></span>
<span id="cb92-270"><a href="#cb92-270"></a>***Wait?!??!?! What?!?!?***</span>
<span id="cb92-271"><a href="#cb92-271"></a></span>
<span id="cb92-272"><a href="#cb92-272"></a>Well, technically you would not test between subjects interactions, but this might not be practical if the between subjects interaction is what you were most interested in. Better, just **proceed with caution**!!!</span>
<span id="cb92-273"><a href="#cb92-273"></a></span>
<span id="cb92-274"><a href="#cb92-274"></a>For the sake of example, assume that these data failed both tests. To run separate WS-ANOVA for interval for each group, we could use <span class="in">`filter()`</span> from the <span class="in">`tidyverse`</span> to isolate different groups. For example, to filter for <span class="in">`Control`</span> and run the subsequent ANOVA</span>
<span id="cb92-275"><a href="#cb92-275"></a></span>
<span id="cb92-278"><a href="#cb92-278"></a><span class="in">```{r}</span></span>
<span id="cb92-279"><a href="#cb92-279"></a>control_data <span class="ot">&lt;-</span> example1_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Group<span class="sc">==</span><span class="st">"Control"</span>)</span>
<span id="cb92-280"><a href="#cb92-280"></a></span>
<span id="cb92-281"><a href="#cb92-281"></a>afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"SubjectID"</span>,</span>
<span id="cb92-282"><a href="#cb92-282"></a>             <span class="at">dv =</span> <span class="st">"Activity"</span>,</span>
<span id="cb92-283"><a href="#cb92-283"></a>             <span class="at">data =</span> control_data,</span>
<span id="cb92-284"><a href="#cb92-284"></a>             <span class="at">within =</span> <span class="st">"Interval"</span>,</span>
<span id="cb92-285"><a href="#cb92-285"></a>             <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb92-286"><a href="#cb92-286"></a>             <span class="at">return =</span> <span class="st">"afex_aov"</span>,</span>
<span id="cb92-287"><a href="#cb92-287"></a>             <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"none"</span>))</span>
<span id="cb92-288"><a href="#cb92-288"></a><span class="in">```</span></span>
<span id="cb92-289"><a href="#cb92-289"></a></span>
<span id="cb92-290"><a href="#cb92-290"></a>That said, you can also use <span class="in">`split()`</span> like so:</span>
<span id="cb92-291"><a href="#cb92-291"></a></span>
<span id="cb92-294"><a href="#cb92-294"></a><span class="in">```{r}</span></span>
<span id="cb92-295"><a href="#cb92-295"></a><span class="co"># split(data frame to split, column to split the data frame by)</span></span>
<span id="cb92-296"><a href="#cb92-296"></a>byGroup <span class="ot">&lt;-</span> <span class="fu">split</span>(example1_long,example1_long<span class="sc">$</span>Group)</span>
<span id="cb92-297"><a href="#cb92-297"></a><span class="in">```</span></span>
<span id="cb92-298"><a href="#cb92-298"></a></span>
<span id="cb92-299"><a href="#cb92-299"></a>Running <span class="in">`names(byGroup)`</span> reveals this object holds three groups named "Control", "Same", &amp; "Different".</span>
<span id="cb92-300"><a href="#cb92-300"></a></span>
<span id="cb92-301"><a href="#cb92-301"></a>Then we run each group separately, here's <span class="in">`Control`</span> again:</span>
<span id="cb92-302"><a href="#cb92-302"></a></span>
<span id="cb92-303"><a href="#cb92-303"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb92-304"><a href="#cb92-304"></a>afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"SubjectID"</span>,</span>
<span id="cb92-305"><a href="#cb92-305"></a>             <span class="at">dv =</span> <span class="st">"Activity"</span>,</span>
<span id="cb92-306"><a href="#cb92-306"></a>             <span class="at">data =</span> byGroup<span class="sc">$</span>Control,</span>
<span id="cb92-307"><a href="#cb92-307"></a>             <span class="at">within =</span> <span class="st">"Interval"</span>,</span>
<span id="cb92-308"><a href="#cb92-308"></a>             <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb92-309"><a href="#cb92-309"></a>             <span class="at">return =</span> <span class="st">"afex_aov"</span>,</span>
<span id="cb92-310"><a href="#cb92-310"></a>             <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"none"</span>))</span>
<span id="cb92-311"><a href="#cb92-311"></a><span class="in">```</span></span>
<span id="cb92-312"><a href="#cb92-312"></a></span>
<span id="cb92-313"><a href="#cb92-313"></a>We could run BS-ANOVA on each interval using similar methods.</span>
<span id="cb92-314"><a href="#cb92-314"></a></span>
<span id="cb92-315"><a href="#cb92-315"></a><span class="fu">### plotting the data</span></span>
<span id="cb92-316"><a href="#cb92-316"></a></span>
<span id="cb92-317"><a href="#cb92-317"></a>Now we can plot (not worrying about APA here). Given that interval is a within subjects variable we need to make the appropriate corrections to the error bars. For this we call on Morey (2008) recommendations and use the <span class="in">`withinSummary()`</span> function from our helperFunctions:</span>
<span id="cb92-318"><a href="#cb92-318"></a></span>
<span id="cb92-321"><a href="#cb92-321"></a><span class="in">```{r}</span></span>
<span id="cb92-322"><a href="#cb92-322"></a><span class="co"># grabbing custom function</span></span>
<span id="cb92-323"><a href="#cb92-323"></a><span class="fu">source</span>(<span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/custom_functions/withinSummary.R"</span>)</span>
<span id="cb92-324"><a href="#cb92-324"></a></span>
<span id="cb92-325"><a href="#cb92-325"></a><span class="co"># creating a summary table</span></span>
<span id="cb92-326"><a href="#cb92-326"></a>repdata <span class="ot">&lt;-</span> <span class="fu">withinSummary</span>(<span class="at">data =</span> example1_long,</span>
<span id="cb92-327"><a href="#cb92-327"></a>                         <span class="at">measurevar =</span> <span class="st">"Activity"</span>,</span>
<span id="cb92-328"><a href="#cb92-328"></a>                         <span class="at">betweenvars =</span> <span class="st">"Group"</span>,</span>
<span id="cb92-329"><a href="#cb92-329"></a>                         <span class="at">withinvars =</span> <span class="st">"Interval"</span>,</span>
<span id="cb92-330"><a href="#cb92-330"></a>                         <span class="at">idvar =</span> <span class="st">"SubjectID"</span>)</span>
<span id="cb92-331"><a href="#cb92-331"></a></span>
<span id="cb92-332"><a href="#cb92-332"></a><span class="fu">show</span>(repdata)</span>
<span id="cb92-333"><a href="#cb92-333"></a><span class="in">```</span></span>
<span id="cb92-334"><a href="#cb92-334"></a></span>
<span id="cb92-335"><a href="#cb92-335"></a>This contains the means (<span class="in">`Activity`</span>), normed means (<span class="in">`ActivityNormed`</span>), and estimates of distribution for each <span class="in">`Group`</span> × <span class="in">`Interval`</span> Condition. The normed means are calculated by removing the between-subject variability. This is accomplished be ensuring that each participant have the same average (see this link for background and calculations <span class="co">[</span><span class="ot">link</span><span class="co">](http://www.cogsci.nl/blog/tutorials/156-an-easy-way-to-create-graphs-with-within-subject-error-bars)</span>, Values of se, ci, and sd are then calculated on this normed data. For or resulting plot, we use the raw data for our means and the corrected sd, se, or ci for our error bars.</span>
<span id="cb92-336"><a href="#cb92-336"></a></span>
<span id="cb92-337"><a href="#cb92-337"></a>Using ggplot, this can be accomplished by using the data from our summary table <span class="in">`repdata$Corrected`</span> and using direct calls instead of <span class="in">`summary_stat`</span>:</span>
<span id="cb92-338"><a href="#cb92-338"></a></span>
<span id="cb92-341"><a href="#cb92-341"></a><span class="in">```{r}</span></span>
<span id="cb92-342"><a href="#cb92-342"></a><span class="co"># create universal position dodge</span></span>
<span id="cb92-343"><a href="#cb92-343"></a><span class="co"># this takes care of points, errorbars, and lines</span></span>
<span id="cb92-344"><a href="#cb92-344"></a>dodge_all <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(.<span class="dv">3</span>)</span>
<span id="cb92-345"><a href="#cb92-345"></a></span>
<span id="cb92-346"><a href="#cb92-346"></a><span class="co"># now plot:</span></span>
<span id="cb92-347"><a href="#cb92-347"></a></span>
<span id="cb92-348"><a href="#cb92-348"></a><span class="fu">ggplot</span>(<span class="at">data =</span> repdata<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Interval,</span>
<span id="cb92-349"><a href="#cb92-349"></a>                                              <span class="at">y=</span>Activity,</span>
<span id="cb92-350"><a href="#cb92-350"></a>                                              <span class="at">group=</span>Group)</span>
<span id="cb92-351"><a href="#cb92-351"></a>       ) <span class="sc">+</span></span>
<span id="cb92-352"><a href="#cb92-352"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Group, </span>
<span id="cb92-353"><a href="#cb92-353"></a>                      <span class="at">ymin=</span>Activity<span class="sc">-</span>se, </span>
<span id="cb92-354"><a href="#cb92-354"></a>                      <span class="at">ymax=</span>Activity<span class="sc">+</span>se), </span>
<span id="cb92-355"><a href="#cb92-355"></a>                  <span class="at">size=</span>.<span class="dv">5</span>, </span>
<span id="cb92-356"><a href="#cb92-356"></a>                  <span class="at">position =</span> dodge_all) <span class="sc">+</span></span>
<span id="cb92-357"><a href="#cb92-357"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Group), <span class="at">size=</span><span class="dv">1</span>, <span class="at">position =</span> dodge_all) </span>
<span id="cb92-358"><a href="#cb92-358"></a><span class="in">```</span></span>
<span id="cb92-359"><a href="#cb92-359"></a></span>
<span id="cb92-360"><a href="#cb92-360"></a>Now THESE are the error bars we're looking for!</span>
<span id="cb92-361"><a href="#cb92-361"></a></span>
<span id="cb92-362"><a href="#cb92-362"></a>Remember however, when reporting the error values, you need to use the actual values and NOT the corrected ones from this plot. For this you would refer to the data in the <span class="in">`repdata$Actual`</span> function.</span>
<span id="cb92-363"><a href="#cb92-363"></a></span>
<span id="cb92-364"><a href="#cb92-364"></a><span class="fu">### Running our ANOVA:</span></span>
<span id="cb92-365"><a href="#cb92-365"></a></span>
<span id="cb92-366"><a href="#cb92-366"></a>Running the ANOVA in <span class="in">`afex`</span> is same as before, we just specify BOTH <span class="in">`within`</span> and <span class="in">`between`</span> IVs:</span>
<span id="cb92-367"><a href="#cb92-367"></a></span>
<span id="cb92-370"><a href="#cb92-370"></a><span class="in">```{r}</span></span>
<span id="cb92-371"><a href="#cb92-371"></a>ex1.aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"SubjectID"</span>,</span>
<span id="cb92-372"><a href="#cb92-372"></a>                        <span class="at">dv =</span> <span class="st">"Activity"</span>,</span>
<span id="cb92-373"><a href="#cb92-373"></a>                        <span class="at">data =</span> example1_long,</span>
<span id="cb92-374"><a href="#cb92-374"></a>                        <span class="at">between =</span> <span class="st">"Group"</span>,</span>
<span id="cb92-375"><a href="#cb92-375"></a>                        <span class="at">within =</span> <span class="st">"Interval"</span>,</span>
<span id="cb92-376"><a href="#cb92-376"></a>                        <span class="at">type =</span> <span class="dv">3</span>,</span>
<span id="cb92-377"><a href="#cb92-377"></a>                        <span class="at">return =</span> <span class="st">"afex_aov"</span>,</span>
<span id="cb92-378"><a href="#cb92-378"></a>                        <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"GG"</span>))</span>
<span id="cb92-379"><a href="#cb92-379"></a></span>
<span id="cb92-380"><a href="#cb92-380"></a>ex1.aov</span>
<span id="cb92-381"><a href="#cb92-381"></a></span>
<span id="cb92-382"><a href="#cb92-382"></a><span class="fu">summary</span>(ex1.aov)</span>
<span id="cb92-383"><a href="#cb92-383"></a><span class="in">```</span></span>
<span id="cb92-384"><a href="#cb92-384"></a></span>
<span id="cb92-385"><a href="#cb92-385"></a>Note that sphericity has been violated. **Indeed, mixed ANOVA designs are more likely to give rise to sphericity violations!!** I therefore need to make the appropriate corrections for my ANOVA. In this case a simple re-run of the <span class="in">`aov_ez`</span> setting <span class="in">`correction="GG"`</span> should suffice.</span>
<span id="cb92-386"><a href="#cb92-386"></a></span>
<span id="cb92-387"><a href="#cb92-387"></a><span class="fu">### simple effects</span></span>
<span id="cb92-388"><a href="#cb92-388"></a></span>
<span id="cb92-389"><a href="#cb92-389"></a>There are two ways that I can attack the interaction. I can take a look at Interval effects on the different levels of Group; or I can take a look at Group effects on the different levels of Interval. In the first scenario, I'm looking for within effects on a level of a between factor. In the second scenario, I'm looking for between effects (Group) on a level of a within factor (Interval). How my simple effects ANOVA nests my within and between factors has implications for how I do my follow-up.</span>
<span id="cb92-390"><a href="#cb92-390"></a></span>
<span id="cb92-391"><a href="#cb92-391"></a><span class="fu">#### by Group (repeated measures)</span></span>
<span id="cb92-392"><a href="#cb92-392"></a></span>
<span id="cb92-393"><a href="#cb92-393"></a>If I'm looking at a within effect, nested within a single level of a between factor (scenario 1), then I only need to run simple within-subjects ANOVAs for each between level that I'm interested in. So, for example if I'm interested in the effect of interval in all three groups, then I just run the separate within subjects ANOVA(s) and call it a day. This can be accomplished using <span class="in">`emmeans`</span>. For clarity I'm going to rename <span class="in">`ex1.aov`</span> from above and call it <span class="in">`mixed.aov`</span>.</span>
<span id="cb92-394"><a href="#cb92-394"></a></span>
<span id="cb92-397"><a href="#cb92-397"></a><span class="in">```{r}</span></span>
<span id="cb92-398"><a href="#cb92-398"></a><span class="co"># note mixed.aov is the same as ex1.aov</span></span>
<span id="cb92-399"><a href="#cb92-399"></a>mixed.aov <span class="ot">&lt;-</span> ex1.aov</span>
<span id="cb92-400"><a href="#cb92-400"></a><span class="in">```</span></span>
<span id="cb92-401"><a href="#cb92-401"></a></span>
<span id="cb92-402"><a href="#cb92-402"></a>Now <span class="in">`emmeans`</span>:</span>
<span id="cb92-403"><a href="#cb92-403"></a></span>
<span id="cb92-406"><a href="#cb92-406"></a><span class="in">```{r}</span></span>
<span id="cb92-407"><a href="#cb92-407"></a><span class="fu">joint_tests</span>(mixed.aov, <span class="at">by=</span><span class="st">"Group"</span>, <span class="at">model=</span><span class="st">"multivariate"</span>)</span>
<span id="cb92-408"><a href="#cb92-408"></a><span class="in">```</span></span>
<span id="cb92-409"><a href="#cb92-409"></a></span>
<span id="cb92-410"><a href="#cb92-410"></a>All three groups yielded a significant result. Time for some post-hoc analyses. Remember the top <span class="in">`$emmeans`</span> give us the estimated means themselves and the <span class="in">`$contrasts`</span> give us the p-values.</span>
<span id="cb92-411"><a href="#cb92-411"></a></span>
<span id="cb92-414"><a href="#cb92-414"></a><span class="in">```{r}</span></span>
<span id="cb92-415"><a href="#cb92-415"></a><span class="fu">emmeans</span>(mixed.aov, <span class="at">by=</span><span class="st">"Group"</span>, <span class="at">spec=</span> pairwise<span class="sc">~</span>Interval)</span>
<span id="cb92-416"><a href="#cb92-416"></a><span class="in">```</span></span>
<span id="cb92-417"><a href="#cb92-417"></a></span>
<span id="cb92-418"><a href="#cb92-418"></a><span class="fu">## Example 2:</span></span>
<span id="cb92-419"><a href="#cb92-419"></a></span>
<span id="cb92-420"><a href="#cb92-420"></a>Ok, let's ramp up our complexity here. This time we're using data with 1 within factor and 2 between factors. For background on this data:</span>
<span id="cb92-421"><a href="#cb92-421"></a></span>
<span id="cb92-422"><a href="#cb92-422"></a><span class="at">&gt; This is a study by St. Lawrence, Brasﬁeld, Shirley, Jefferson, Alleyne, and O'Bannon (1995) on an intervention program to reduce the risk of HIV infection among African-American adolescents. The study involved a comparison of two approaches, one of which was a standard 2hour educational program used as a control condition (EC) and the other was an 8-week behavioral skills training program (BST). Subjects were Male and Female adolescents, and measures were taken at Pretest, Posttest, and 6 and 12 months follow-up (FU6 and FU12). There were multiple dependent variables in the study, but the one that we will consider is log(freq + 1), where freq is the frequency of condom-protected intercourse. 4 This is a 2 x 2 x 4 repeated-measures design, with Intervention and Sex as between-subjects factors and Time as the within-subjects factor.</span></span>
<span id="cb92-423"><a href="#cb92-423"></a></span>
<span id="cb92-424"><a href="#cb92-424"></a><span class="fu">### data import and wrangling</span></span>
<span id="cb92-425"><a href="#cb92-425"></a></span>
<span id="cb92-428"><a href="#cb92-428"></a><span class="in">```{r}</span></span>
<span id="cb92-429"><a href="#cb92-429"></a>example2 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab14-7.dat"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb92-430"><a href="#cb92-430"></a>example2</span>
<span id="cb92-431"><a href="#cb92-431"></a><span class="in">```</span></span>
<span id="cb92-432"><a href="#cb92-432"></a></span>
<span id="cb92-433"><a href="#cb92-433"></a>You note that this time around, there is a subject ID, <span class="in">`Person`</span> so no need to add that. From here we can gather the data (in columns 4-7) into long format with Time as the created factor:</span>
<span id="cb92-434"><a href="#cb92-434"></a></span>
<span id="cb92-437"><a href="#cb92-437"></a><span class="in">```{r}</span></span>
<span id="cb92-438"><a href="#cb92-438"></a>example2_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> example2, </span>
<span id="cb92-439"><a href="#cb92-439"></a>                                     <span class="at">cols =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>, </span>
<span id="cb92-440"><a href="#cb92-440"></a>                                     <span class="at">names_to=</span><span class="st">"Time"</span>, </span>
<span id="cb92-441"><a href="#cb92-441"></a>                                     <span class="at">values_to =</span><span class="st">"Freq"</span>)</span>
<span id="cb92-442"><a href="#cb92-442"></a><span class="in">```</span></span>
<span id="cb92-443"><a href="#cb92-443"></a></span>
<span id="cb92-444"><a href="#cb92-444"></a>and give names to our number-coded variables in <span class="in">`Condition`</span> and <span class="in">`Sex`</span>:</span>
<span id="cb92-445"><a href="#cb92-445"></a></span>
<span id="cb92-448"><a href="#cb92-448"></a><span class="in">```{r}</span></span>
<span id="cb92-449"><a href="#cb92-449"></a>example2_long<span class="sc">$</span>Condition <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example2_long<span class="sc">$</span>Condition, </span>
<span id="cb92-450"><a href="#cb92-450"></a>                                         <span class="st">"1"</span><span class="ot">=</span><span class="st">"BST"</span>, </span>
<span id="cb92-451"><a href="#cb92-451"></a>                                         <span class="st">"2"</span><span class="ot">=</span><span class="st">"EC"</span>)</span>
<span id="cb92-452"><a href="#cb92-452"></a></span>
<span id="cb92-453"><a href="#cb92-453"></a>example2_long<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(example2_long<span class="sc">$</span>Sex, </span>
<span id="cb92-454"><a href="#cb92-454"></a>                                   <span class="st">"1"</span><span class="ot">=</span><span class="st">"M"</span>, </span>
<span id="cb92-455"><a href="#cb92-455"></a>                                   <span class="st">"2"</span><span class="ot">=</span><span class="st">"F"</span>)</span>
<span id="cb92-456"><a href="#cb92-456"></a></span>
<span id="cb92-457"><a href="#cb92-457"></a>example2_long</span>
<span id="cb92-458"><a href="#cb92-458"></a><span class="in">```</span></span>
<span id="cb92-459"><a href="#cb92-459"></a></span>
<span id="cb92-460"><a href="#cb92-460"></a>Also, for some reason this data set wants to treat our Freq values as a character string. This was the case from the first import, but it's much easier to wait and address it now (only a single column call). This is a strange quirk of this example dataset and may not apply in all cases:</span>
<span id="cb92-461"><a href="#cb92-461"></a></span>
<span id="cb92-464"><a href="#cb92-464"></a><span class="in">```{r}</span></span>
<span id="cb92-465"><a href="#cb92-465"></a>example2_long<span class="sc">$</span>Freq <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(example2_long<span class="sc">$</span>Freq)</span>
<span id="cb92-466"><a href="#cb92-466"></a><span class="in">```</span></span>
<span id="cb92-467"><a href="#cb92-467"></a></span>
<span id="cb92-468"><a href="#cb92-468"></a><span class="fu">### plotting the data</span></span>
<span id="cb92-469"><a href="#cb92-469"></a></span>
<span id="cb92-470"><a href="#cb92-470"></a>First we need to create the data for the appropriate error bars</span>
<span id="cb92-471"><a href="#cb92-471"></a></span>
<span id="cb92-474"><a href="#cb92-474"></a><span class="in">```{r}</span></span>
<span id="cb92-475"><a href="#cb92-475"></a>repdata <span class="ot">&lt;-</span> <span class="fu">withinSummary</span>(<span class="at">data =</span> example2_long,</span>
<span id="cb92-476"><a href="#cb92-476"></a>                         <span class="at">measurevar =</span> <span class="st">"Freq"</span>,</span>
<span id="cb92-477"><a href="#cb92-477"></a>                         <span class="at">betweenvars =</span> <span class="fu">c</span>(<span class="st">"Condition"</span>,<span class="st">"Sex"</span>), </span>
<span id="cb92-478"><a href="#cb92-478"></a>                         <span class="at">withinvars =</span> <span class="st">"Time"</span>,</span>
<span id="cb92-479"><a href="#cb92-479"></a>                         <span class="at">idvar =</span> <span class="st">"Person"</span>)</span>
<span id="cb92-480"><a href="#cb92-480"></a><span class="fu">show</span>(repdata)</span>
<span id="cb92-481"><a href="#cb92-481"></a><span class="in">```</span></span>
<span id="cb92-482"><a href="#cb92-482"></a></span>
<span id="cb92-483"><a href="#cb92-483"></a>Now we can plot (let's do some APA here):</span>
<span id="cb92-484"><a href="#cb92-484"></a></span>
<span id="cb92-487"><a href="#cb92-487"></a><span class="in">```{r}</span></span>
<span id="cb92-488"><a href="#cb92-488"></a><span class="co"># create universal position dodge</span></span>
<span id="cb92-489"><a href="#cb92-489"></a>dodge_all <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(.<span class="dv">3</span>)</span>
<span id="cb92-490"><a href="#cb92-490"></a></span>
<span id="cb92-491"><a href="#cb92-491"></a><span class="co"># now plot:</span></span>
<span id="cb92-492"><a href="#cb92-492"></a></span>
<span id="cb92-493"><a href="#cb92-493"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> repdata<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time,</span>
<span id="cb92-494"><a href="#cb92-494"></a>                                                   <span class="at">y=</span>Freq,</span>
<span id="cb92-495"><a href="#cb92-495"></a>                                                   <span class="at">group=</span><span class="fu">interaction</span>(Condition,Sex))) <span class="sc">+</span> </span>
<span id="cb92-496"><a href="#cb92-496"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Condition, <span class="at">ymin=</span>Freq<span class="sc">-</span>se, <span class="at">ymax=</span>Freq<span class="sc">+</span>se), <span class="at">size=</span>.<span class="dv">5</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span></span>
<span id="cb92-497"><a href="#cb92-497"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Sex), <span class="at">size=</span><span class="dv">1</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span> </span>
<span id="cb92-498"><a href="#cb92-498"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb92-499"><a href="#cb92-499"></a>  <span class="co"># aesthetics</span></span>
<span id="cb92-500"><a href="#cb92-500"></a>  <span class="fu">theme</span>(</span>
<span id="cb92-501"><a href="#cb92-501"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">lineheight =</span> .<span class="dv">55</span>),</span>
<span id="cb92-502"><a href="#cb92-502"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb92-503"><a href="#cb92-503"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb92-504"><a href="#cb92-504"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">20</span>,.<span class="dv">85</span>)) <span class="sc">+</span></span>
<span id="cb92-505"><a href="#cb92-505"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey50"</span>)) <span class="sc">+</span> </span>
<span id="cb92-506"><a href="#cb92-506"></a>  <span class="fu">xlab</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Time"</span>) <span class="sc">+</span> </span>
<span id="cb92-507"><a href="#cb92-507"></a>  <span class="fu">ylab</span> (<span class="st">"Freq </span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb92-508"><a href="#cb92-508"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>),<span class="st">"in"</span>)) <span class="sc">+</span> </span>
<span id="cb92-509"><a href="#cb92-509"></a>  </span>
<span id="cb92-510"><a href="#cb92-510"></a>  <span class="co"># stack legend boxes horizontally:</span></span>
<span id="cb92-511"><a href="#cb92-511"></a>  <span class="fu">theme</span>(<span class="at">legend.box =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb92-512"><a href="#cb92-512"></a></span>
<span id="cb92-513"><a href="#cb92-513"></a><span class="fu">show</span>(p)</span>
<span id="cb92-514"><a href="#cb92-514"></a><span class="in">```</span></span>
<span id="cb92-515"><a href="#cb92-515"></a></span>
<span id="cb92-516"><a href="#cb92-516"></a>The order along the x-axis is the reverse of what I'd like. Since I'm plotting using <span class="in">`repdata`</span> I need to change the order of my levels there. I can change this by:</span>
<span id="cb92-517"><a href="#cb92-517"></a></span>
<span id="cb92-520"><a href="#cb92-520"></a><span class="in">```{r}</span></span>
<span id="cb92-521"><a href="#cb92-521"></a>repdata<span class="sc">$</span>Corrected<span class="sc">$</span>Time <span class="ot">&lt;-</span> repdata<span class="sc">$</span>Corrected<span class="sc">$</span>Time <span class="sc">%&gt;%</span> <span class="fu">fct_relevel</span>(<span class="fu">c</span>(<span class="st">"Pretest"</span>,<span class="st">"Posttest"</span>,<span class="st">"FU6"</span>,<span class="st">"FU12"</span>))</span>
<span id="cb92-522"><a href="#cb92-522"></a><span class="in">```</span></span>
<span id="cb92-523"><a href="#cb92-523"></a></span>
<span id="cb92-524"><a href="#cb92-524"></a>and now re-plot (adjusting the position of my legend accordingly):</span>
<span id="cb92-525"><a href="#cb92-525"></a></span>
<span id="cb92-528"><a href="#cb92-528"></a><span class="in">```{r}</span></span>
<span id="cb92-529"><a href="#cb92-529"></a><span class="co"># create universal position dodge</span></span>
<span id="cb92-530"><a href="#cb92-530"></a>dodge_all <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(.<span class="dv">3</span>)</span>
<span id="cb92-531"><a href="#cb92-531"></a></span>
<span id="cb92-532"><a href="#cb92-532"></a><span class="co"># now plot:</span></span>
<span id="cb92-533"><a href="#cb92-533"></a></span>
<span id="cb92-534"><a href="#cb92-534"></a><span class="fu">ggplot</span>(<span class="at">data =</span> repdata<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Freq,<span class="at">group=</span><span class="fu">interaction</span>(Condition,Sex))) <span class="sc">+</span> </span>
<span id="cb92-535"><a href="#cb92-535"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Condition, <span class="at">ymin=</span>Freq<span class="sc">-</span>se, <span class="at">ymax=</span>Freq<span class="sc">+</span>se), <span class="at">size=</span>.<span class="dv">5</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span></span>
<span id="cb92-536"><a href="#cb92-536"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Sex), <span class="at">size=</span><span class="dv">1</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span> </span>
<span id="cb92-537"><a href="#cb92-537"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb92-538"><a href="#cb92-538"></a>  <span class="co"># APA ify</span></span>
<span id="cb92-539"><a href="#cb92-539"></a>  <span class="fu">theme</span>(</span>
<span id="cb92-540"><a href="#cb92-540"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">lineheight =</span> .<span class="dv">55</span>),</span>
<span id="cb92-541"><a href="#cb92-541"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb92-542"><a href="#cb92-542"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb92-543"><a href="#cb92-543"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">20</span>,.<span class="dv">85</span>)) <span class="sc">+</span></span>
<span id="cb92-544"><a href="#cb92-544"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey50"</span>)) <span class="sc">+</span> </span>
<span id="cb92-545"><a href="#cb92-545"></a>  <span class="fu">xlab</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Time"</span>) <span class="sc">+</span> </span>
<span id="cb92-546"><a href="#cb92-546"></a>  <span class="fu">ylab</span> (<span class="st">"Freq </span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb92-547"><a href="#cb92-547"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>),<span class="st">"in"</span>)) <span class="sc">+</span> </span>
<span id="cb92-548"><a href="#cb92-548"></a>  </span>
<span id="cb92-549"><a href="#cb92-549"></a>  <span class="co"># stack legend boxes horizontally:</span></span>
<span id="cb92-550"><a href="#cb92-550"></a>  <span class="fu">theme</span>(<span class="at">legend.box =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb92-551"><a href="#cb92-551"></a><span class="in">```</span></span>
<span id="cb92-552"><a href="#cb92-552"></a></span>
<span id="cb92-553"><a href="#cb92-553"></a>On to our assumptions tests!!</span>
<span id="cb92-554"><a href="#cb92-554"></a></span>
<span id="cb92-555"><a href="#cb92-555"></a><span class="fu">### testing our assumptions</span></span>
<span id="cb92-556"><a href="#cb92-556"></a></span>
<span id="cb92-557"><a href="#cb92-557"></a><span class="fu">#### `boxM`</span></span>
<span id="cb92-558"><a href="#cb92-558"></a></span>
<span id="cb92-559"><a href="#cb92-559"></a>I could just use the original <span class="in">`example2`</span> object, but let's spread for practice:</span>
<span id="cb92-560"><a href="#cb92-560"></a></span>
<span id="cb92-563"><a href="#cb92-563"></a><span class="in">```{r}</span></span>
<span id="cb92-564"><a href="#cb92-564"></a><span class="co"># get the data in wide format:</span></span>
<span id="cb92-565"><a href="#cb92-565"></a>example2_wide <span class="ot">&lt;-</span> example2_long <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Time"</span>, <span class="at">values_from =</span> <span class="st">"Freq"</span>)</span>
<span id="cb92-566"><a href="#cb92-566"></a><span class="in">```</span></span>
<span id="cb92-567"><a href="#cb92-567"></a></span>
<span id="cb92-568"><a href="#cb92-568"></a>and now <span class="in">`boxM`</span>. Since we have two between variables, we'll need to run a separate test for each:</span>
<span id="cb92-569"><a href="#cb92-569"></a></span>
<span id="cb92-572"><a href="#cb92-572"></a><span class="in">```{r}</span></span>
<span id="cb92-573"><a href="#cb92-573"></a>heplots<span class="sc">::</span><span class="fu">boxM</span>(example2_wide[,<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],example2_wide<span class="sc">$</span>Condition)</span>
<span id="cb92-574"><a href="#cb92-574"></a>heplots<span class="sc">::</span><span class="fu">boxM</span>(example2_wide[,<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>],example2_wide<span class="sc">$</span>Sex)</span>
<span id="cb92-575"><a href="#cb92-575"></a><span class="in">```</span></span>
<span id="cb92-576"><a href="#cb92-576"></a></span>
<span id="cb92-577"><a href="#cb92-577"></a>In both cases we are fine ($p$ <span class="sc">\&gt;</span> .001). Moving on to the ANOVA.</span>
<span id="cb92-578"><a href="#cb92-578"></a></span>
<span id="cb92-579"><a href="#cb92-579"></a><span class="fu">### Run your omnibus ANOVA:</span></span>
<span id="cb92-580"><a href="#cb92-580"></a></span>
<span id="cb92-583"><a href="#cb92-583"></a><span class="in">```{r}</span></span>
<span id="cb92-584"><a href="#cb92-584"></a>ex2.aov <span class="ot">&lt;-</span> afex<span class="sc">::</span><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"Person"</span>,<span class="at">dv =</span> <span class="st">"Freq"</span>,<span class="at">data =</span> example2_long,<span class="at">between =</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"Condition"</span>), <span class="at">within =</span> <span class="st">"Time"</span>,<span class="at">type =</span> <span class="dv">3</span>,<span class="at">return =</span> <span class="st">"afex_aov"</span>,<span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es=</span><span class="st">"pes"</span>,<span class="at">correction=</span><span class="st">"GG"</span>))</span>
<span id="cb92-585"><a href="#cb92-585"></a></span>
<span id="cb92-586"><a href="#cb92-586"></a><span class="fu">summary</span>(ex2.aov)</span>
<span id="cb92-587"><a href="#cb92-587"></a><span class="in">```</span></span>
<span id="cb92-588"><a href="#cb92-588"></a></span>
<span id="cb92-589"><a href="#cb92-589"></a>Our Mauchly Tests for Sphericity pass, so no need to adjust our degrees of freedom.</span>
<span id="cb92-590"><a href="#cb92-590"></a></span>
<span id="cb92-591"><a href="#cb92-591"></a>And here we see a main effect for <span class="in">`Sex`</span> and a <span class="in">`Condition:Time`</span> interaction. Now to follow-up...</span>
<span id="cb92-592"><a href="#cb92-592"></a></span>
<span id="cb92-593"><a href="#cb92-593"></a><span class="fu">### simple effects:</span></span>
<span id="cb92-594"><a href="#cb92-594"></a></span>
<span id="cb92-595"><a href="#cb92-595"></a>Similar to our first example there are two ways in which we can address that Interaction. We can look for simple (within) effects for Time on each of the between factors (Condition) that we are interested in, or we can look at simple between effects for Condition on each Time level of interest. To help guide this decision, let's replot the data focusing on this interaction (removing <span class="in">`Sex`</span>)</span>
<span id="cb92-596"><a href="#cb92-596"></a></span>
<span id="cb92-599"><a href="#cb92-599"></a><span class="in">```{r}</span></span>
<span id="cb92-600"><a href="#cb92-600"></a>simpleData <span class="ot">&lt;-</span> <span class="fu">withinSummary</span>(<span class="at">data =</span> example2_long,</span>
<span id="cb92-601"><a href="#cb92-601"></a>                            <span class="at">measurevar =</span> <span class="st">"Freq"</span>,</span>
<span id="cb92-602"><a href="#cb92-602"></a>                            <span class="at">betweenvars =</span> <span class="st">"Condition"</span>,</span>
<span id="cb92-603"><a href="#cb92-603"></a>                            <span class="at">withinvars =</span> <span class="st">"Time"</span>,</span>
<span id="cb92-604"><a href="#cb92-604"></a>                            <span class="at">id =</span> <span class="st">"Person"</span>)</span>
<span id="cb92-605"><a href="#cb92-605"></a></span>
<span id="cb92-606"><a href="#cb92-606"></a><span class="co"># releveling and factoring</span></span>
<span id="cb92-607"><a href="#cb92-607"></a>simpleData<span class="sc">$</span>Corrected<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">factor</span>(simpleData<span class="sc">$</span>Corrected<span class="sc">$</span>Time,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pretest"</span>,<span class="st">"Posttest"</span>,<span class="st">"FU6"</span>,<span class="st">"FU12"</span>))</span>
<span id="cb92-608"><a href="#cb92-608"></a></span>
<span id="cb92-609"><a href="#cb92-609"></a><span class="fu">ggplot</span>(<span class="at">data =</span> simpleData<span class="sc">$</span>Corrected,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Freq,<span class="at">group=</span>Condition)) <span class="sc">+</span> </span>
<span id="cb92-610"><a href="#cb92-610"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Condition, <span class="at">ymin=</span>Freq<span class="sc">-</span>se, <span class="at">ymax=</span>Freq<span class="sc">+</span>se), <span class="at">size=</span>.<span class="dv">5</span>, <span class="at">position =</span> dodge_all) <span class="sc">+</span></span>
<span id="cb92-611"><a href="#cb92-611"></a>  <span class="fu">geom_line</span>(<span class="at">position =</span> dodge_all) <span class="sc">+</span> </span>
<span id="cb92-612"><a href="#cb92-612"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb92-613"><a href="#cb92-613"></a>  <span class="co"># aesthetics</span></span>
<span id="cb92-614"><a href="#cb92-614"></a>  <span class="fu">theme</span>(</span>
<span id="cb92-615"><a href="#cb92-615"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">lineheight =</span> .<span class="dv">55</span>),</span>
<span id="cb92-616"><a href="#cb92-616"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb92-617"><a href="#cb92-617"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb92-618"><a href="#cb92-618"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">20</span>,.<span class="dv">85</span>)) <span class="sc">+</span></span>
<span id="cb92-619"><a href="#cb92-619"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey50"</span>)) <span class="sc">+</span> </span>
<span id="cb92-620"><a href="#cb92-620"></a>  <span class="fu">xlab</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Time"</span>) <span class="sc">+</span> </span>
<span id="cb92-621"><a href="#cb92-621"></a>  <span class="fu">ylab</span> (<span class="st">"Freq </span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb92-622"><a href="#cb92-622"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>,.<span class="dv">1</span>),<span class="st">"in"</span>)) <span class="sc">+</span> </span>
<span id="cb92-623"><a href="#cb92-623"></a>  </span>
<span id="cb92-624"><a href="#cb92-624"></a>  <span class="co"># stack legend boxes horizontally:</span></span>
<span id="cb92-625"><a href="#cb92-625"></a>  <span class="fu">theme</span>(<span class="at">legend.box =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb92-626"><a href="#cb92-626"></a><span class="in">```</span></span>
<span id="cb92-627"><a href="#cb92-627"></a></span>
<span id="cb92-628"><a href="#cb92-628"></a><span class="fu">#### by condition (within nested in between):</span></span>
<span id="cb92-629"><a href="#cb92-629"></a></span>
<span id="cb92-630"><a href="#cb92-630"></a>Here we're running a simple effects within ANOVA for Time on each level of Condition. **Importantly, as `Time` is also nested within `Sex`, we need to also include Sex in our simple effects follow-ups**. <span class="in">`emmeans`</span> handles this for us:</span>
<span id="cb92-631"><a href="#cb92-631"></a></span>
<span id="cb92-634"><a href="#cb92-634"></a><span class="in">```{r}</span></span>
<span id="cb92-635"><a href="#cb92-635"></a>emmeans<span class="sc">::</span><span class="fu">joint_tests</span>(ex2.aov, <span class="at">by =</span> <span class="st">"Condition"</span>, <span class="at">model =</span> <span class="st">"multivariate"</span>)</span>
<span id="cb92-636"><a href="#cb92-636"></a><span class="in">```</span></span>
<span id="cb92-637"><a href="#cb92-637"></a></span>
<span id="cb92-638"><a href="#cb92-638"></a>Our analysis of the <span class="in">`BST`</span> group uncovers a simple main effect for <span class="in">`Sex`</span>; this is in agreement with the result of our omnibus ANOVA. Simply, for the <span class="in">`BST`</span> group, <span class="in">`Sex`</span> matters.</span>
<span id="cb92-639"><a href="#cb92-639"></a></span>
<span id="cb92-640"><a href="#cb92-640"></a>Our result for the <span class="in">`EC`</span> group yields a Sex × Time interaction. Again, we needed to include <span class="in">`Sex`</span> in this simple effects ANOVA as <span class="in">`Time`</span> was nested underneath it. That is, we cannot take into account our <span class="in">`Time`</span> effects without understanding that they are confounded with <span class="in">`Sex`</span>. This actually ends up being important here as the interaction tells us that in the <span class="in">`EC`</span> group, <span class="in">`Time`</span> matters more for one <span class="in">`Sex`</span> than it does another. You could then tease apart this interaction as you would typically do in a repeated measures ANOVA.</span>
<span id="cb92-641"><a href="#cb92-641"></a></span>
<span id="cb92-644"><a href="#cb92-644"></a><span class="in">```{r}</span></span>
<span id="cb92-645"><a href="#cb92-645"></a>emmeans<span class="sc">::</span><span class="fu">joint_tests</span>(ex2.aov,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"Condition"</span>), <span class="at">model =</span> <span class="st">"multivariate"</span>)</span>
<span id="cb92-646"><a href="#cb92-646"></a><span class="in">```</span></span>
<span id="cb92-647"><a href="#cb92-647"></a></span>
<span id="cb92-648"><a href="#cb92-648"></a>Here we only pay attention to instances where <span class="in">`Condition = EC`</span>. We see that we have a significance effect for <span class="in">`Time`</span> for men, but not for women. Now following that up:</span>
<span id="cb92-649"><a href="#cb92-649"></a></span>
<span id="cb92-652"><a href="#cb92-652"></a><span class="in">```{r}</span></span>
<span id="cb92-653"><a href="#cb92-653"></a><span class="fu">emmeans</span>(ex2.aov, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sex"</span>,<span class="st">"Condition"</span>), pairwise<span class="sc">~</span>Time, <span class="at">adjust=</span><span class="st">"tukey"</span>, <span class="at">model =</span> <span class="st">"multivariate"</span>)</span>
<span id="cb92-654"><a href="#cb92-654"></a><span class="in">```</span></span>
<span id="cb92-655"><a href="#cb92-655"></a></span>
<span id="cb92-656"><a href="#cb92-656"></a>A ton of output here, but we are only concerned with <span class="in">`Sex = M, Condition = EC`</span>.</span>
<span id="cb92-657"><a href="#cb92-657"></a></span>
<span id="cb92-658"><a href="#cb92-658"></a><span class="fu">#### by Time (between nested in within):</span></span>
<span id="cb92-659"><a href="#cb92-659"></a></span>
<span id="cb92-660"><a href="#cb92-660"></a>Now to look at the alternative, our <span class="in">`Condition`</span> effects on each level of <span class="in">`Time`</span>. We can either run this using <span class="in">`joint_tests()`</span> or because <span class="in">`Condition`</span> only has two levels we can do multiple pairwise comparisons using <span class="in">`emmeans()`</span>.</span>
<span id="cb92-661"><a href="#cb92-661"></a></span>
<span id="cb92-662"><a href="#cb92-662"></a>Here's the <span class="in">`joint_tests`</span> output:</span>
<span id="cb92-663"><a href="#cb92-663"></a></span>
<span id="cb92-666"><a href="#cb92-666"></a><span class="in">```{r}</span></span>
<span id="cb92-667"><a href="#cb92-667"></a><span class="fu">joint_tests</span>(ex2.aov, <span class="at">by =</span> <span class="st">"Time"</span>, <span class="at">model=</span><span class="st">"multivariate"</span>)</span>
<span id="cb92-668"><a href="#cb92-668"></a><span class="in">```</span></span>
<span id="cb92-669"><a href="#cb92-669"></a></span>
<span id="cb92-670"><a href="#cb92-670"></a>Here's the <span class="in">`emmeans`</span> output:</span>
<span id="cb92-671"><a href="#cb92-671"></a></span>
<span id="cb92-674"><a href="#cb92-674"></a><span class="in">```{r}</span></span>
<span id="cb92-675"><a href="#cb92-675"></a><span class="fu">emmeans</span>(ex2.aov, <span class="at">by =</span> <span class="st">"Time"</span>, <span class="at">specs =</span> pairwise<span class="sc">~</span>Condition, <span class="at">model=</span><span class="st">"multivariate"</span>)</span>
<span id="cb92-676"><a href="#cb92-676"></a><span class="in">```</span></span>
<span id="cb92-677"><a href="#cb92-677"></a></span>
<span id="cb92-678"><a href="#cb92-678"></a>The results revealed a significant effect for <span class="in">`Sex`</span> on the <span class="in">`Pretest`</span> Time condition. More importantly in terms of our interaction, they revealed a significant effect for <span class="in">`Condition`</span> only on the <span class="in">`FU6`</span> Time condition.</span>
<span id="cb92-679"><a href="#cb92-679"></a></span>
<span id="cb92-680"><a href="#cb92-680"></a><span class="fu">## to pool or not to pool, this is the yada yada yada</span></span>
<span id="cb92-681"><a href="#cb92-681"></a></span>
<span id="cb92-682"><a href="#cb92-682"></a>At this point you may have a few questions regarding simple effects ANOVA. In particular, the question of when and whether to pool your variances (i.e., use the error from the omnibus ANOVA) or not. If you want the short answer on my recommendation, here you go:</span>
<span id="cb92-683"><a href="#cb92-683"></a></span>
<span id="cb92-684"><a href="#cb92-684"></a>**Only pool variances (`model="univariate"`) if you are running a Between Subjects ANOVA, assuming homogeneity of variances has not been violated. That's it. Any other designs use the error terms associated with the specific tests that you are running (`model="multivariate"`). This is the least risky way of performing your follow-up analysis. I realize we lose power this way, but sorry, that sucks... its a consequence of the design you choose. My feeling, better to be more conservative. That said, for what its worth, you already GAINED a bit of power by choosing a within-subjects design in the first place!**</span>
<span id="cb92-685"><a href="#cb92-685"></a></span>
<span id="cb92-686"><a href="#cb92-686"></a>Why this recommendation? In any design that has a within-subject factor we are almost guaranteed to see some deviations in compound symmetry (and sphericity). In fact, the entire point of the analysis is to account for this. Put another way, the within-subjects ANOVA relaxes the homogeneity assumption, AND implicitly concedes that when conducting your within-subject simple effects follow-ups that you are not granted that variances are similar from one level to the next. So, in within-subjects designs the recommendation is to NOT pool your variances, see <span class="co">[</span><span class="ot">Boik (1981)</span><span class="co">](https://link.springer.com/article/10.1007/BF02293733)</span>.</span>
<span id="cb92-687"><a href="#cb92-687"></a></span>
<span id="cb92-688"><a href="#cb92-688"></a>This goes for post-hocs as well.</span>
<span id="cb92-689"><a href="#cb92-689"></a></span>
<span id="cb92-690"><a href="#cb92-690"></a>One of these days I'll get around to developing simulations to help elucidate why this is an issue. But for now... keep it <span class="in">`multivariate`</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>