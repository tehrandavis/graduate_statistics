<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>tehrandav.is - Power</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">tehrandav.is</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="https://tehrandav.is">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Power</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../walkthroughs.html" class="sidebar-item-text sidebar-link">PSYC 7014</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">TOPIC 1 INTRO to R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_1-Rmarkdown_basics.html" class="sidebar-item-text sidebar-link">Rmarkdown Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_2-objects_assignment_functions.html" class="sidebar-item-text sidebar-link">Objects, assignment, and functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_3-install_packages.html" class="sidebar-item-text sidebar-link">Installing and loading an <code>R</code> package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_4-loading_data.html" class="sidebar-item-text sidebar-link">Loading in Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_5-leveling-up.html" class="sidebar-item-text sidebar-link">Leveling-up</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">TOPIC 2: DESCRIPTIVE STATS and CENTRAL TENDENCY</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_1-structure_data.html" class="sidebar-item-text sidebar-link">The structure of your data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_2-central_tendency.html" class="sidebar-item-text sidebar-link">Measures of central tendency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_3-summary_tables.html" class="sidebar-item-text sidebar-link">Creating summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_4-means_other_models.html" class="sidebar-item-text sidebar-link">Means and other models</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">TOPIC 3: DATA VISUALIZATION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_1-basic_ggplot.html" class="sidebar-item-text sidebar-link">Basic ggplotting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_2-more_adv_ggplot.html" class="sidebar-item-text sidebar-link">More advanced ggPlots</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">TOPIC 4: DISTRIBUTIONS and NHST</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="sidebar-item-text sidebar-link">Building intuitions about probability and NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_3-sampling_distributions_and_seeing_the_logic_of_nhst.html" class="sidebar-item-text sidebar-link">Sampling distributions and seeing the logic of NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_4-more_examples.html" class="sidebar-item-text sidebar-link">More examples of distributions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_5-bias_variance.html" class="sidebar-item-text sidebar-link">Bias in sample variance estimates</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">TOPIC 5: CORRELATION AND REGRESSION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_2_correlations.html" class="sidebar-item-text sidebar-link">Correlations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_3_regressions.html" class="sidebar-item-text sidebar-link">Regression, pt.&nbsp;1: Running the model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_4_plotting.html" class="sidebar-item-text sidebar-link">Plotting regression data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_5_diagnostics.html" class="sidebar-item-text sidebar-link">Regression model diagnostics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_6_example_report.html" class="sidebar-item-text sidebar-link">Example Report</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">TOPIC 6: T-TESTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_1_t-test.html" class="sidebar-item-text sidebar-link">Testing differences in means / t-test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_2_t-test-null-model.html" class="sidebar-item-text sidebar-link">Thinking about nothing (aka the null)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_3_t-test-lm.html" class="sidebar-item-text sidebar-link">t-test? It’s just a linear model</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">TOPIC 7: POWER &amp; EFFECT SIZES</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_1-effect_size.html" class="sidebar-item-text sidebar-link">Effect Size</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_2-power.html" class="sidebar-item-text sidebar-link active">Power</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_3-power_es_sig_tests.html" class="sidebar-item-text sidebar-link">Power, Effect sizes, and Significance testing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_4-simulating_power.html" class="sidebar-item-text sidebar-link">Simulating Power!!!</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">TOPIC 8: INTRO to ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_1-one-way-anova.html" class="sidebar-item-text sidebar-link">The One-way ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_2-anova-regression.html" class="sidebar-item-text sidebar-link">ANOVA and Regression</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">TOPIC 9: ANOVA: CONTRASTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_1-posthocs.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;1: post hoc tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_2-planned_contrasts.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;2: planned contrasts</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">TOPIC 10: ANOVA: FACTORIAL ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_1-main_effects.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - The omnibus ANOVA and Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_2-factorial_w_post_hocs.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - Post hoc analysis of Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_3-advanced_example_and_apa.html" class="sidebar-item-text sidebar-link">Template for Analysis &amp; APA Style</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">TOPIC 11: ANOVA + INTERACTIONS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_1-interactions.html" class="sidebar-item-text sidebar-link">Analysis of Variance: the Factorial ANOVA - Interactions &amp; Simple Effects ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_2-higher_order_anova.html" class="sidebar-item-text sidebar-link">Dealing with Higher Order Factorial ANOVA</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">TOPIC 12: WITHIN SUBJECTS / REPEATED MEASURES ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_1-afex_ANOVA.html" class="sidebar-item-text sidebar-link">afex is for ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_2-repeated_measures_anova.html" class="sidebar-item-text sidebar-link">Within Subjects / Repeated Measures ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_3-factorial_rma.html" class="sidebar-item-text sidebar-link">Factorial RM-ANOVA and simple effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_4-sphericity.html" class="sidebar-item-text sidebar-link">Sphericity: Variances and Co-Variances</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_5-spss_rma.html" class="sidebar-item-text sidebar-link">Running a RM-ANOVA in SPSS</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">TOPIC 13: MIXED ANOVA (BS + WS)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/13_1-mixed_effects_anova.html" class="sidebar-item-text sidebar-link">Mixed-effects ANOVA (BS + WS)</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#truth-and-no-truth-to-power" id="toc-truth-and-no-truth-to-power" class="nav-link active" data-scroll-target="#truth-and-no-truth-to-power">Truth and no truth to power</a></li>
  <li><a href="#finding-power" id="toc-finding-power" class="nav-link" data-scroll-target="#finding-power">Finding power</a></li>
  <li><a href="#estimating-a-priori-power" id="toc-estimating-a-priori-power" class="nav-link" data-scroll-target="#estimating-a-priori-power">Estimating A priori Power</a></li>
  <li><a href="#sample-size-and-power-diminishing-returns" id="toc-sample-size-and-power-diminishing-returns" class="nav-link" data-scroll-target="#sample-size-and-power-diminishing-returns">Sample size and Power (diminishing returns)</a></li>
  <li><a href="#power-and-effect-size" id="toc-power-and-effect-size" class="nav-link" data-scroll-target="#power-and-effect-size">Power and effect size</a></li>
  <li><a href="#regression-example" id="toc-regression-example" class="nav-link" data-scroll-target="#regression-example">Regression example</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Power</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, cowplot, glue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>I guess every superhero needs his theme music</strong></p>
<p>Power is the answer to the second question for the previous section: “How strong would a potential treatment effect in a future experiment need to be in order for us to detect it?” More precisely it is the likelihood that a study will detect an effect when there is an effect. Mathematically we can express power as <span class="math inline">\(1 - \beta\)</span>, where <span class="math inline">\(\beta\)</span> = Type II error (Cohen, 1962, 1988, 1992). Below is a visual representation of power.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="7_2-power_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="600"></p>
</div>
</div>
<section id="truth-and-no-truth-to-power" class="level2"><h2 class="anchored" data-anchor-id="truth-and-no-truth-to-power">Truth and no truth to power</h2>
<p>In your travels you are likely to encounter two kinds of power estimates, <strong>a priori power</strong> and <strong>a posteriori power</strong>. <strong>A priori</strong> power fits with our description above, and is calculated <strong>before</strong> one conducts their experiment. <strong>A posteriori power</strong> is calculated <strong>after</strong> the experiment is completed, and asks provided the observed <em>effect size</em> what is the power that you achieved. One of these two is better than the other… in fact just say no to <strong>a posteriori</strong>, or <strong>post-hoc / observed</strong> power (the latter term shows up in SPSS). As a measure, it is so directly tied to you obtained <em>p-value</em> as to be rendered essentially meaningless, and does not really answer the question that power analysis intends to address.</p>
</section><section id="finding-power" class="level2"><h2 class="anchored" data-anchor-id="finding-power">Finding power</h2>
<p>The calculation of power takes into consideration 3 factors:</p>
<ol type="1">
<li>what is the size of the effect of your treatment / manipulation</li>
<li>how large of a sample do you have to amplify your effect</li>
<li>what is the criterion by which you will measure if the effect is detected.</li>
</ol>
<p>To squeeze every last drop out of the radio metaphor we can think of this as:</p>
<ol type="1">
<li>what is the characteristic of the original signal relative to noise</li>
<li>how much of a boost can you give that signal (how many antennae is it emitted from)</li>
<li>how sensitive is the receiving antenna that tunes in the signal and tunes out the noise.</li>
</ol>
<p>In statistical terms these are:</p>
<ol type="1">
<li>your effect size</li>
<li>your sample size</li>
<li>your <span class="math inline">\(\alpha\)</span> (alpha) value (e.g, <span class="math inline">\(p&lt;.05\)</span>)</li>
</ol>
<p>As experimenters, we can manipulate any of these 3 components to increase the power of our design, though due to practical or theoretical constraints tend to focus on sample size and alpha value. Assuming that we allow effect size to remain constant (that is we don’t try to enhance or exaggerate the effect, see the Cohen textbook for examples) we can calculate power as such:</p>
<p><strong>Calculating a priori Power</strong> Involves setting a specific likelihood (power = .80) at given <span class="math inline">\(\alpha\)</span> level (.05), given a known effect size. This is typically used to estimate the sample size needed to achieve that power (i.e., how much of a signal boost do we need). A key problem here is determining the proper effect size? One suggestion is to survey the literature for independent experiments and meta-analyses and use their results as a guide. BUT, one important thing to consider is that due to publication bias, those results are likely to be overestimates (only effects that are significant are reported, see Kicinski et al., 2015). Some other rules of thumb, assume your effect is small-to-medium (d = .3 or .4).</p>
<p><strong>Post-hoc Power</strong> is estimated given the <em>observed</em> effect size you found from your study, the sample size and <span class="math inline">\(\alpha\)</span> you set. As I mentioned post-hoc power doesn’t really have much value. See <a href="http://daniellakens.blogspot.com/2014/12/observed-power-and-what-to-do-if-your.html">here</a> for a more detailed discussion.</p>
</section><section id="estimating-a-priori-power" class="level2"><h2 class="anchored" data-anchor-id="estimating-a-priori-power">Estimating A priori Power</h2>
<p>Here we aim to ensure a specific likelihood that we will find a significant effect (<span class="math inline">\(1-\beta\)</span>). There are two likelihood values that are often chosen for power: .8 and .95. 80% power is the value suggested by Cohen because it’s economical. 95% is called high power, and it has been favored of late (but its very expensive and you will see why). To calculate power, we need 3 pieces of information. 1) Effect size (in Cohen’s <span class="math inline">\(d\)</span>), 2) your <span class="math inline">\(\alpha\)</span> level, and 3) a number of tails you want to set (usually 2-tailed).</p>
<p>To calculate power in <code>R</code> we can use the <code>pwr</code> package. It should already be installed on your computer (it comes with <code>R</code>), but if for some reason it is not, you can re-install it. In our explanation of power thus fair we have discussed it in the context of comparing two means, as we would in a t-test. Let’s start by performing a power analysis using this example.</p>
<p>For example let’s assume that we are attempting to achieve a power of <code>.80</code> given an effect size (d) of <code>.4</code> and an <span class="math inline">\(\alpha\)</span> of <code>.05</code> when comparing two means in a independent samples t-test. Here we would use the <code>pwr.t.test</code> function in the <code>pwr</code> package.</p>
<p><code>pwr.t.test</code> works by solving what you leave as <code>NULL</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">80</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"two.sample"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 99.08032
              d = 0.4
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p>Here it is telling me that in order to achieve my desired power I would need to recruit 99 participants for each group. Conversely, if this was a paired samples t-test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">80</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb5-2"><a href="#cb5-2"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"paired"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Paired t test power calculation 

              n = 51.00945
              d = 0.4
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number of *pairs*</code></pre>
</div>
</div>
<p>I would need to recruit 51 participants (again showing you repeated measures designs are more powerful).</p>
<p>What happens if I bump my desired power up to .95?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">95</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb7-2"><a href="#cb7-2"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"paired"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Paired t test power calculation 

              n = 83.16425
              d = 0.4
      sig.level = 0.05
          power = 0.95
    alternative = two.sided

NOTE: n is number of *pairs*</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">95</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb9-2"><a href="#cb9-2"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"two.sample"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 163.4006
              d = 0.4
      sig.level = 0.05
          power = 0.95
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p>In this case I need to add about 30 more participants in the paired-samples case and about 64 participants to EACH group in the independent samples case.</p>
</section><section id="sample-size-and-power-diminishing-returns" class="level2"><h2 class="anchored" data-anchor-id="sample-size-and-power-diminishing-returns">Sample size and Power (diminishing returns)</h2>
<p>Sample size and power at a given effect size have a non-linear relationship, such that eventually you hit a wall in how much of an increase in power you get with each increase in sample size. Keeping in mind that <code>pwr.t.test</code> works by solving what you leave as <code>NULL</code>, we can calculate power given our estimated effect size, our alpha, and our likely sample size. Say for example we have a treatment with an estimated effect of <span class="math inline">\(d=.40\)</span>. Given our budget, we are limited to collecting no more than 50 participants total (25 in each group). We can then ask ourselves how powerful is our design (what is the likelihood of detecting an effect given it is there).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> <span class="cn">NULL</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb11-2"><a href="#cb11-2"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"two.sample"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 50
              d = 0.4
      sig.level = 0.05
          power = 0.5081857
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p>Here our power is .51, indicating that we have a 51% chance of detecting an existing effect. This study may not be worth the time, money, and effort. What if we could run this as a paired test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> <span class="cn">NULL</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb13-2"><a href="#cb13-2"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"paired"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Paired t test power calculation 

              n = 50
              d = 0.4
      sig.level = 0.05
          power = 0.7917872
    alternative = two.sided

NOTE: n is number of *pairs*</code></pre>
</div>
</div>
<p>Now our power approaches 80%. This might be a good study to run.</p>
<p>Lets take a look at some power curves, with a priori power as a function of sample size:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="7_2-power_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As you can see, the larger the effect the fewer subjects you need. At the same time both curve plateau suggesting that about a certain sample size your gains in power are inconsequential.</p>
</section><section id="power-and-effect-size" class="level2"><h2 class="anchored" data-anchor-id="power-and-effect-size">Power and effect size</h2>
<p>In a similar vein we address this question: what is the smallest effect size that we can hope to detect given our design. Lets assume we can collect no more than 25 participants and desire a power level of .80.</p>
<p>Again using <code>pwr.t.test</code>, setting our desired power at .80 and leaving <code>d</code> NULL:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">d =</span> <span class="cn">NULL</span>, <span class="at">power =</span> .<span class="dv">8</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb15-2"><a href="#cb15-2"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"paired"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Paired t test power calculation 

              n = 100
              d = 0.2829005
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number of *pairs*</code></pre>
</div>
</div>
</section><section id="regression-example" class="level2"><h2 class="anchored" data-anchor-id="regression-example">Regression example</h2>
<p>We can also estimate power of simple regression analyses using this package and the <code>pwr.f2.test</code>. In this case we need to know our</p>
<ul>
<li>desired <code>power</code>
</li>
<li>numerator degrees of freedom, <code>u</code>
</li>
<li>denominator degrees of freedom, <code>v</code>
</li>
<li>the effect size, <span class="math inline">\(R^2\)</span>, <code>f2</code>
</li>
<li>and our significance level</li>
</ul>
<p>As above, whatever is left <code>NULL</code> is what’s calculated. For example, how many participants would we need to detect an <code>R^2</code> of .39, at a desired power of .80 assuming a simple regression (where our numerator df = 1)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">1</span>,<span class="at">v =</span> <span class="cn">NULL</span>,<span class="at">f2 =</span> .<span class="dv">39</span>,<span class="at">power =</span> .<span class="dv">80</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple regression power calculation 

              u = 1
              v = 20.22032
             f2 = 0.39
      sig.level = 0.05
          power = 0.8</code></pre>
</div>
</div>
<p>This output tells us that our denominator df would need to be about 20. Knowing the relationship between <span class="math inline">\(N\)</span> and the denominator df in simple regression suggests I would need 22 participants.</p>
<p>You can check out this <a href="https://www.statmethods.net/stats/power.html">link for more detail about the power package</a></p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb19" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">---</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="an">title:</span><span class="co"> 'Power'</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">---</span></span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="in">```{r}</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, cowplot, glue)</span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="in">```</span></span>
<span id="cb19-10"><a href="#cb19-10"></a></span>
<span id="cb19-11"><a href="#cb19-11"></a>**I guess every superhero needs his theme music**</span>
<span id="cb19-12"><a href="#cb19-12"></a></span>
<span id="cb19-13"><a href="#cb19-13"></a>Power is the answer to the second question for the previous section: "How strong would a potential treatment effect in a future experiment need to be in order for us to detect it?" More precisely it is the likelihood that a study will detect an effect when there is an effect. Mathematically we can express power as $1 - \beta$, where $\beta$ = Type II error (Cohen, 1962, 1988, 1992). Below is a visual representation of power.</span>
<span id="cb19-14"><a href="#cb19-14"></a></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="in">```{r, echo=FALSE, fig.width=6.25,fig.height=3.0}</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>m1 <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># mu H0</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>sd1 <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="co"># sigma H0</span></span>
<span id="cb19-18"><a href="#cb19-18"></a>m2 <span class="ot">&lt;-</span> <span class="fl">3.5</span> <span class="co"># mu HA</span></span>
<span id="cb19-19"><a href="#cb19-19"></a>sd2 <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="co"># sigma HA</span></span>
<span id="cb19-20"><a href="#cb19-20"></a></span>
<span id="cb19-21"><a href="#cb19-21"></a>z_crit <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>), m1, sd1)</span>
<span id="cb19-22"><a href="#cb19-22"></a></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co"># set length of tails</span></span>
<span id="cb19-24"><a href="#cb19-24"></a>min1 <span class="ot">&lt;-</span> m1<span class="sc">-</span>sd1<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb19-25"><a href="#cb19-25"></a>max1 <span class="ot">&lt;-</span> m1<span class="sc">+</span>sd1<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb19-26"><a href="#cb19-26"></a>min2 <span class="ot">&lt;-</span> m2<span class="sc">-</span>sd2<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb19-27"><a href="#cb19-27"></a>max2 <span class="ot">&lt;-</span> m2<span class="sc">+</span>sd2<span class="sc">*</span><span class="dv">4</span>          </span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="co"># create x sequence</span></span>
<span id="cb19-29"><a href="#cb19-29"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(min1,min2), <span class="fu">max</span>(max1, max2), .<span class="dv">01</span>)</span>
<span id="cb19-30"><a href="#cb19-30"></a><span class="co"># generate normal dist #1</span></span>
<span id="cb19-31"><a href="#cb19-31"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, m1, sd1)</span>
<span id="cb19-32"><a href="#cb19-32"></a><span class="co"># put in data frame</span></span>
<span id="cb19-33"><a href="#cb19-33"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"x"</span> <span class="ot">=</span> x, <span class="st">"y"</span> <span class="ot">=</span> y1)</span>
<span id="cb19-34"><a href="#cb19-34"></a><span class="co"># generate normal dist #2</span></span>
<span id="cb19-35"><a href="#cb19-35"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, m2, sd2)</span>
<span id="cb19-36"><a href="#cb19-36"></a><span class="co"># put in data frame</span></span>
<span id="cb19-37"><a href="#cb19-37"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"x"</span> <span class="ot">=</span> x, <span class="st">"y"</span> <span class="ot">=</span> y2)</span>
<span id="cb19-38"><a href="#cb19-38"></a></span>
<span id="cb19-39"><a href="#cb19-39"></a><span class="co"># Alpha polygon</span></span>
<span id="cb19-40"><a href="#cb19-40"></a>y.poly <span class="ot">&lt;-</span> <span class="fu">pmin</span>(y1,y2)</span>
<span id="cb19-41"><a href="#cb19-41"></a>poly1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.poly)</span>
<span id="cb19-42"><a href="#cb19-42"></a>poly1 <span class="ot">&lt;-</span> poly1[poly1<span class="sc">$</span>x <span class="sc">&gt;=</span> z_crit, ] </span>
<span id="cb19-43"><a href="#cb19-43"></a>poly1<span class="ot">&lt;-</span><span class="fu">rbind</span>(poly1, <span class="fu">c</span>(z_crit, <span class="dv">0</span>))  <span class="co"># add lower-left corner</span></span>
<span id="cb19-44"><a href="#cb19-44"></a></span>
<span id="cb19-45"><a href="#cb19-45"></a><span class="co"># Beta polygon</span></span>
<span id="cb19-46"><a href="#cb19-46"></a>poly2 <span class="ot">&lt;-</span> df2</span>
<span id="cb19-47"><a href="#cb19-47"></a>poly2 <span class="ot">&lt;-</span> poly2[poly2<span class="sc">$</span>x <span class="sc">&lt;=</span> z_crit,] </span>
<span id="cb19-48"><a href="#cb19-48"></a>poly2<span class="ot">&lt;-</span><span class="fu">rbind</span>(poly2, <span class="fu">c</span>(z_crit, <span class="dv">0</span>))  <span class="co"># add lower-left corner</span></span>
<span id="cb19-49"><a href="#cb19-49"></a></span>
<span id="cb19-50"><a href="#cb19-50"></a><span class="co"># power polygon; 1-beta</span></span>
<span id="cb19-51"><a href="#cb19-51"></a>poly3 <span class="ot">&lt;-</span> df2</span>
<span id="cb19-52"><a href="#cb19-52"></a>poly3 <span class="ot">&lt;-</span> poly3[poly3<span class="sc">$</span>x <span class="sc">&gt;=</span> z_crit,] </span>
<span id="cb19-53"><a href="#cb19-53"></a>poly3 <span class="ot">&lt;-</span><span class="fu">rbind</span>(poly3, <span class="fu">c</span>(z_crit, <span class="dv">0</span>))  <span class="co"># add lower-left corner</span></span>
<span id="cb19-54"><a href="#cb19-54"></a></span>
<span id="cb19-55"><a href="#cb19-55"></a><span class="co"># combine polygons. </span></span>
<span id="cb19-56"><a href="#cb19-56"></a>poly1<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># alpha, give it the highest number to make it the top layer</span></span>
<span id="cb19-57"><a href="#cb19-57"></a>poly2<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># beta</span></span>
<span id="cb19-58"><a href="#cb19-58"></a>poly3<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># power; 1 - beta</span></span>
<span id="cb19-59"><a href="#cb19-59"></a>poly <span class="ot">&lt;-</span> <span class="fu">rbind</span>(poly1, poly2, poly3)</span>
<span id="cb19-60"><a href="#cb19-60"></a>poly<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">factor</span>(poly<span class="sc">$</span>id,  <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"power"</span>,<span class="st">"beta"</span>,<span class="st">"alpha"</span>))</span>
<span id="cb19-61"><a href="#cb19-61"></a></span>
<span id="cb19-62"><a href="#cb19-62"></a><span class="fu">ggplot</span>(poly, <span class="fu">aes</span>(x,y, <span class="at">fill=</span>id, <span class="at">group=</span>id)) <span class="sc">+</span></span>
<span id="cb19-63"><a href="#cb19-63"></a>  <span class="fu">geom_polygon</span>(<span class="at">show.legend=</span>F, <span class="at">alpha=</span><span class="fu">I</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb19-64"><a href="#cb19-64"></a>  <span class="co"># add line for treatment group</span></span>
<span id="cb19-65"><a href="#cb19-65"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>df1, <span class="fu">aes</span>(x,y, <span class="at">color=</span><span class="st">"H0"</span>, <span class="at">group=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="cn">NULL</span>), <span class="at">size=</span><span class="fl">1.5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span> </span>
<span id="cb19-66"><a href="#cb19-66"></a>  <span class="co"># add line for treatment group. These lines could be combined into one dataframe.</span></span>
<span id="cb19-67"><a href="#cb19-67"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>df2, <span class="fu">aes</span>(<span class="at">color=</span><span class="st">"HA"</span>, <span class="at">group=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="cn">NULL</span>),<span class="at">size=</span><span class="fl">1.5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb19-68"><a href="#cb19-68"></a>  <span class="co"># add vlines for z_crit</span></span>
<span id="cb19-69"><a href="#cb19-69"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> z_crit, <span class="at">size=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb19-70"><a href="#cb19-70"></a>  <span class="co"># change colors </span></span>
<span id="cb19-71"><a href="#cb19-71"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Group"</span>, </span>
<span id="cb19-72"><a href="#cb19-72"></a>                     <span class="at">values=</span> <span class="fu">c</span>(<span class="st">"HA"</span> <span class="ot">=</span> <span class="st">"#981e0b"</span>,<span class="st">"H0"</span> <span class="ot">=</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb19-73"><a href="#cb19-73"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"test"</span>, <span class="at">values=</span> <span class="fu">c</span>(<span class="st">"alpha"</span> <span class="ot">=</span> <span class="st">"#0d6374"</span>,<span class="st">"beta"</span> <span class="ot">=</span> <span class="st">"#be805e"</span>,<span class="st">"power"</span><span class="ot">=</span><span class="st">"#7cecee"</span>)) <span class="sc">+</span></span>
<span id="cb19-74"><a href="#cb19-74"></a>  <span class="co"># beta arrow</span></span>
<span id="cb19-75"><a href="#cb19-75"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span><span class="fl">0.1</span>, <span class="at">y=</span><span class="fl">0.045</span>, <span class="at">xend=</span><span class="fl">1.3</span>, <span class="at">yend=</span><span class="fl">0.01</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-76"><a href="#cb19-76"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label=</span><span class="st">"beta"</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="fl">0.05</span>, <span class="at">parse=</span>T, <span class="at">size=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb19-77"><a href="#cb19-77"></a>  <span class="co"># alpha arrow</span></span>
<span id="cb19-78"><a href="#cb19-78"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span><span class="dv">4</span>, <span class="at">y=</span><span class="fl">0.043</span>, <span class="at">xend=</span><span class="fl">3.4</span>, <span class="at">yend=</span><span class="fl">0.01</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-79"><a href="#cb19-79"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label=</span><span class="st">"frac(alpha,2)"</span>, <span class="at">x=</span><span class="fl">4.2</span>, <span class="at">y=</span><span class="fl">0.05</span>, <span class="at">parse=</span>T, <span class="at">size=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb19-80"><a href="#cb19-80"></a>  <span class="co"># power arrow</span></span>
<span id="cb19-81"><a href="#cb19-81"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span><span class="dv">6</span>, <span class="at">y=</span><span class="fl">0.2</span>, <span class="at">xend=</span><span class="fl">4.5</span>, <span class="at">yend=</span><span class="fl">0.15</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)), <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-82"><a href="#cb19-82"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label=</span><span class="st">"1-beta"</span>, <span class="at">x=</span><span class="fl">6.1</span>, <span class="at">y=</span><span class="fl">0.21</span>, <span class="at">parse=</span>T, <span class="at">size=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb19-83"><a href="#cb19-83"></a>  <span class="co"># H_0 title</span></span>
<span id="cb19-84"><a href="#cb19-84"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label=</span><span class="st">"H[0]"</span>, <span class="at">x=</span>m1, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">parse=</span>T, <span class="at">size=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb19-85"><a href="#cb19-85"></a>  <span class="co"># H_a title</span></span>
<span id="cb19-86"><a href="#cb19-86"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label=</span><span class="st">"H[1]"</span>, <span class="at">x=</span>m2, <span class="at">y=</span><span class="fl">0.28</span>, <span class="at">parse=</span>T, <span class="at">size=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb19-87"><a href="#cb19-87"></a>  <span class="fu">ggtitle</span>(<span class="st">"Power Example"</span>) <span class="sc">+</span></span>
<span id="cb19-88"><a href="#cb19-88"></a>  <span class="co"># remove some elements</span></span>
<span id="cb19-89"><a href="#cb19-89"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-90"><a href="#cb19-90"></a>             <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-91"><a href="#cb19-91"></a>             <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-92"><a href="#cb19-92"></a>             <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"#ffffff"</span>),</span>
<span id="cb19-93"><a href="#cb19-93"></a>             <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-94"><a href="#cb19-94"></a>             <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-95"><a href="#cb19-95"></a>             <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-96"><a href="#cb19-96"></a>             <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-97"><a href="#cb19-97"></a>             <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-98"><a href="#cb19-98"></a>             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-99"><a href="#cb19-99"></a>             <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-100"><a href="#cb19-100"></a>             <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">22</span>))</span>
<span id="cb19-101"><a href="#cb19-101"></a><span class="in">```</span></span>
<span id="cb19-102"><a href="#cb19-102"></a></span>
<span id="cb19-103"><a href="#cb19-103"></a><span class="fu">## Truth and no truth to power</span></span>
<span id="cb19-104"><a href="#cb19-104"></a></span>
<span id="cb19-105"><a href="#cb19-105"></a>In your travels you are likely to encounter two kinds of power estimates, **a priori power** and **a posteriori power**. **A priori** power fits with our description above, and is calculated **before** one conducts their experiment. **A posteriori power** is calculated **after** the experiment is completed, and asks provided the observed *effect size* what is the power that you achieved. One of these two is better than the other... in fact just say no to **a posteriori**, or **post-hoc / observed** power (the latter term shows up in SPSS). As a measure, it is so directly tied to you obtained *p-value* as to be rendered essentially meaningless, and does not really answer the question that power analysis intends to address.</span>
<span id="cb19-106"><a href="#cb19-106"></a></span>
<span id="cb19-107"><a href="#cb19-107"></a><span class="fu">## Finding power</span></span>
<span id="cb19-108"><a href="#cb19-108"></a></span>
<span id="cb19-109"><a href="#cb19-109"></a>The calculation of power takes into consideration 3 factors:</span>
<span id="cb19-110"><a href="#cb19-110"></a></span>
<span id="cb19-111"><a href="#cb19-111"></a><span class="ss">1.  </span>what is the size of the effect of your treatment / manipulation</span>
<span id="cb19-112"><a href="#cb19-112"></a><span class="ss">2.  </span>how large of a sample do you have to amplify your effect</span>
<span id="cb19-113"><a href="#cb19-113"></a><span class="ss">3.  </span>what is the criterion by which you will measure if the effect is detected.</span>
<span id="cb19-114"><a href="#cb19-114"></a></span>
<span id="cb19-115"><a href="#cb19-115"></a>To squeeze every last drop out of the radio metaphor we can think of this as:</span>
<span id="cb19-116"><a href="#cb19-116"></a></span>
<span id="cb19-117"><a href="#cb19-117"></a><span class="ss">1.  </span>what is the characteristic of the original signal relative to noise</span>
<span id="cb19-118"><a href="#cb19-118"></a><span class="ss">2.  </span>how much of a boost can you give that signal (how many antennae is it emitted from)</span>
<span id="cb19-119"><a href="#cb19-119"></a><span class="ss">3.  </span>how sensitive is the receiving antenna that tunes in the signal and tunes out the noise.</span>
<span id="cb19-120"><a href="#cb19-120"></a></span>
<span id="cb19-121"><a href="#cb19-121"></a>In statistical terms these are:</span>
<span id="cb19-122"><a href="#cb19-122"></a></span>
<span id="cb19-123"><a href="#cb19-123"></a><span class="ss">1.  </span>your effect size</span>
<span id="cb19-124"><a href="#cb19-124"></a><span class="ss">2.  </span>your sample size</span>
<span id="cb19-125"><a href="#cb19-125"></a><span class="ss">3.  </span>your $\alpha$ (alpha) value (e.g, $p&lt;.05$)</span>
<span id="cb19-126"><a href="#cb19-126"></a></span>
<span id="cb19-127"><a href="#cb19-127"></a>As experimenters, we can manipulate any of these 3 components to increase the power of our design, though due to practical or theoretical constraints tend to focus on sample size and alpha value. Assuming that we allow effect size to remain constant (that is we don't try to enhance or exaggerate the effect, see the Cohen textbook for examples) we can calculate power as such:</span>
<span id="cb19-128"><a href="#cb19-128"></a></span>
<span id="cb19-129"><a href="#cb19-129"></a>**Calculating a priori Power** Involves setting a specific likelihood (power = .80) at given $\alpha$ level (.05), given a known effect size. This is typically used to estimate the sample size needed to achieve that power (i.e., how much of a signal boost do we need). A key problem here is determining the proper effect size? One suggestion is to survey the literature for independent experiments and meta-analyses and use their results as a guide. BUT, one important thing to consider is that due to publication bias, those results are likely to be overestimates (only effects that are significant are reported, see Kicinski et al., 2015). Some other rules of thumb, assume your effect is small-to-medium (d = .3 or .4).</span>
<span id="cb19-130"><a href="#cb19-130"></a></span>
<span id="cb19-131"><a href="#cb19-131"></a>**Post-hoc Power** is estimated given the *observed* effect size you found from your study, the sample size and $\alpha$ you set. As I mentioned post-hoc power doesn't really have much value. See <span class="co">[</span><span class="ot">here</span><span class="co">](http://daniellakens.blogspot.com/2014/12/observed-power-and-what-to-do-if-your.html)</span> for a more detailed discussion.</span>
<span id="cb19-132"><a href="#cb19-132"></a></span>
<span id="cb19-133"><a href="#cb19-133"></a><span class="fu">## Estimating A priori Power</span></span>
<span id="cb19-134"><a href="#cb19-134"></a></span>
<span id="cb19-135"><a href="#cb19-135"></a>Here we aim to ensure a specific likelihood that we will find a significant effect ($1-\beta$). There are two likelihood values that are often chosen for power: .8 and .95. 80% power is the value suggested by Cohen because it's economical. 95% is called high power, and it has been favored of late (but its very expensive and you will see why). To calculate power, we need 3 pieces of information. 1) Effect size (in Cohen's $d$), 2) your $\alpha$ level, and 3) a number of tails you want to set (usually 2-tailed).</span>
<span id="cb19-136"><a href="#cb19-136"></a></span>
<span id="cb19-137"><a href="#cb19-137"></a>To calculate power in <span class="in">`R`</span> we can use the <span class="in">`pwr`</span> package. It should already be installed on your computer (it comes with <span class="in">`R`</span>), but if for some reason it is not, you can re-install it. In our explanation of power thus fair we have discussed it in the context of comparing two means, as we would in a t-test. Let's start by performing a power analysis using this example.</span>
<span id="cb19-138"><a href="#cb19-138"></a></span>
<span id="cb19-139"><a href="#cb19-139"></a>For example let's assume that we are attempting to achieve a power of <span class="in">`.80`</span> given an effect size (d) of <span class="in">`.4`</span> and an $\alpha$ of <span class="in">`.05`</span> when comparing two means in a independent samples t-test. Here we would use the <span class="in">`pwr.t.test`</span> function in the <span class="in">`pwr`</span> package.</span>
<span id="cb19-140"><a href="#cb19-140"></a></span>
<span id="cb19-141"><a href="#cb19-141"></a><span class="in">`pwr.t.test`</span> works by solving what you leave as <span class="in">`NULL`</span>.</span>
<span id="cb19-142"><a href="#cb19-142"></a></span>
<span id="cb19-145"><a href="#cb19-145"></a><span class="in">```{r}</span></span>
<span id="cb19-146"><a href="#cb19-146"></a><span class="fu">library</span>(pwr)</span>
<span id="cb19-147"><a href="#cb19-147"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">80</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-148"><a href="#cb19-148"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"two.sample"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span>
<span id="cb19-149"><a href="#cb19-149"></a><span class="in">```</span></span>
<span id="cb19-150"><a href="#cb19-150"></a></span>
<span id="cb19-151"><a href="#cb19-151"></a>Here it is telling me that in order to achieve my desired power I would need to recruit 99 participants for each group. Conversely, if this was a paired samples t-test:</span>
<span id="cb19-152"><a href="#cb19-152"></a></span>
<span id="cb19-155"><a href="#cb19-155"></a><span class="in">```{r}</span></span>
<span id="cb19-156"><a href="#cb19-156"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">80</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-157"><a href="#cb19-157"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"paired"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span>
<span id="cb19-158"><a href="#cb19-158"></a><span class="in">```</span></span>
<span id="cb19-159"><a href="#cb19-159"></a></span>
<span id="cb19-160"><a href="#cb19-160"></a>I would need to recruit 51 participants (again showing you repeated measures designs are more powerful).</span>
<span id="cb19-161"><a href="#cb19-161"></a></span>
<span id="cb19-162"><a href="#cb19-162"></a>What happens if I bump my desired power up to .95?</span>
<span id="cb19-163"><a href="#cb19-163"></a></span>
<span id="cb19-166"><a href="#cb19-166"></a><span class="in">```{r}</span></span>
<span id="cb19-167"><a href="#cb19-167"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">95</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-168"><a href="#cb19-168"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"paired"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span>
<span id="cb19-169"><a href="#cb19-169"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> .<span class="dv">95</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-170"><a href="#cb19-170"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"two.sample"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span>
<span id="cb19-171"><a href="#cb19-171"></a><span class="in">```</span></span>
<span id="cb19-172"><a href="#cb19-172"></a></span>
<span id="cb19-173"><a href="#cb19-173"></a>In this case I need to add about 30 more participants in the paired-samples case and about 64 participants to EACH group in the independent samples case.</span>
<span id="cb19-174"><a href="#cb19-174"></a></span>
<span id="cb19-175"><a href="#cb19-175"></a><span class="fu">## Sample size and Power (diminishing returns)</span></span>
<span id="cb19-176"><a href="#cb19-176"></a></span>
<span id="cb19-177"><a href="#cb19-177"></a>Sample size and power at a given effect size have a non-linear relationship, such that eventually you hit a wall in how much of an increase in power you get with each increase in sample size. Keeping in mind that <span class="in">`pwr.t.test`</span> works by solving what you leave as <span class="in">`NULL`</span>, we can calculate power given our estimated effect size, our alpha, and our likely sample size. Say for example we have a treatment with an estimated effect of $d=.40$. Given our budget, we are limited to collecting no more than 50 participants total (25 in each group). We can then ask ourselves how powerful is our design (what is the likelihood of detecting an effect given it is there).</span>
<span id="cb19-178"><a href="#cb19-178"></a></span>
<span id="cb19-181"><a href="#cb19-181"></a><span class="in">```{r}</span></span>
<span id="cb19-182"><a href="#cb19-182"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> <span class="cn">NULL</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-183"><a href="#cb19-183"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"two.sample"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span>
<span id="cb19-184"><a href="#cb19-184"></a><span class="in">```</span></span>
<span id="cb19-185"><a href="#cb19-185"></a></span>
<span id="cb19-186"><a href="#cb19-186"></a>Here our power is .51, indicating that we have a 51% chance of detecting an existing effect. This study may not be worth the time, money, and effort. What if we could run this as a paired test:</span>
<span id="cb19-187"><a href="#cb19-187"></a></span>
<span id="cb19-190"><a href="#cb19-190"></a><span class="in">```{r}</span></span>
<span id="cb19-191"><a href="#cb19-191"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">d =</span> .<span class="dv">4</span>, <span class="at">power =</span> <span class="cn">NULL</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-192"><a href="#cb19-192"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"paired"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span>
<span id="cb19-193"><a href="#cb19-193"></a><span class="in">```</span></span>
<span id="cb19-194"><a href="#cb19-194"></a></span>
<span id="cb19-195"><a href="#cb19-195"></a>Now our power approaches 80%. This might be a good study to run.</span>
<span id="cb19-196"><a href="#cb19-196"></a></span>
<span id="cb19-197"><a href="#cb19-197"></a>Lets take a look at some power curves, with a priori power as a function of sample size:</span>
<span id="cb19-198"><a href="#cb19-198"></a></span>
<span id="cb19-199"><a href="#cb19-199"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb19-200"><a href="#cb19-200"></a><span class="fu">library</span>(pwr)</span>
<span id="cb19-201"><a href="#cb19-201"></a>OneSample.T.N<span class="ot">&lt;-</span><span class="cf">function</span>(Nrange,D)</span>
<span id="cb19-202"><a href="#cb19-202"></a>  {N<span class="ot">&lt;-</span><span class="fu">pwr.t.test</span>(<span class="at">n =</span> Nrange, <span class="at">d =</span> D, <span class="at">power =</span> <span class="cn">NULL</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-203"><a href="#cb19-203"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"one.sample"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))<span class="sc">$</span>power</span>
<span id="cb19-204"><a href="#cb19-204"></a>  <span class="fu">return</span>(N)</span>
<span id="cb19-205"><a href="#cb19-205"></a>  }</span>
<span id="cb19-206"><a href="#cb19-206"></a></span>
<span id="cb19-207"><a href="#cb19-207"></a>Nrange<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">200</span>,.<span class="dv">5</span>)</span>
<span id="cb19-208"><a href="#cb19-208"></a></span>
<span id="cb19-209"><a href="#cb19-209"></a>med_Power<span class="ot">&lt;-</span><span class="fu">mapply</span>(OneSample.T.N,Nrange,<span class="at">D=</span>.<span class="dv">4</span>)</span>
<span id="cb19-210"><a href="#cb19-210"></a></span>
<span id="cb19-211"><a href="#cb19-211"></a>plot_med <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Nrange,med_Power) <span class="sc">%&gt;%</span> </span>
<span id="cb19-212"><a href="#cb19-212"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x=</span>Nrange, <span class="at">y=</span>med_Power)) <span class="sc">+</span></span>
<span id="cb19-213"><a href="#cb19-213"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb19-214"><a href="#cb19-214"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Power Curve, d = .4, alpha = .05/2"</span>,</span>
<span id="cb19-215"><a href="#cb19-215"></a>         <span class="at">x=</span><span class="st">"Sample Size"</span>, <span class="at">y=</span><span class="st">"Apriori Power"</span>) <span class="sc">+</span></span>
<span id="cb19-216"><a href="#cb19-216"></a>    <span class="fu">theme_cowplot</span>()</span>
<span id="cb19-217"><a href="#cb19-217"></a></span>
<span id="cb19-218"><a href="#cb19-218"></a>lrg_Power<span class="ot">&lt;-</span><span class="fu">mapply</span>(OneSample.T.N,Nrange,<span class="at">D=</span>.<span class="dv">8</span>)</span>
<span id="cb19-219"><a href="#cb19-219"></a></span>
<span id="cb19-220"><a href="#cb19-220"></a>plot_lrg <span class="ot">&lt;-</span> <span class="fu">tibble</span>(Nrange,lrg_Power) <span class="sc">%&gt;%</span> </span>
<span id="cb19-221"><a href="#cb19-221"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x=</span>Nrange, <span class="at">y=</span>lrg_Power)) <span class="sc">+</span></span>
<span id="cb19-222"><a href="#cb19-222"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb19-223"><a href="#cb19-223"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Power Curve, d = .8, alpha = .05/2"</span>,</span>
<span id="cb19-224"><a href="#cb19-224"></a>         <span class="at">x=</span><span class="st">"Sample Size"</span>, <span class="at">y=</span><span class="st">"Apriori Power"</span>) <span class="sc">+</span></span>
<span id="cb19-225"><a href="#cb19-225"></a>    <span class="fu">theme_cowplot</span>()</span>
<span id="cb19-226"><a href="#cb19-226"></a></span>
<span id="cb19-227"><a href="#cb19-227"></a><span class="fu">plot_grid</span>(plot_med, plot_lrg)</span>
<span id="cb19-228"><a href="#cb19-228"></a><span class="in">```</span></span>
<span id="cb19-229"><a href="#cb19-229"></a></span>
<span id="cb19-230"><a href="#cb19-230"></a>As you can see, the larger the effect the fewer subjects you need. At the same time both curve plateau suggesting that about a certain sample size your gains in power are inconsequential.</span>
<span id="cb19-231"><a href="#cb19-231"></a></span>
<span id="cb19-232"><a href="#cb19-232"></a><span class="fu">## Power and effect size</span></span>
<span id="cb19-233"><a href="#cb19-233"></a></span>
<span id="cb19-234"><a href="#cb19-234"></a>In a similar vein we address this question: what is the smallest effect size that we can hope to detect given our design. Lets assume we can collect no more than 25 participants and desire a power level of .80.</span>
<span id="cb19-235"><a href="#cb19-235"></a></span>
<span id="cb19-236"><a href="#cb19-236"></a>Again using <span class="in">`pwr.t.test`</span>, setting our desired power at .80 and leaving <span class="in">`d`</span> NULL:</span>
<span id="cb19-237"><a href="#cb19-237"></a></span>
<span id="cb19-240"><a href="#cb19-240"></a><span class="in">```{r}</span></span>
<span id="cb19-241"><a href="#cb19-241"></a><span class="fu">pwr.t.test</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">d =</span> <span class="cn">NULL</span>, <span class="at">power =</span> .<span class="dv">8</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-242"><a href="#cb19-242"></a>               <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"paired"</span>), <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"two.sided"</span>))</span>
<span id="cb19-243"><a href="#cb19-243"></a><span class="in">```</span></span>
<span id="cb19-244"><a href="#cb19-244"></a></span>
<span id="cb19-245"><a href="#cb19-245"></a><span class="fu">## Regression example</span></span>
<span id="cb19-246"><a href="#cb19-246"></a></span>
<span id="cb19-247"><a href="#cb19-247"></a>We can also estimate power of simple regression analyses using this package and the <span class="in">`pwr.f2.test`</span>. In this case we need to know our</span>
<span id="cb19-248"><a href="#cb19-248"></a></span>
<span id="cb19-249"><a href="#cb19-249"></a><span class="ss">-   </span>desired <span class="in">`power`</span></span>
<span id="cb19-250"><a href="#cb19-250"></a><span class="ss">-   </span>numerator degrees of freedom, <span class="in">`u`</span></span>
<span id="cb19-251"><a href="#cb19-251"></a><span class="ss">-   </span>denominator degrees of freedom, <span class="in">`v`</span></span>
<span id="cb19-252"><a href="#cb19-252"></a><span class="ss">-   </span>the effect size, $R^2$, <span class="in">`f2`</span></span>
<span id="cb19-253"><a href="#cb19-253"></a><span class="ss">-   </span>and our significance level</span>
<span id="cb19-254"><a href="#cb19-254"></a></span>
<span id="cb19-255"><a href="#cb19-255"></a>As above, whatever is left <span class="in">`NULL`</span> is what's calculated. For example, how many participants would we need to detect an <span class="in">`R^2`</span> of .39, at a desired power of .80 assuming a simple regression (where our numerator df = 1)</span>
<span id="cb19-256"><a href="#cb19-256"></a></span>
<span id="cb19-259"><a href="#cb19-259"></a><span class="in">```{r}</span></span>
<span id="cb19-260"><a href="#cb19-260"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">1</span>,<span class="at">v =</span> <span class="cn">NULL</span>,<span class="at">f2 =</span> .<span class="dv">39</span>,<span class="at">power =</span> .<span class="dv">80</span>)</span>
<span id="cb19-261"><a href="#cb19-261"></a><span class="in">```</span></span>
<span id="cb19-262"><a href="#cb19-262"></a></span>
<span id="cb19-263"><a href="#cb19-263"></a>This output tells us that our denominator df would need to be about 20. Knowing the relationship between $N$ and the denominator df in simple regression suggests I would need 22 participants.</span>
<span id="cb19-264"><a href="#cb19-264"></a></span>
<span id="cb19-265"><a href="#cb19-265"></a>You can check out this <span class="co">[</span><span class="ot">link for more detail about the power package</span><span class="co">](https://www.statmethods.net/stats/power.html)</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>