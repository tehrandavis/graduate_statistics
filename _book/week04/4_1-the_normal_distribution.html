<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Tehran Davis">
<title>PSYC 7014: Graduate Statistics 1 - 15&nbsp; The normal distribution</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" rel="next">
<link href="../week02/2_4-means_other_models.html" rel="prev">
<link href="../images/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The normal distribution</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">PSYC 7014: Graduate Statistics 1</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Graduate Statistics Walkthroughs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Part 1: INTRO to R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week00/0_1-getting_started.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week00/0_2-resources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Links to resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_1-Rmarkdown_basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Rmarkdown Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_2-objects_assignment_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Objects, assignment, and functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_3-install_packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Installing and loading an <code>R</code> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_4-loading_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Loading in Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_5-leveling-up.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Leveling-up</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Part 2: DESCRIBING &amp; VISUALIZING DATA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_1-structure_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The structure of your data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_2-central_tendency.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Measures of central tendency</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_3-summary_tables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Creating summary tables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_1-basic_ggplot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Basic ggplotting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_2-more_adv_ggplot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">More advanced ggPlots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_4-means_other_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Means and other models</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Part 3: DISTRIBUTIONS and NHST</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The normal distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Building intuitions about probability and NHST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_3-sampling_distributions_and_seeing_the_logic_of_nhst.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Sampling distributions and seeing the logic of NHST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_4-more_examples.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">More examples of distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_5-bias_variance.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Bias in sample variance estimates</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Part 4: MODELING w/ CONTINUOUS PREDICTORS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_2_correlations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_3_regressions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Regression, pt.&nbsp;1: Running the model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_4_plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Plotting regression data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_5_diagnostics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Regression model diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_6_example_report.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Example Report</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Part 5: T-TESTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_1_t-test.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Testing differences in means / t-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_2_t-test-null-model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Thinking about nothing (aka the null)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_3_t-test-lm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">t-test? It’s just a linear model</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Part 6: Power &amp; Effect Size</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_1-effect_size.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Effect Size</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_2-power.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Power</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_3-power_es_sig_tests.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Power, Effect sizes, and Significance testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_4-simulating_power.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Simulating Power!!!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Part 7: One-way ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_1-one-way-anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">The One-way ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_2-anova-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ANOVA and Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_1-posthocs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Multiple comparisons in One-way ANOVA, pt.&nbsp;1: post hoc tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_2-planned_contrasts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Multiple comparisons in One-way ANOVA, pt.&nbsp;2: planned contrasts</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Part 8: Factorial ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_1-main_effects.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Factorial ANOVA - The omnibus ANOVA and Main effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_2-factorial_w_post_hocs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Factorial ANOVA - Post hoc analysis of Main effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_3-advanced_example_and_apa.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Template for Analysis &amp; APA Style</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Part 9: Repeated Measures ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_1-afex_ANOVA.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">afex is for ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_2-repeated_measures_anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Within Subjects / Repeated Measures ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_3-factorial_rma.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Factorial RM-ANOVA and simple effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_4-sphericity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Sphericity: Variances and Co-Variances</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_5-spss_rma.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Running a RM-ANOVA in SPSS</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#normality-assumption" id="toc-normality-assumption" class="nav-link active" data-scroll-target="#normality-assumption"><span class="toc-section-number">16</span>  Normality Assumption</a>
  <ul class="collapse">
<li><a href="#structure-of-this-vignette" id="toc-structure-of-this-vignette" class="nav-link" data-scroll-target="#structure-of-this-vignette"><span class="toc-section-number">16.1</span>  Structure of this vignette</a></li>
  <li>
<a href="#part-1-visual-assessment-tools" id="toc-part-1-visual-assessment-tools" class="nav-link" data-scroll-target="#part-1-visual-assessment-tools"><span class="toc-section-number">16.2</span>  Part 1: Visual assessment tools</a>
  <ul class="collapse">
<li><a href="#histogram-plot" id="toc-histogram-plot" class="nav-link" data-scroll-target="#histogram-plot"><span class="toc-section-number">16.2.1</span>  Histogram plot</a></li>
  <li><a href="#quantile-quantile-plots" id="toc-quantile-quantile-plots" class="nav-link" data-scroll-target="#quantile-quantile-plots"><span class="toc-section-number">16.2.2</span>  Quantile-quantile plots</a></li>
  </ul>
</li>
  <li>
<a href="#measures-of-skew-and-kurtosis" id="toc-measures-of-skew-and-kurtosis" class="nav-link" data-scroll-target="#measures-of-skew-and-kurtosis"><span class="toc-section-number">16.3</span>  Measures of skew and kurtosis</a>
  <ul class="collapse">
<li><a href="#using-the-non-transformed-values" id="toc-using-the-non-transformed-values" class="nav-link" data-scroll-target="#using-the-non-transformed-values"><span class="toc-section-number">16.3.1</span>  using the non-transformed values</a></li>
  <li><a href="#using-the-standardized-values" id="toc-using-the-standardized-values" class="nav-link" data-scroll-target="#using-the-standardized-values"><span class="toc-section-number">16.3.2</span>  using the standardized values</a></li>
  <li><a href="#using-a-bootstrapped-standard-errors-recommended" id="toc-using-a-bootstrapped-standard-errors-recommended" class="nav-link" data-scroll-target="#using-a-bootstrapped-standard-errors-recommended"><span class="toc-section-number">16.3.3</span>  using a bootstrapped standard errors (recommended)</a></li>
  </ul>
</li>
  <li>
<a href="#significance-tests" id="toc-significance-tests" class="nav-link" data-scroll-target="#significance-tests"><span class="toc-section-number">16.4</span>  Significance Tests</a>
  <ul class="collapse">
<li><a href="#shapiro-wilks" id="toc-shapiro-wilks" class="nav-link" data-scroll-target="#shapiro-wilks"><span class="toc-section-number">16.4.1</span>  Shapiro-Wilks</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">
<span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The normal distribution</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>This vignette uses the following packages:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">car</span>, <span class="va">SimDesign</span>, <span class="va">regclass</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="normality-assumption" class="level1" data-number="16"><h1 data-number="16">
<span class="header-section-number">16</span> Normality Assumption</h1>
<p>In class we discussed that one of the first and important steps when taking a look at your data is to assess whether the data conform to the assumptions of your analysis of choice. For most parametric tests (e.g., regression, t-tests, ANOVA families), one of the key assumptions is that scores of your dependent variable(s) approximate some known distribution. The distribution that gets the most play in this course is the normal distribution. That said, real world data, especially from the social sciences, is rarely perfectly normal, but rather “normal enough” to proceed with parametric tests. With this in mind, there are other distributions that are important to know about, including the binomial, Poisson, and exponential distributions that may more readly approximate your data. We’ll discuss these in class when the time comes. For now, we’ll focus on the normal distribution.</p>
<p>In the interest of having a unified resource, I’m putting together a brief vignette highlighting methods for assessing whether your data is normal or not. I stress the word “assess” and not “test” for reasons that will be made apparent below. My best advice is to take several tools to make the decision of whether your data is normal or not.</p>
<p>In brief there are three “tools” for assessment:</p>
<ol type="1">
<li>plotting your data using histograms and QQ-plots</li>
<li>evaluating measures of skew and kurtosis</li>
<li>significance tests for normality</li>
</ol>
<p>It may be temping to believe that #3, significance testing, would be a magic bullet. However, many (including Field, Section 5.6, we need to be cautious with tests like Kolmorogorov and Shapiro-Wilks. In my own practice, I typically use them last in the case of extreme ambiguity, but more often to confirm what I already believe (journals like “tests to confirm”).</p>
<p><strong>Before reaching your conclusion you should employ multiple methods!!</strong></p>
<section id="structure-of-this-vignette" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="structure-of-this-vignette">
<span class="header-section-number">16.1</span> Structure of this vignette</h2>
<p>In the first half of this vignette I’ll discuss how to apply each of these tests in their most general form. In the interest of time, in cases where these methods are discussed in your textbooks I will point there. When warranted, I’ll offer additional exposition.</p>
<p>In the second half of this vignette I’ll outline use cases for several of the scenarios that we will encounter this semester, offering tips and code templates for how to address each scenario. <strong>This will be populated in upcoming weeks</strong></p>
<p>Before we start, let’s generate a <code>normal_sample</code> of 60 observations that we know will be approximately normal and a positively skewed distribution <code>skewed_sample</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">920</span><span class="op">)</span></span>
<span><span class="co"># create a normal distribution mean 25, sd = 5</span></span>
<span><span class="va">normal_sample</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="st">"observation"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                        <span class="st">"score"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">25</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a skewed distribution using SimDesign package</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="st">"SimDesign"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">920</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">skewed_sample</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">tibble</span><span class="op">(</span><span class="st">"observation"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>          <span class="st">"score"</span> <span class="op">=</span> <span class="fu">SimDesign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SimDesign/man/rValeMaurelli.html">rValeMaurelli</a></span><span class="op">(</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">25</span>, sigma<span class="op">=</span><span class="fl">5</span>, skew<span class="op">=</span><span class="fl">1.8</span>,</span>
<span>                                             kurt<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="part-1-visual-assessment-tools" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="part-1-visual-assessment-tools">
<span class="header-section-number">16.2</span> Part 1: Visual assessment tools</h2>
<p>I can’t say it enough, one of the first things to do is plot your data. On of the first plots you should generate is a plot of the distribution of your variables as they fit within your design (more on this in Part 2). You friends here are the histogram plot and the QQ-plot.</p>
<section id="histogram-plot" class="level3" data-number="16.2.1"><h3 data-number="16.2.1" class="anchored" data-anchor-id="histogram-plot">
<span class="header-section-number">16.2.1</span> Histogram plot</h3>
<p>A histogram plot is simply a plot of the distribution of score. Typically this takes the form of the number, or raw count) of scores within a number of preset bin (sizes), but can also take the form of the density, or proportion of scores. You’ll need to create a density plot to overlay with a normal curve (a least using <code>ggplot</code>). I’ll revisit the basics here, but the last 2 plot examples here are most useful to you.</p>
<section id="what-to-look-for" class="level4" data-number="16.2.1.1"><h4 data-number="16.2.1.1" class="anchored" data-anchor-id="what-to-look-for">
<span class="header-section-number">16.2.1.1</span> What to look for</h4>
<p>The degree to which your data are (1) asymmetrical around the mean and median and (2) fits with a theoretical normal curve with the same <code>mean</code> and <code>sd</code> parameters.</p>
</section><section id="basic-histogram-raw-counts" class="level4" data-number="16.2.1.2"><h4 data-number="16.2.1.2" class="anchored" data-anchor-id="basic-histogram-raw-counts">
<span class="header-section-number">16.2.1.2</span> Basic histogram (raw counts)</h4>
<p>Using <code>ggplot</code> we’ll plot a histogram of the counts of scores, placing vertical lines at the mean and median scores:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">normal_sample</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A good rule of thumb is to overlay the plot with a normal curve (theoretical distribution). The easiest way to do this is to transform your count histogram into a proportion, or density, histogram first:</p>
</section><section id="density-histogram-proportions" class="level4" data-number="16.2.1.3"><h4 data-number="16.2.1.3" class="anchored" data-anchor-id="density-histogram-proportions">
<span class="header-section-number">16.2.1.3</span> Density histogram (proportions)</h4>
<p>To get a histogram with proportions instead of raw values, you simply add <code>aes(y=..density..)</code> to <code>geom_histogram()</code></p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">normal_sample</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 <span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span> <span class="co"># turns raw scores to proportions</span></span>
<span>                 <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="histogram-with-normal-curve-overlay" class="level4" data-number="16.2.1.4"><h4 data-number="16.2.1.4" class="anchored" data-anchor-id="histogram-with-normal-curve-overlay">
<span class="header-section-number">16.2.1.4</span> Histogram with normal curve overlay</h4>
<p>To overlay a normal curve we need to add <code>stat_function</code> to our <code>ggplot</code>. Note that the arguments are essentially running a <code>dnorm</code> with a unit <code>mean</code> and <code>sd</code> from our scores. If we are simply adding the normal curve to a density plot we add the following:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create a density plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">normal_sample</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 <span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span> <span class="co"># turns raw scores to proportions</span></span>
<span>                 <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, <span class="co"># generate theoretical norm data</span></span>
<span>                  color <span class="op">=</span> <span class="st">"red"</span>, <span class="co"># color the line red</span></span>
<span>                  args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>                    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="co"># build around mean</span></span>
<span>                    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># st dev parameter</span></span>
<span>                    <span class="op">)</span></span>
<span>                  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="density-curve-with-with-normal-curve-overlay" class="level4" data-number="16.2.1.5"><h4 data-number="16.2.1.5" class="anchored" data-anchor-id="density-curve-with-with-normal-curve-overlay">
<span class="header-section-number">16.2.1.5</span> Density curve with with normal curve overlay</h4>
<p>Note that it may actually be simpler to simply create a density curve of the data and overlay it with a normal curve. The resulting plot is a smooth-function interpretation of the distribution of the data:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create a raw plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">normal_sample</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, <span class="co"># generate theoretical norm data</span></span>
<span>                  color <span class="op">=</span> <span class="st">"red"</span>, <span class="co"># color the line red</span></span>
<span>                  args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>                    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="co"># build around mean</span></span>
<span>                    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># st dev parameter</span></span>
<span>                    <span class="op">)</span></span>
<span>                  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Density curve plot"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"black = real data; red = hypothetical normal curve"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="non-normal-example" class="level4" data-number="16.2.1.6"><h4 data-number="16.2.1.6" class="anchored" data-anchor-id="non-normal-example">
<span class="header-section-number">16.2.1.6</span> Non-normal example</h4>
<p>I’m going to recreate the density histogram using the <code>skewed_sample</code> to give you a feel for what this looks like.</p>
<p>Recall that we generated the skewed sample using:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">skewed_sample</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">tibble</span><span class="op">(</span><span class="st">"observation"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>          <span class="st">"score"</span> <span class="op">=</span> <span class="fu">SimDesign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SimDesign/man/rValeMaurelli.html">rValeMaurelli</a></span><span class="op">(</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">25</span>, sigma<span class="op">=</span><span class="fl">5</span>, skew<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>                                             kurt<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visually:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create a raw plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">skewed_sample</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, <span class="co"># generate theoretical norm data</span></span>
<span>                  color <span class="op">=</span> <span class="st">"red"</span>, <span class="co"># color the line red</span></span>
<span>                  args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>                    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="co"># build around mean</span></span>
<span>                    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>,na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># st dev parameter</span></span>
<span>                    <span class="op">)</span></span>
<span>                  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Density curve plot"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"black = real data; red = hypothetical normal curve"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Again, notice how the data are both shifted and do not cleanly fit with the normal curve.</p>
</section></section><section id="quantile-quantile-plots" class="level3" data-number="16.2.2"><h3 data-number="16.2.2" class="anchored" data-anchor-id="quantile-quantile-plots">
<span class="header-section-number">16.2.2</span> Quantile-quantile plots</h3>
<p>Normality can also be visually assessed using a <strong>quantile-quantile plot</strong>. A quantile-quantile plot compares raw scores with theoretical scores that assume a normal distribution. If both are roughly equal then the result should be that the points fall along a line of equality (qq-line). In a <strong>quantile-quantile plot</strong> deviations from the line indicate deviations from normality.</p>
<section id="what-to-look-for-1" class="level4" data-number="16.2.2.1"><h4 data-number="16.2.2.1" class="anchored" data-anchor-id="what-to-look-for-1">
<span class="header-section-number">16.2.2.1</span> What to look for</h4>
<p>A large number of significant deviations (outside the bands) is a hint that the data is non-normal. <a href="https://stats.stackexchange.com/a/101290">This link on CrossValidated</a> is pretty good in terms of interpreting Q-Q plots. Note that for more stringent criteria one can take a look at the correlation between the raw sample data and the theoretical normed data.</p>
</section><section id="basic-qqplot" class="level4" data-number="16.2.2.2"><h4 data-number="16.2.2.2" class="anchored" data-anchor-id="basic-qqplot">
<span class="header-section-number">16.2.2.2</span> Basic qqplot</h4>
<p>There are several ways to put together a QQ-plot; my preferred are (1) using the <code><a href="https://rdrr.io/pkg/car/man/qqPlot.html">car::qqPlot</a></code> function when just taking a quick look; (2) using <code>ggplot</code> when I need something “publication worthy” or when I’m conducting more complex analysis. A third method that I’ll used here <code><a href="https://rdrr.io/pkg/regclass/man/qq.html">regclass::qq</a></code> is useful as a learning example.</p>
<p>First, lets take a look at <code>normal_sample$score</code> using <code><a href="https://rdrr.io/pkg/car/man/qqPlot.html">car::qqPlot</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span>, distribution<span class="op">=</span><span class="st">"norm"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 92 12</code></pre>
</div>
</div>
<p>This produces a QQ-plot with a confidence envelope based on the SEs of the order statistics of an independent random sample from the comparison distribution (see Fox 2016, Applied Regression Analysis and Generalized Linear Models, Chapter 12). The highlighted observations, in this case <code>12</code> and <code>92</code> are the 2 scores with the largest model residuals—in this case deviation from the mean, but we can through linear model outputs into this function (see Week 6 of class: Modeling with continuous predictors / simple regression)</p>
<p>The x-values are the normed quantiles, while the y-values are our actual raw scores. The normed quantiles values are essentially normed stand-ins for “what the raw values should be if the data was normal. To demonstrate this let’s use the <code>regclass:qq</code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">regclass</span><span class="op">)</span></span>
<span><span class="fu">regclass</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/regclass/man/qq.html">qq</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As you can see this is the exact same plot. We typically focus on the quantile values as they allow us to better compare data across different distributions.</p>
<p>Taking a look both our <code>normal_sample</code> and <code>skewed_sample</code>.</p>
<p>Finally we can use <code>ggplot</code> to construct better looking plots.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">normal_sample</span>, <span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_qq_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">skewed_sample</span>, <span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_qq_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="advanced-qqplot-with-95-ci-bands" class="level4" data-number="16.2.2.3"><h4 data-number="16.2.2.3" class="anchored" data-anchor-id="advanced-qqplot-with-95-ci-bands">
<span class="header-section-number">16.2.2.3</span> Advanced qqplot with 95% CI bands</h4>
<p>We can also create bands around these plots using the <code>qqplotr</code> library in conjuction with <code>ggplot</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">qqplotr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">normal_sample</span>, <span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_qq_band</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">skewed_sample</span>, <span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_qq_band</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4_1-the_normal_distribution_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="advanced-qq-plot-correlation" class="level4" data-number="16.2.2.4"><h4 data-number="16.2.2.4" class="anchored" data-anchor-id="advanced-qq-plot-correlation">
<span class="header-section-number">16.2.2.4</span> Advanced qq-plot &amp; correlation</h4>
<p>** note that some of what you see here may not be covered until our Week 6 discussion on correlation.</p>
<p>I usually stop with visual inspection, BUT if you want to be more rigorous, you can take the data from the <code>qq_plot</code> can measure the correlation, <span class="math inline">\(r\)</span> between the actual <code>sample</code> distribution and the <code>theoretical</code> distribution that make up the <code>qqplot</code>. Keep in mind that under a perfectly ideal situation the <code>sample</code> distribution should equal the <code>theoretical</code> distribution resulting in <span class="math inline">\(r = 1\)</span> (and all points falling along the <code>qq_line</code>). Thus, deviations away from 1 tell us how “off” this fit is, where lower <span class="math inline">\(r\)</span> values indicate poorer fits between <code>sample</code> and <code>theoretical</code>.</p>
<p>First, let’s recreate the plot:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">norm_qq_qplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">normal_sample</span>, <span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_qq_band</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data used to create the plot can be extracted from our <code>ggplot</code> using <code>ggplot_build</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># run this, this prints out a lot in the console!!!</span></span>
<span><span class="co"># you may need to scroll up</span></span>
<span><span class="fu">ggplot_build</span><span class="op">(</span><span class="va">norm_qq_qplot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you can see <code>ggplot_build</code> pulls several list items related to the construction of the plot. From this list we are most concerned with <code>$data[[2]]</code> which contains the <code>sample</code> and <code>theoretical</code> values uses to populate the <code>x</code> and <code>y</code> axes of the plot. From here we can save the data from <code>ggplot_build</code> to an object and get the correlation between <code>sample</code> and <code>theoretical</code>. You’ll note I didn’t use <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> as I’m not interested in how far away from 0 I am (the null hypothesis of <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code>). Take from that what you will.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">qq_plot_data</span> <span class="op">&lt;-</span> <span class="fu">ggplot_build</span><span class="op">(</span><span class="va">norm_qq_qplot</span><span class="op">)</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">cor_qq_Normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">qq_plot_data</span><span class="op">$</span><span class="va">sample</span>,<span class="va">qq_plot_data</span><span class="op">$</span><span class="va">theoretical</span><span class="op">)</span></span>
<span><span class="va">cor_qq_Normal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9922899</code></pre>
</div>
</div>
<p>If we wanted to be extra judicious we could then compare this value against a correlation of 1:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cor_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">qq_plot_data</span><span class="op">$</span><span class="va">sample</span>,<span class="va">qq_plot_data</span><span class="op">$</span><span class="va">theoretical</span><span class="op">)</span></span>
<span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/FisherZ.html">FisherZ</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">cor_norm</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5030759</code></pre>
</div>
</div>
<p>Compare this value to the <code>skewed_sample</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">skew_qq_qplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">skewed_sample</span>, <span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_qq_band</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stat_qq_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qq_plot_data</span> <span class="op">&lt;-</span> <span class="fu">ggplot_build</span><span class="op">(</span><span class="va">skew_qq_qplot</span><span class="op">)</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">qq_plot_data</span><span class="op">$</span><span class="va">sample</span>,<span class="va">qq_plot_data</span><span class="op">$</span><span class="va">theoretical</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9453017</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cor_skew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">qq_plot_data</span><span class="op">$</span><span class="va">sample</span>,<span class="va">qq_plot_data</span><span class="op">$</span><span class="va">theoretical</span><span class="op">)</span></span>
<span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/FisherZ.html">FisherZ</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">cor_skew</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5218324</code></pre>
</div>
</div>
</section></section></section><section id="measures-of-skew-and-kurtosis" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="measures-of-skew-and-kurtosis">
<span class="header-section-number">16.3</span> Measures of skew and kurtosis</h2>
<p>Measures of <code>skew</code> and <code>kurtosis</code> may be obtained using the <code><a href="https://rdrr.io/pkg/psych/man/describe.html">psych::describe()</a></code> function. There is some debate concerning the interpretation of these values. First let’s obtain <code>skew</code> and <code>kurtosis</code> using the <code><a href="https://rdrr.io/pkg/psych/man/describe.html">psych::describe()</a></code> function. From here well walk-though the specifics of what these values are and how to interpret them (and limitations). I’ll finally offer a recommendation I’ll point you in the direction of several resources in this debate as well as summarize key issues as I see them.</p>
<p>First <code>normal_sample</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">psych</span><span class="op">)</span></span>
<span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.html">describe</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span>, type<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars   n  mean   sd median trimmed  mad   min   max range skew kurtosis   se
X1    1 100 25.04 5.22  24.77   24.84 5.15 11.46 36.39 24.93 0.15    -0.35 0.52</code></pre>
</div>
</div>
<p>Alternatively, you can call <code>skew()</code> and <code>kurtosi()</code> seperately:</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span> <span class="op">%&gt;%</span> <span class="fu">skew</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1451337</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span> <span class="op">%&gt;%</span> <span class="fu">kurtosi</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.4427668</code></pre>
</div>
</div>
<p>Now <code>skewed_sample</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.html">describe</a></span><span class="op">(</span><span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars   n mean   sd median trimmed  mad   min  max range skew kurtosis   se
X1    1 100 24.9 2.11  24.55    24.6 2.21 22.62 31.9  9.28 1.09     0.76 0.21</code></pre>
</div>
</div>
<section id="using-the-non-transformed-values" class="level3" data-number="16.3.1"><h3 data-number="16.3.1" class="anchored" data-anchor-id="using-the-non-transformed-values">
<span class="header-section-number">16.3.1</span> using the non-transformed values</h3>
<p>The values of skew and kurtosis are calculated using the three types outlined by Joanes and Gill (1998) <a href="https://www.jstor.org/stable/2988433">here</a>. By default, for <code><a href="https://rdrr.io/pkg/psych/man/describe.html">psych::describe()</a></code>, <code>type=3</code>, which corresponds to <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> from Joanes and Gill. Note that <code>type=2</code> corresponds to the values obtained using SPSS. For the purposes of comparison we will use <code>type=2</code>, though note that each (<code>type=2</code> or <code>type=3</code>) has its advantages, see Joanes and Gill, 1998 for more detail. As relayed by Kim (2013) <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3591587/">here</a>, if one wants to assess skew and kurtosis based upon these raw values, then any value &gt; 2 for skew or &gt; 4 for kurtosis should be viewed as suspect.</p>
</section><section id="using-the-standardized-values" class="level3" data-number="16.3.2"><h3 data-number="16.3.2" class="anchored" data-anchor-id="using-the-standardized-values">
<span class="header-section-number">16.3.2</span> using the standardized values</h3>
<p>However, as Kim notes, one can apply a test of standardized test for normality by dividing the skew and kurtosis by their respective standard errors. Note that SPSS will provide you with this standard error estimate. <code>R</code> by default does not. You may elect to replicate the SPSS method, again based on <code>type=2</code> calculations, by importing the function found below (taken from <a href="http://www.stat.cmu.edu/~hseltman/files/spssSkewKurtosis.R">Howard Seltman, here</a>). Once you have imported the function <code>spssSkewKurtosis</code> you can simply call <code>spssSkewKurtosis(vector)</code>. For example, with <code>skewed_sample</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Skewness and kurtosis and their standard errors as implemented by SPSS</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># Reference: pp 451-452 of</span></span>
<span><span class="co"># http://support.spss.com/ProductsExt/SPSS/Documentation/Manuals/16.0/SPSS 16.0 Algorithms.pdf</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># See also: Suggestion for Using Powerful and Informative Tests of Normality,</span></span>
<span><span class="co"># Ralph B. D'Agostino, Albert Belanger, Ralph B. D'Agostino, Jr.,</span></span>
<span><span class="co"># The American Statistician, Vol. 44, No. 4 (Nov., 1990), pp. 316-321</span></span>
<span></span>
<span><span class="va">spssSkewKurtosis</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">w</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">m1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">m2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">m1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">m3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">m1</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">m4</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">m1</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="va">s1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">skew</span><span class="op">=</span><span class="va">w</span><span class="op">*</span><span class="va">m3</span><span class="op">/</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">s1</span><span class="op">^</span><span class="fl">3</span></span>
<span>  <span class="va">sdskew</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="fl">6</span><span class="op">*</span><span class="va">w</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">kurtosis</span><span class="op">=</span><span class="op">(</span><span class="va">w</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">m4</span> <span class="op">-</span> <span class="fl">3</span><span class="op">*</span><span class="va">m2</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="va">s1</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="va">sdkurtosis</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="fl">4</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">^</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">sdskew</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">w</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">w</span><span class="op">+</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">skew</span>,<span class="va">kurtosis</span>, <span class="va">sdskew</span>,<span class="va">sdkurtosis</span><span class="op">)</span>, <span class="fl">2</span>,</span>
<span>        dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"skew"</span>,<span class="st">"kurtosis"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"estimate"</span>,<span class="st">"se"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># skewed_sample</span></span>
<span><span class="fu">spssSkewKurtosis</span><span class="op">(</span><span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          estimate        se
skew     1.0902510 0.2413798
kurtosis 0.7607103 0.4783311</code></pre>
</div>
</div>
<p>Also note that you can source this custom code to your environment whenever you want using:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># I typically source files in the first chunk as well</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"http://www.stat.cmu.edu/~hseltman/files/spssSkewKurtosis.R"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From here we could divide each <code>estimate</code> by their <code>se</code> and apply the critical values as recommended by Kim:</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">spssSkewKurtosis</span><span class="op">(</span><span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span></span>
<span>  <span class="fu">spssSkewKurtosis</span><span class="op">(</span><span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    skew kurtosis 
4.516745 1.590342 </code></pre>
</div>
</div>
<p>According to Kim:</p>
<ul>
<li>if <span class="math inline">\(N\)</span> &lt; 50, any value over 1.96</li>
<li>if (50 &lt; <span class="math inline">\(N\)</span> &lt; 300), any value over 3.29</li>
<li>if <span class="math inline">\(N\)</span> &gt; 300, no transform: any value of 2 for skew and 4 for kurtosis.</li>
</ul>
<p>Both skew and kurtosis fail the normal test. Compare this to <code>normal_sample</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">spssSkewKurtosis</span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span></span>
<span>  <span class="fu">spssSkewKurtosis</span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      skew   kurtosis 
 0.6197350 -0.7288419 </code></pre>
</div>
</div>
<p>Both absolute values are below 3.29.</p>
</section><section id="using-a-bootstrapped-standard-errors-recommended" class="level3" data-number="16.3.3"><h3 data-number="16.3.3" class="anchored" data-anchor-id="using-a-bootstrapped-standard-errors-recommended">
<span class="header-section-number">16.3.3</span> using a bootstrapped standard errors (recommended)</h3>
<p>There is a caveat to the test method from the previous section. The standard errors calculated above work for normal distributions, but not for other distributions. Obviously this is a problem, as by definition we are using the above method, including the standard errors, to test for non-normality. If our distribution is non-normal, then the standard error that we are using to test for non-normality is suspect!! See <a href="https://rdrr.io/cran/DescTools/man/Skew.html">here</a> for a brief discussion. And a solution, <code>DescTools</code>!!</p>
<p>The solution involves bootstrapping the 95% confidence interval and estimating the standard error. <code><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">DescTools::Skew()</a></code> and <code><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">DescTools::Kurt()</a></code> both provide this option, using <code>ci.type="bca"</code>. This method is also recommended by Joanes and Gill. Note that here <code>method</code> refers to the <code>type</code> of skew and kurtosis calculation (again, keeping it <code>2</code> for the sake of consistency, although <code>3</code> is fine as well).</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">DescTools</span><span class="op">)</span></span>
<span><span class="co"># bootstrap with 1000 replications (R=1000)</span></span>
<span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Skew</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>, method <span class="op">=</span> <span class="fl">2</span>, ci.type <span class="op">=</span> <span class="st">"bca"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     skew    lwr.ci    upr.ci 
1.0902510 0.7315529 1.5456300 </code></pre>
</div>
</div>
<p>from here, the standard error may be estimated by taking the range of the bootstrapped confidence interval and dividing it by <code>3.92</code></p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bca_skew</span> <span class="op">&lt;-</span> <span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Skew</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>, method <span class="op">=</span> <span class="fl">2</span>, ci.type <span class="op">=</span> <span class="st">"bca"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ses</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bca_skew</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="va">bca_skew</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">3.92</span></span>
<span></span>
<span><span class="va">ses</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># unname simply removes the name</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2064468</code></pre>
</div>
</div>
<p>From here we can take the obtained <code>skew</code> and divide it by the standard error, <code>ses</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Skew</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>, ci.type <span class="op">=</span> <span class="st">"bca"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">ses</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    skew 
5.123651 </code></pre>
</div>
</div>
<p>Similar steps can be taken for kurtosis:</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bca_kurtosis</span> <span class="op">&lt;-</span> <span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Kurt</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>, ci.type <span class="op">=</span> <span class="st">"bca"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">ses</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bca_kurtosis</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">-</span><span class="va">bca_kurtosis</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">3.92</span></span>
<span></span>
<span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Kurt</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>, ci.type <span class="op">=</span> <span class="st">"bca"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">ses</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    kurt 
0.795541 </code></pre>
</div>
</div>
<p><strong>The logic of this.</strong> Consider that we have bootstrapped a distribution of skews and or kurtosi just as we have done in the past with means. From class we know that the <strong>standard error</strong> equals the standard deviation of this distribution. The 95% CI obtained from bootstrapping are equivalent to ±1.96 * the standard deviation. Therefore we can obtain the standard error by dividing the width of the 95% CI by 2 * 1.96 or 3.92.</p>
<p>Admittedly, coding this by hand is a bit of a chore, but the beauty of programming is that we can create our own functions for processes that we routinely perform.</p>
<p>In this case I want to input a vector like <code>skewed_sample$score</code> and have it return the bootstrapped <code>ses</code> and the resulting skew and kurtosis.</p>
<p>I’ll name this function <code>skew_kurtosis_ses</code>. Notice how I’m just taking the steps that I’ve performed before and wrapping them in the function:</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Skewness and kurtosis and their standard errors as determined </span></span>
<span><span class="co"># using boostrapped confidence intervals</span></span>
<span></span>
<span><span class="co"># Arguments:</span></span>
<span><span class="co">#   - x: vector of data you wish to analyze</span></span>
<span><span class="co">#   - calc_method: method of calculating skew and kurtosis, used by DescTools,                    defaults to "2"</span></span>
<span><span class="co">#   - calc_ci: how to derive conf. intervals, for DescTools, default "bca"</span></span>
<span><span class="co">#   - reps: How many bootstrap repetitions, recommend at least 1000</span></span>
<span></span>
<span><span class="co"># Result: a 2x2 matrix with standardized skew and kurtosis (z) </span></span>
<span><span class="co"># as well as critical values to compare against. </span></span>
<span></span>
<span><span class="co"># Values as recommended by Kim (2013) Statistical notes for clinical </span></span>
<span><span class="co"># researchers: assessing normal distribution (2) using skewness and kurtosis.</span></span>
<span></span>
<span></span>
<span><span class="va">skew_kurtosis_z</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">calc_method</span> <span class="op">=</span> <span class="fl">2</span>, <span class="va">calc_ci</span> <span class="op">=</span> <span class="st">"bca"</span>, <span class="va">reps</span> <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># get skew and kurt and their cis </span></span>
<span>  <span class="va">skew_ci</span> <span class="op">&lt;-</span> <span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Skew</a></span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="va">calc_method</span>, ci.type <span class="op">=</span> <span class="va">calc_ci</span>,</span>
<span>                             conf.level <span class="op">=</span> <span class="fl">0.95</span>, R <span class="op">=</span> <span class="va">reps</span><span class="op">)</span></span>
<span>  <span class="va">kurt_ci</span> <span class="op">&lt;-</span> <span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Kurt</a></span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="va">calc_method</span>, ci.type <span class="op">=</span> <span class="va">calc_ci</span>,</span>
<span>                             conf.level <span class="op">=</span> <span class="fl">0.95</span>, R <span class="op">=</span> <span class="va">reps</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># calculate ses from ci</span></span>
<span>  <span class="va">skew_ses</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">skew_ci</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">skew_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">3.92</span></span>
<span>  <span class="va">kurt_ses</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">kurt_ci</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">kurt_ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">3.92</span></span>
<span>  </span>
<span>  <span class="co"># calculate standardized valuess</span></span>
<span>  <span class="va">skew_z</span><span class="op">&lt;-</span> <span class="va">skew_ci</span><span class="op">/</span><span class="va">skew_ses</span> </span>
<span>  <span class="va">kurt_z</span><span class="op">&lt;-</span> <span class="va">kurt_ci</span><span class="op">/</span><span class="va">kurt_ses</span></span>
<span>  </span>
<span>  <span class="co"># remove names and ci columns</span></span>
<span>  <span class="va">skew_z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">skew_z</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">kurt_z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">kurt_z</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">skew_z</span>,<span class="va">kurt_z</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># what are the critical values?</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">crit_vals</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">N</span><span class="op">&lt;</span><span class="fl">50</span>, <span class="fl">1.96</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">N</span><span class="op">&lt;</span><span class="fl">300</span>, <span class="fl">3.29</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">values</span>,<span class="va">crit_vals</span><span class="op">)</span>,digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># round to 2 digits</span></span>
<span>  </span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now to test my function:</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">skew_kurtosis_z</span><span class="op">(</span>x <span class="op">=</span> <span class="va">skewed_sample</span><span class="op">$</span><span class="va">score</span>, calc_method <span class="op">=</span> <span class="fl">2</span>, calc_ci <span class="op">=</span> <span class="st">"bca"</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       values crit_vals
skew_z   5.49      3.29
kurt_z   0.98      3.29</code></pre>
</div>
</div>
<p>For those interested this function can be found on my github.com page, here, and sourced like so:</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/tehrandavis/PSYC7014/master/custom_functions/skew_kurtosis_z.R"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also save it to your own computer and source it from there as needed.</p>
<p>Keep in mind since we are bootstrapping from random selection your absolute magnitudes will vary.</p>
</section></section><section id="significance-tests" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="significance-tests">
<span class="header-section-number">16.4</span> Significance Tests</h2>
<section id="shapiro-wilks" class="level3" data-number="16.4.1"><h3 data-number="16.4.1" class="anchored" data-anchor-id="shapiro-wilks">
<span class="header-section-number">16.4.1</span> Shapiro-Wilks</h3>
<p>The formal normality tests including Shapiro-Wilks test may be used from small to medium sized samples (e.g., n &lt; 300), but may be unreliable for large samples. It outputs a test statistic <code>W</code> that is tested against deviations from 1. This can be run by:</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">normal_sample</span><span class="op">$</span><span class="va">score</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  normal_sample$score
W = 0.98327, p-value = 0.2369</code></pre>
</div>
</div>


<!-- -->

</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../week02/2_4-means_other_models.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Means and other models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Building intuitions about probability and NHST</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb56" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "The normal distribution"</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>This vignette uses the following packages:</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, car, SimDesign, regclass)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Normality Assumption</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>In class we discussed that one of the first and important steps when taking a look at your data is to assess whether the data conform to the assumptions of your analysis of choice. For most parametric tests (e.g., regression, t-tests, ANOVA families), one of the key assumptions is that scores of your dependent variable(s) approximate some known distribution. The distribution that gets the most play in this course is the normal distribution. That said, real world data, especially from the social sciences, is rarely perfectly normal, but rather "normal enough" to proceed with parametric tests. With this in mind, there are other distributions that are important to know about, including the binomial, Poisson, and exponential distributions that may more readly approximate your data. We'll discuss these in class when the time comes. For now, we'll focus on the normal distribution.</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>In the interest of having a unified resource, I'm putting together a brief vignette highlighting methods for assessing whether your data is normal or not. I stress the word "assess" and not "test" for reasons that will be made apparent below. My best advice is to take several tools to make the decision of whether your data is normal or not.</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>In brief there are three "tools" for assessment:</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>(1) plotting your data using histograms and QQ-plots</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>(2) evaluating measures of skew and kurtosis</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>(3) significance tests for normality</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>It may be temping to believe that #3, significance testing, would be a magic bullet. However, many (including Field, Section 5.6, we need to be cautious with tests like Kolmorogorov and Shapiro-Wilks. In my own practice, I typically use them last in the case of extreme ambiguity, but more often to confirm what I already believe (journals like "tests to confirm").</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>**Before reaching your conclusion you should employ multiple methods!!**</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structure of this vignette</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>In the first half of this vignette I'll discuss how to apply each of these tests in their most general form. In the interest of time, in cases where these methods are discussed in your textbooks I will point there. When warranted, I'll offer additional exposition.</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>In the second half of this vignette I'll outline use cases for several of the scenarios that we will encounter this semester, offering tips and code templates for how to address each scenario. **This will be populated in upcoming weeks**</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>Before we start, let's generate a <span class="in">`normal_sample`</span> of 60 observations that we know will be approximately normal and a positively skewed distribution <span class="in">`skewed_sample`</span>:</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">920</span>)</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a><span class="co"># create a normal distribution mean 25, sd = 5</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>normal_sample <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"observation"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"score"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>))</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a><span class="co"># create a skewed distribution using SimDesign package</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"SimDesign"</span>)</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">920</span>)</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>skewed_sample <span class="ot">&lt;-</span> </span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="st">"observation"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>          <span class="st">"score"</span> <span class="ot">=</span> SimDesign<span class="sc">::</span><span class="fu">rValeMaurelli</span>(<span class="dv">100</span>, <span class="at">mean=</span><span class="dv">25</span>, <span class="at">sigma=</span><span class="dv">5</span>, <span class="at">skew=</span><span class="fl">1.8</span>,</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">kurt=</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1: Visual assessment tools</span></span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>I can't say it enough, one of the first things to do is plot your data. On of the first plots you should generate is a plot of the distribution of your variables as they fit within your design (more on this in Part 2). You friends here are the histogram plot and the QQ-plot.</span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histogram plot</span></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>A histogram plot is simply a plot of the distribution of score. Typically this takes the form of the number, or raw count) of scores within a number of preset bin (sizes), but can also take the form of the density, or proportion of scores. You'll need to create a density plot to overlay with a normal curve (a least using <span class="in">`ggplot`</span>). I'll revisit the basics here, but the last 2 plot examples here are most useful to you.</span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What to look for</span></span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>The degree to which your data are (1) asymmetrical around the mean and median and (2) fits with a theoretical normal curve with the same <span class="in">`mean`</span> and <span class="in">`sd`</span> parameters.</span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Basic histogram (raw counts)</span></span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`ggplot`</span> we'll plot a histogram of the counts of scores, placing vertical lines at the mean and median scores:</span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_sample, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>,</span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(normal_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(normal_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a>A good rule of thumb is to overlay the plot with a normal curve (theoretical distribution). The easiest way to do this is to transform your count histogram into a proportion, or density, histogram first:</span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-87"><a href="#cb56-87" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Density histogram (proportions)</span></span>
<span id="cb56-88"><a href="#cb56-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-89"><a href="#cb56-89" aria-hidden="true" tabindex="-1"></a>To get a histogram with proportions instead of raw values, you simply add <span class="in">`aes(y=..density..)`</span> to <span class="in">`geom_histogram()`</span></span>
<span id="cb56-90"><a href="#cb56-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-93"><a href="#cb56-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-94"><a href="#cb56-94" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_sample, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb56-95"><a href="#cb56-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>,</span>
<span id="cb56-96"><a href="#cb56-96" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb56-97"><a href="#cb56-97" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-98"><a href="#cb56-98" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">y=</span>..density..) <span class="co"># turns raw scores to proportions</span></span>
<span id="cb56-99"><a href="#cb56-99" aria-hidden="true" tabindex="-1"></a>                 ) <span class="sc">+</span> </span>
<span id="cb56-100"><a href="#cb56-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(normal_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb56-101"><a href="#cb56-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(normal_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb56-102"><a href="#cb56-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-103"><a href="#cb56-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-104"><a href="#cb56-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-105"><a href="#cb56-105" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Histogram with normal curve overlay</span></span>
<span id="cb56-106"><a href="#cb56-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-107"><a href="#cb56-107" aria-hidden="true" tabindex="-1"></a>To overlay a normal curve we need to add <span class="in">`stat_function`</span> to our <span class="in">`ggplot`</span>. Note that the arguments are essentially running a <span class="in">`dnorm`</span> with a unit <span class="in">`mean`</span> and <span class="in">`sd`</span> from our scores. If we are simply adding the normal curve to a density plot we add the following:</span>
<span id="cb56-108"><a href="#cb56-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-111"><a href="#cb56-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-112"><a href="#cb56-112" aria-hidden="true" tabindex="-1"></a><span class="co"># create a density plot</span></span>
<span id="cb56-113"><a href="#cb56-113" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_sample, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb56-114"><a href="#cb56-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>,</span>
<span id="cb56-115"><a href="#cb56-115" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb56-116"><a href="#cb56-116" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-117"><a href="#cb56-117" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">y=</span>..density..) <span class="co"># turns raw scores to proportions</span></span>
<span id="cb56-118"><a href="#cb56-118" aria-hidden="true" tabindex="-1"></a>                 ) <span class="sc">+</span> </span>
<span id="cb56-119"><a href="#cb56-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(normal_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb56-120"><a href="#cb56-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(normal_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb56-121"><a href="#cb56-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="co"># generate theoretical norm data</span></span>
<span id="cb56-122"><a href="#cb56-122" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">"red"</span>, <span class="co"># color the line red</span></span>
<span id="cb56-123"><a href="#cb56-123" aria-hidden="true" tabindex="-1"></a>                  <span class="at">args=</span><span class="fu">list</span>(</span>
<span id="cb56-124"><a href="#cb56-124" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mean =</span> <span class="fu">mean</span>(normal_sample<span class="sc">$</span>score,<span class="at">na.rm =</span> T), <span class="co"># build around mean</span></span>
<span id="cb56-125"><a href="#cb56-125" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd =</span> <span class="fu">sd</span>(normal_sample<span class="sc">$</span>score,<span class="at">na.rm =</span> T) <span class="co"># st dev parameter</span></span>
<span id="cb56-126"><a href="#cb56-126" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb56-127"><a href="#cb56-127" aria-hidden="true" tabindex="-1"></a>                  ) <span class="sc">+</span></span>
<span id="cb56-128"><a href="#cb56-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-129"><a href="#cb56-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-130"><a href="#cb56-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-131"><a href="#cb56-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-132"><a href="#cb56-132" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Density curve with with normal curve overlay</span></span>
<span id="cb56-133"><a href="#cb56-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-134"><a href="#cb56-134" aria-hidden="true" tabindex="-1"></a>Note that it may actually be simpler to simply create a density curve of the data and overlay it with a normal curve. The resulting plot is a smooth-function interpretation of the distribution of the data:</span>
<span id="cb56-135"><a href="#cb56-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-138"><a href="#cb56-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-139"><a href="#cb56-139" aria-hidden="true" tabindex="-1"></a><span class="co"># create a raw plot</span></span>
<span id="cb56-140"><a href="#cb56-140" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_sample, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb56-141"><a href="#cb56-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb56-142"><a href="#cb56-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="co"># generate theoretical norm data</span></span>
<span id="cb56-143"><a href="#cb56-143" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">"red"</span>, <span class="co"># color the line red</span></span>
<span id="cb56-144"><a href="#cb56-144" aria-hidden="true" tabindex="-1"></a>                  <span class="at">args=</span><span class="fu">list</span>(</span>
<span id="cb56-145"><a href="#cb56-145" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mean =</span> <span class="fu">mean</span>(normal_sample<span class="sc">$</span>score,<span class="at">na.rm =</span> T), <span class="co"># build around mean</span></span>
<span id="cb56-146"><a href="#cb56-146" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd =</span> <span class="fu">sd</span>(normal_sample<span class="sc">$</span>score,<span class="at">na.rm =</span> T) <span class="co"># st dev parameter</span></span>
<span id="cb56-147"><a href="#cb56-147" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb56-148"><a href="#cb56-148" aria-hidden="true" tabindex="-1"></a>                  ) <span class="sc">+</span></span>
<span id="cb56-149"><a href="#cb56-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(normal_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb56-150"><a href="#cb56-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(normal_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb56-151"><a href="#cb56-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-152"><a href="#cb56-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Density curve plot"</span>,</span>
<span id="cb56-153"><a href="#cb56-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"black = real data; red = hypothetical normal curve"</span></span>
<span id="cb56-154"><a href="#cb56-154" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-155"><a href="#cb56-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-156"><a href="#cb56-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-157"><a href="#cb56-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-158"><a href="#cb56-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-159"><a href="#cb56-159" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Non-normal example</span></span>
<span id="cb56-160"><a href="#cb56-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-161"><a href="#cb56-161" aria-hidden="true" tabindex="-1"></a>I'm going to recreate the density histogram using the <span class="in">`skewed_sample`</span> to give you a feel for what this looks like.</span>
<span id="cb56-162"><a href="#cb56-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-163"><a href="#cb56-163" aria-hidden="true" tabindex="-1"></a>Recall that we generated the skewed sample using:</span>
<span id="cb56-164"><a href="#cb56-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-167"><a href="#cb56-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-168"><a href="#cb56-168" aria-hidden="true" tabindex="-1"></a>skewed_sample <span class="ot">&lt;-</span> </span>
<span id="cb56-169"><a href="#cb56-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="st">"observation"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb56-170"><a href="#cb56-170" aria-hidden="true" tabindex="-1"></a>          <span class="st">"score"</span> <span class="ot">=</span> SimDesign<span class="sc">::</span><span class="fu">rValeMaurelli</span>(<span class="dv">100</span>, <span class="at">mean=</span><span class="dv">25</span>, <span class="at">sigma=</span><span class="dv">5</span>, <span class="at">skew=</span><span class="fl">1.5</span>,</span>
<span id="cb56-171"><a href="#cb56-171" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">kurt=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb56-172"><a href="#cb56-172" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb56-173"><a href="#cb56-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-174"><a href="#cb56-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-175"><a href="#cb56-175" aria-hidden="true" tabindex="-1"></a>Visually:</span>
<span id="cb56-176"><a href="#cb56-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-179"><a href="#cb56-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-180"><a href="#cb56-180" aria-hidden="true" tabindex="-1"></a><span class="co"># create a raw plot</span></span>
<span id="cb56-181"><a href="#cb56-181" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(skewed_sample, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb56-182"><a href="#cb56-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb56-183"><a href="#cb56-183" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="co"># generate theoretical norm data</span></span>
<span id="cb56-184"><a href="#cb56-184" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">"red"</span>, <span class="co"># color the line red</span></span>
<span id="cb56-185"><a href="#cb56-185" aria-hidden="true" tabindex="-1"></a>                  <span class="at">args=</span><span class="fu">list</span>(</span>
<span id="cb56-186"><a href="#cb56-186" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mean =</span> <span class="fu">mean</span>(skewed_sample<span class="sc">$</span>score,<span class="at">na.rm =</span> T), <span class="co"># build around mean</span></span>
<span id="cb56-187"><a href="#cb56-187" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd =</span> <span class="fu">sd</span>(skewed_sample<span class="sc">$</span>score,<span class="at">na.rm =</span> T) <span class="co"># st dev parameter</span></span>
<span id="cb56-188"><a href="#cb56-188" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb56-189"><a href="#cb56-189" aria-hidden="true" tabindex="-1"></a>                  ) <span class="sc">+</span></span>
<span id="cb56-190"><a href="#cb56-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(skewed_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb56-191"><a href="#cb56-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(skewed_sample<span class="sc">$</span>score), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb56-192"><a href="#cb56-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-193"><a href="#cb56-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Density curve plot"</span>,</span>
<span id="cb56-194"><a href="#cb56-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"black = real data; red = hypothetical normal curve"</span></span>
<span id="cb56-195"><a href="#cb56-195" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-196"><a href="#cb56-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-197"><a href="#cb56-197" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-198"><a href="#cb56-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-199"><a href="#cb56-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-200"><a href="#cb56-200" aria-hidden="true" tabindex="-1"></a>Again, notice how the data are both shifted and do not cleanly fit with the normal curve.</span>
<span id="cb56-201"><a href="#cb56-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-202"><a href="#cb56-202" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quantile-quantile plots</span></span>
<span id="cb56-203"><a href="#cb56-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-204"><a href="#cb56-204" aria-hidden="true" tabindex="-1"></a>Normality can also be visually assessed using a **quantile-quantile plot**. A quantile-quantile plot compares raw scores with theoretical scores that assume a normal distribution. If both are roughly equal then the result should be that the points fall along a line of equality (qq-line). In a **quantile-quantile plot** deviations from the line indicate deviations from normality.</span>
<span id="cb56-205"><a href="#cb56-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-206"><a href="#cb56-206" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What to look for</span></span>
<span id="cb56-207"><a href="#cb56-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-208"><a href="#cb56-208" aria-hidden="true" tabindex="-1"></a>A large number of significant deviations (outside the bands) is a hint that the data is non-normal. <span class="co">[</span><span class="ot">This link on CrossValidated</span><span class="co">](https://stats.stackexchange.com/a/101290)</span> is pretty good in terms of interpreting Q-Q plots. Note that for more stringent criteria one can take a look at the correlation between the raw sample data and the theoretical normed data.</span>
<span id="cb56-209"><a href="#cb56-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-210"><a href="#cb56-210" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Basic qqplot</span></span>
<span id="cb56-211"><a href="#cb56-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-212"><a href="#cb56-212" aria-hidden="true" tabindex="-1"></a>There are several ways to put together a QQ-plot; my preferred are (1) using the <span class="in">`car::qqPlot`</span> function when just taking a quick look; (2) using <span class="in">`ggplot`</span> when I need something "publication worthy" or when I'm conducting more complex analysis. A third method that I'll used here <span class="in">`regclass::qq`</span> is useful as a learning example.</span>
<span id="cb56-213"><a href="#cb56-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-214"><a href="#cb56-214" aria-hidden="true" tabindex="-1"></a>First, lets take a look at <span class="in">`normal_sample$score`</span> using <span class="in">`car::qqPlot`</span>:</span>
<span id="cb56-215"><a href="#cb56-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-218"><a href="#cb56-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-219"><a href="#cb56-219" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb56-220"><a href="#cb56-220" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">qqPlot</span>(normal_sample<span class="sc">$</span>score, <span class="at">distribution=</span><span class="st">"norm"</span>)</span>
<span id="cb56-221"><a href="#cb56-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-222"><a href="#cb56-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-223"><a href="#cb56-223" aria-hidden="true" tabindex="-1"></a>This produces a QQ-plot with a confidence envelope based on the SEs of the order statistics of an independent random sample from the comparison distribution (see Fox 2016, Applied Regression Analysis and Generalized Linear Models, Chapter 12). The highlighted observations, in this case <span class="in">`12`</span> and <span class="in">`92`</span> are the 2 scores with the largest model residuals---in this case deviation from the mean, but we can through linear model outputs into this function (see Week 6 of class: Modeling with continuous predictors / simple regression)</span>
<span id="cb56-224"><a href="#cb56-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-225"><a href="#cb56-225" aria-hidden="true" tabindex="-1"></a>The x-values are the normed quantiles, while the y-values are our actual raw scores. The normed quantiles values are essentially normed stand-ins for "what the raw values should be if the data was normal. To demonstrate this let's use the <span class="in">`regclass:qq`</span> function:</span>
<span id="cb56-226"><a href="#cb56-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-229"><a href="#cb56-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-230"><a href="#cb56-230" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(regclass)</span>
<span id="cb56-231"><a href="#cb56-231" aria-hidden="true" tabindex="-1"></a>regclass<span class="sc">::</span><span class="fu">qq</span>(normal_sample<span class="sc">$</span>score)</span>
<span id="cb56-232"><a href="#cb56-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-233"><a href="#cb56-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-234"><a href="#cb56-234" aria-hidden="true" tabindex="-1"></a>As you can see this is the exact same plot. We typically focus on the quantile values as they allow us to better compare data across different distributions.</span>
<span id="cb56-235"><a href="#cb56-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-236"><a href="#cb56-236" aria-hidden="true" tabindex="-1"></a>Taking a look both our <span class="in">`normal_sample`</span> and <span class="in">`skewed_sample`</span>.</span>
<span id="cb56-237"><a href="#cb56-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-238"><a href="#cb56-238" aria-hidden="true" tabindex="-1"></a>Finally we can use <span class="in">`ggplot`</span> to construct better looking plots.</span>
<span id="cb56-239"><a href="#cb56-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-242"><a href="#cb56-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-243"><a href="#cb56-243" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_sample, <span class="fu">aes</span>(<span class="at">sample=</span>score)) <span class="sc">+</span> </span>
<span id="cb56-244"><a href="#cb56-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb56-245"><a href="#cb56-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-246"><a href="#cb56-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-247"><a href="#cb56-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-250"><a href="#cb56-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-251"><a href="#cb56-251" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(skewed_sample, <span class="fu">aes</span>(<span class="at">sample=</span>score)) <span class="sc">+</span> </span>
<span id="cb56-252"><a href="#cb56-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb56-253"><a href="#cb56-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-254"><a href="#cb56-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-255"><a href="#cb56-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-256"><a href="#cb56-256" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Advanced qqplot with 95% CI bands</span></span>
<span id="cb56-257"><a href="#cb56-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-258"><a href="#cb56-258" aria-hidden="true" tabindex="-1"></a>We can also create bands around these plots using the <span class="in">`qqplotr`</span> library in conjuction with <span class="in">`ggplot`</span>:</span>
<span id="cb56-259"><a href="#cb56-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-262"><a href="#cb56-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-263"><a href="#cb56-263" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(qqplotr)</span>
<span id="cb56-264"><a href="#cb56-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-265"><a href="#cb56-265" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_sample, <span class="fu">aes</span>(<span class="at">sample=</span>score)) <span class="sc">+</span> </span>
<span id="cb56-266"><a href="#cb56-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_band</span>(<span class="at">fill=</span><span class="st">"lightgray"</span>) <span class="sc">+</span> <span class="fu">stat_qq_point</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb56-267"><a href="#cb56-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-268"><a href="#cb56-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-269"><a href="#cb56-269" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(skewed_sample, <span class="fu">aes</span>(<span class="at">sample=</span>score)) <span class="sc">+</span> </span>
<span id="cb56-270"><a href="#cb56-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_band</span>(<span class="at">fill=</span><span class="st">"lightgray"</span>) <span class="sc">+</span> <span class="fu">stat_qq_point</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb56-271"><a href="#cb56-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-272"><a href="#cb56-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-273"><a href="#cb56-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-274"><a href="#cb56-274" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Advanced qq-plot &amp; correlation</span></span>
<span id="cb56-275"><a href="#cb56-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-276"><a href="#cb56-276" aria-hidden="true" tabindex="-1"></a><span class="sc">\*\*</span> note that some of what you see here may not be covered until our Week 6 discussion on correlation.</span>
<span id="cb56-277"><a href="#cb56-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-278"><a href="#cb56-278" aria-hidden="true" tabindex="-1"></a>I usually stop with visual inspection, BUT if you want to be more rigorous, you can take the data from the <span class="in">`qq_plot`</span> can measure the correlation, $r$ between the actual <span class="in">`sample`</span> distribution and the <span class="in">`theoretical`</span> distribution that make up the <span class="in">`qqplot`</span>. Keep in mind that under a perfectly ideal situation the <span class="in">`sample`</span> distribution should equal the <span class="in">`theoretical`</span> distribution resulting in $r = 1$ (and all points falling along the <span class="in">`qq_line`</span>). Thus, deviations away from 1 tell us how "off" this fit is, where lower $r$ values indicate poorer fits between <span class="in">`sample`</span> and <span class="in">`theoretical`</span>.</span>
<span id="cb56-279"><a href="#cb56-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-280"><a href="#cb56-280" aria-hidden="true" tabindex="-1"></a>First, let's recreate the plot:</span>
<span id="cb56-281"><a href="#cb56-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-284"><a href="#cb56-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-285"><a href="#cb56-285" aria-hidden="true" tabindex="-1"></a>norm_qq_qplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(normal_sample, <span class="fu">aes</span>(<span class="at">sample=</span>score)) <span class="sc">+</span> </span>
<span id="cb56-286"><a href="#cb56-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_band</span>(<span class="at">fill=</span><span class="st">"lightgray"</span>) <span class="sc">+</span> <span class="fu">stat_qq_point</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb56-287"><a href="#cb56-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-288"><a href="#cb56-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-289"><a href="#cb56-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-290"><a href="#cb56-290" aria-hidden="true" tabindex="-1"></a>The data used to create the plot can be extracted from our <span class="in">`ggplot`</span> using <span class="in">`ggplot_build`</span>.</span>
<span id="cb56-291"><a href="#cb56-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-292"><a href="#cb56-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb56-293"><a href="#cb56-293" aria-hidden="true" tabindex="-1"></a><span class="co"># run this, this prints out a lot in the console!!!</span></span>
<span id="cb56-294"><a href="#cb56-294" aria-hidden="true" tabindex="-1"></a><span class="co"># you may need to scroll up</span></span>
<span id="cb56-295"><a href="#cb56-295" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot_build</span>(norm_qq_qplot)</span>
<span id="cb56-296"><a href="#cb56-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-297"><a href="#cb56-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-298"><a href="#cb56-298" aria-hidden="true" tabindex="-1"></a>As you can see <span class="in">`ggplot_build`</span> pulls several list items related to the construction of the plot. From this list we are most concerned with <span class="in">`$data[[2]]`</span> which contains the <span class="in">`sample`</span> and <span class="in">`theoretical`</span> values uses to populate the <span class="in">`x`</span> and <span class="in">`y`</span> axes of the plot. From here we can save the data from <span class="in">`ggplot_build`</span> to an object and get the correlation between <span class="in">`sample`</span> and <span class="in">`theoretical`</span>. You'll note I didn't use <span class="in">`cor.test()`</span> as I'm not interested in how far away from 0 I am (the null hypothesis of <span class="in">`cor.test()`</span>). Take from that what you will.</span>
<span id="cb56-299"><a href="#cb56-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-302"><a href="#cb56-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-303"><a href="#cb56-303" aria-hidden="true" tabindex="-1"></a>qq_plot_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(norm_qq_qplot)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb56-304"><a href="#cb56-304" aria-hidden="true" tabindex="-1"></a>cor_qq_Normal <span class="ot">&lt;-</span> <span class="fu">cor</span>(qq_plot_data<span class="sc">$</span>sample,qq_plot_data<span class="sc">$</span>theoretical)</span>
<span id="cb56-305"><a href="#cb56-305" aria-hidden="true" tabindex="-1"></a>cor_qq_Normal</span>
<span id="cb56-306"><a href="#cb56-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-307"><a href="#cb56-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-308"><a href="#cb56-308" aria-hidden="true" tabindex="-1"></a>If we wanted to be extra judicious we could then compare this value against a correlation of 1:</span>
<span id="cb56-309"><a href="#cb56-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-312"><a href="#cb56-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-313"><a href="#cb56-313" aria-hidden="true" tabindex="-1"></a>cor_norm <span class="ot">&lt;-</span> <span class="fu">cor</span>(qq_plot_data<span class="sc">$</span>sample,qq_plot_data<span class="sc">$</span>theoretical)</span>
<span id="cb56-314"><a href="#cb56-314" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">FisherZ</span>(<span class="dv">1</span><span class="sc">-</span>cor_norm) <span class="sc">%&gt;%</span> <span class="fu">pnorm</span>()</span>
<span id="cb56-315"><a href="#cb56-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-316"><a href="#cb56-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-317"><a href="#cb56-317" aria-hidden="true" tabindex="-1"></a>Compare this value to the <span class="in">`skewed_sample`</span>:</span>
<span id="cb56-318"><a href="#cb56-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-321"><a href="#cb56-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-322"><a href="#cb56-322" aria-hidden="true" tabindex="-1"></a>skew_qq_qplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(skewed_sample, <span class="fu">aes</span>(<span class="at">sample=</span>score)) <span class="sc">+</span> </span>
<span id="cb56-323"><a href="#cb56-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_band</span>(<span class="at">fill=</span><span class="st">"lightgray"</span>) <span class="sc">+</span> <span class="fu">stat_qq_point</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb56-324"><a href="#cb56-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb56-325"><a href="#cb56-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-326"><a href="#cb56-326" aria-hidden="true" tabindex="-1"></a>qq_plot_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(skew_qq_qplot)<span class="sc">$</span>data[[<span class="dv">2</span>]]</span>
<span id="cb56-327"><a href="#cb56-327" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(qq_plot_data<span class="sc">$</span>sample,qq_plot_data<span class="sc">$</span>theoretical)</span>
<span id="cb56-328"><a href="#cb56-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-329"><a href="#cb56-329" aria-hidden="true" tabindex="-1"></a>cor_skew <span class="ot">&lt;-</span> <span class="fu">cor</span>(qq_plot_data<span class="sc">$</span>sample,qq_plot_data<span class="sc">$</span>theoretical)</span>
<span id="cb56-330"><a href="#cb56-330" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">FisherZ</span>(<span class="dv">1</span><span class="sc">-</span>cor_skew) <span class="sc">%&gt;%</span> <span class="fu">pnorm</span>()</span>
<span id="cb56-331"><a href="#cb56-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-332"><a href="#cb56-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-333"><a href="#cb56-333" aria-hidden="true" tabindex="-1"></a><span class="fu">## Measures of skew and kurtosis</span></span>
<span id="cb56-334"><a href="#cb56-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-335"><a href="#cb56-335" aria-hidden="true" tabindex="-1"></a>Measures of <span class="in">`skew`</span> and <span class="in">`kurtosis`</span> may be obtained using the <span class="in">`psych::describe()`</span> function. There is some debate concerning the interpretation of these values. First let's obtain <span class="in">`skew`</span> and <span class="in">`kurtosis`</span> using the <span class="in">`psych::describe()`</span> function. From here well walk-though the specifics of what these values are and how to interpret them (and limitations). I'll finally offer a recommendation I'll point you in the direction of several resources in this debate as well as summarize key issues as I see them.</span>
<span id="cb56-336"><a href="#cb56-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-337"><a href="#cb56-337" aria-hidden="true" tabindex="-1"></a>First <span class="in">`normal_sample`</span>:</span>
<span id="cb56-338"><a href="#cb56-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-341"><a href="#cb56-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-342"><a href="#cb56-342" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(psych)</span>
<span id="cb56-343"><a href="#cb56-343" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(normal_sample<span class="sc">$</span>score, <span class="at">type=</span><span class="dv">2</span>)</span>
<span id="cb56-344"><a href="#cb56-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-345"><a href="#cb56-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-346"><a href="#cb56-346" aria-hidden="true" tabindex="-1"></a>Alternatively, you can call <span class="in">`skew()`</span> and <span class="in">`kurtosi()`</span> seperately:</span>
<span id="cb56-347"><a href="#cb56-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-350"><a href="#cb56-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-351"><a href="#cb56-351" aria-hidden="true" tabindex="-1"></a>normal_sample<span class="sc">$</span>score <span class="sc">%&gt;%</span> <span class="fu">skew</span>()</span>
<span id="cb56-352"><a href="#cb56-352" aria-hidden="true" tabindex="-1"></a>normal_sample<span class="sc">$</span>score <span class="sc">%&gt;%</span> <span class="fu">kurtosi</span>()</span>
<span id="cb56-353"><a href="#cb56-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-354"><a href="#cb56-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-355"><a href="#cb56-355" aria-hidden="true" tabindex="-1"></a>Now <span class="in">`skewed_sample`</span>:</span>
<span id="cb56-356"><a href="#cb56-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-359"><a href="#cb56-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-360"><a href="#cb56-360" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(skewed_sample<span class="sc">$</span>score, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb56-361"><a href="#cb56-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-362"><a href="#cb56-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-363"><a href="#cb56-363" aria-hidden="true" tabindex="-1"></a><span class="fu">### using the non-transformed values</span></span>
<span id="cb56-364"><a href="#cb56-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-365"><a href="#cb56-365" aria-hidden="true" tabindex="-1"></a>The values of skew and kurtosis are calculated using the three types outlined by Joanes and Gill (1998) <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.jstor.org/stable/2988433)</span>. By default, for <span class="in">`psych::describe()`</span>, <span class="in">`type=3`</span>, which corresponds to $b_1$ and $b_2$ from Joanes and Gill. Note that <span class="in">`type=2`</span> corresponds to the values obtained using SPSS. For the purposes of comparison we will use <span class="in">`type=2`</span>, though note that each (<span class="in">`type=2`</span> or <span class="in">`type=3`</span>) has its advantages, see Joanes and Gill, 1998 for more detail. As relayed by Kim (2013) <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3591587/)</span>, if one wants to assess skew and kurtosis based upon these raw values, then any value <span class="sc">\&gt;</span> 2 for skew or <span class="sc">\&gt;</span> 4 for kurtosis should be viewed as suspect.</span>
<span id="cb56-366"><a href="#cb56-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-367"><a href="#cb56-367" aria-hidden="true" tabindex="-1"></a><span class="fu">### using the standardized values</span></span>
<span id="cb56-368"><a href="#cb56-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-369"><a href="#cb56-369" aria-hidden="true" tabindex="-1"></a>However, as Kim notes, one can apply a test of standardized test for normality by dividing the skew and kurtosis by their respective standard errors. Note that SPSS will provide you with this standard error estimate. <span class="in">`R`</span> by default does not. You may elect to replicate the SPSS method, again based on <span class="in">`type=2`</span> calculations, by importing the function found below (taken from <span class="co">[</span><span class="ot">Howard Seltman, here</span><span class="co">](http://www.stat.cmu.edu/~hseltman/files/spssSkewKurtosis.R)</span>). Once you have imported the function <span class="in">`spssSkewKurtosis`</span> you can simply call <span class="in">`spssSkewKurtosis(vector)`</span>. For example, with <span class="in">`skewed_sample`</span>:</span>
<span id="cb56-370"><a href="#cb56-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-373"><a href="#cb56-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-374"><a href="#cb56-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewness and kurtosis and their standard errors as implemented by SPSS</span></span>
<span id="cb56-375"><a href="#cb56-375" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-376"><a href="#cb56-376" aria-hidden="true" tabindex="-1"></a><span class="co"># Reference: pp 451-452 of</span></span>
<span id="cb56-377"><a href="#cb56-377" aria-hidden="true" tabindex="-1"></a><span class="co"># http://support.spss.com/ProductsExt/SPSS/Documentation/Manuals/16.0/SPSS 16.0 Algorithms.pdf</span></span>
<span id="cb56-378"><a href="#cb56-378" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb56-379"><a href="#cb56-379" aria-hidden="true" tabindex="-1"></a><span class="co"># See also: Suggestion for Using Powerful and Informative Tests of Normality,</span></span>
<span id="cb56-380"><a href="#cb56-380" aria-hidden="true" tabindex="-1"></a><span class="co"># Ralph B. D'Agostino, Albert Belanger, Ralph B. D'Agostino, Jr.,</span></span>
<span id="cb56-381"><a href="#cb56-381" aria-hidden="true" tabindex="-1"></a><span class="co"># The American Statistician, Vol. 44, No. 4 (Nov., 1990), pp. 316-321</span></span>
<span id="cb56-382"><a href="#cb56-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-383"><a href="#cb56-383" aria-hidden="true" tabindex="-1"></a>spssSkewKurtosis <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb56-384"><a href="#cb56-384" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb56-385"><a href="#cb56-385" aria-hidden="true" tabindex="-1"></a>  m1<span class="ot">=</span><span class="fu">mean</span>(x)</span>
<span id="cb56-386"><a href="#cb56-386" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">-</span>m1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-387"><a href="#cb56-387" aria-hidden="true" tabindex="-1"></a>  m3<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">-</span>m1)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb56-388"><a href="#cb56-388" aria-hidden="true" tabindex="-1"></a>  m4<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">-</span>m1)<span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb56-389"><a href="#cb56-389" aria-hidden="true" tabindex="-1"></a>  s1<span class="ot">=</span><span class="fu">sd</span>(x)</span>
<span id="cb56-390"><a href="#cb56-390" aria-hidden="true" tabindex="-1"></a>  skew<span class="ot">=</span>w<span class="sc">*</span>m3<span class="sc">/</span>(w<span class="dv">-1</span>)<span class="sc">/</span>(w<span class="dv">-2</span>)<span class="sc">/</span>s1<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb56-391"><a href="#cb56-391" aria-hidden="true" tabindex="-1"></a>  sdskew<span class="ot">=</span><span class="fu">sqrt</span>( <span class="dv">6</span><span class="sc">*</span>w<span class="sc">*</span>(w<span class="dv">-1</span>) <span class="sc">/</span> ((w<span class="dv">-2</span>)<span class="sc">*</span>(w<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(w<span class="sc">+</span><span class="dv">3</span>)) )</span>
<span id="cb56-392"><a href="#cb56-392" aria-hidden="true" tabindex="-1"></a>  kurtosis<span class="ot">=</span>(w<span class="sc">*</span>(w<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>m4 <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>m2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(w<span class="dv">-1</span>)) <span class="sc">/</span> ((w<span class="dv">-1</span>)<span class="sc">*</span>(w<span class="dv">-2</span>)<span class="sc">*</span>(w<span class="dv">-3</span>)<span class="sc">*</span>s1<span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb56-393"><a href="#cb56-393" aria-hidden="true" tabindex="-1"></a>  sdkurtosis<span class="ot">=</span><span class="fu">sqrt</span>( <span class="dv">4</span><span class="sc">*</span>(w<span class="sc">^</span><span class="dv">2-1</span>) <span class="sc">*</span> sdskew<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> ((w<span class="dv">-3</span>)<span class="sc">*</span>(w<span class="sc">+</span><span class="dv">5</span>)) )</span>
<span id="cb56-394"><a href="#cb56-394" aria-hidden="true" tabindex="-1"></a>  mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(skew,kurtosis, sdskew,sdkurtosis), <span class="dv">2</span>,</span>
<span id="cb56-395"><a href="#cb56-395" aria-hidden="true" tabindex="-1"></a>        <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"skew"</span>,<span class="st">"kurtosis"</span>), <span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"se"</span>)))</span>
<span id="cb56-396"><a href="#cb56-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mat)</span>
<span id="cb56-397"><a href="#cb56-397" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-398"><a href="#cb56-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-399"><a href="#cb56-399" aria-hidden="true" tabindex="-1"></a><span class="co"># skewed_sample</span></span>
<span id="cb56-400"><a href="#cb56-400" aria-hidden="true" tabindex="-1"></a><span class="fu">spssSkewKurtosis</span>(skewed_sample<span class="sc">$</span>score)</span>
<span id="cb56-401"><a href="#cb56-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-402"><a href="#cb56-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-403"><a href="#cb56-403" aria-hidden="true" tabindex="-1"></a>Also note that you can source this custom code to your environment whenever you want using:</span>
<span id="cb56-404"><a href="#cb56-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-407"><a href="#cb56-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-408"><a href="#cb56-408" aria-hidden="true" tabindex="-1"></a><span class="co"># I typically source files in the first chunk as well</span></span>
<span id="cb56-409"><a href="#cb56-409" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"http://www.stat.cmu.edu/~hseltman/files/spssSkewKurtosis.R"</span>)</span>
<span id="cb56-410"><a href="#cb56-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-411"><a href="#cb56-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-412"><a href="#cb56-412" aria-hidden="true" tabindex="-1"></a>From here we could divide each <span class="in">`estimate`</span> by their <span class="in">`se`</span> and apply the critical values as recommended by Kim:</span>
<span id="cb56-413"><a href="#cb56-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-416"><a href="#cb56-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-417"><a href="#cb56-417" aria-hidden="true" tabindex="-1"></a><span class="fu">spssSkewKurtosis</span>(skewed_sample<span class="sc">$</span>score)[,<span class="dv">1</span>]<span class="sc">/</span></span>
<span id="cb56-418"><a href="#cb56-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spssSkewKurtosis</span>(skewed_sample<span class="sc">$</span>score)[,<span class="dv">2</span>]</span>
<span id="cb56-419"><a href="#cb56-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-420"><a href="#cb56-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-421"><a href="#cb56-421" aria-hidden="true" tabindex="-1"></a>According to Kim:</span>
<span id="cb56-422"><a href="#cb56-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-423"><a href="#cb56-423" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>if $N$ <span class="sc">\&lt;</span> 50, any value over 1.96</span>
<span id="cb56-424"><a href="#cb56-424" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>if (50 <span class="sc">\&lt;</span> $N$ <span class="sc">\&lt;</span> 300), any value over 3.29</span>
<span id="cb56-425"><a href="#cb56-425" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>if $N$ <span class="sc">\&gt;</span> 300, no transform: any value of 2 for skew and 4 for kurtosis.</span>
<span id="cb56-426"><a href="#cb56-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-427"><a href="#cb56-427" aria-hidden="true" tabindex="-1"></a>Both skew and kurtosis fail the normal test. Compare this to <span class="in">`normal_sample`</span>:</span>
<span id="cb56-428"><a href="#cb56-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-431"><a href="#cb56-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-432"><a href="#cb56-432" aria-hidden="true" tabindex="-1"></a><span class="fu">spssSkewKurtosis</span>(normal_sample<span class="sc">$</span>score)[,<span class="dv">1</span>]<span class="sc">/</span></span>
<span id="cb56-433"><a href="#cb56-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spssSkewKurtosis</span>(normal_sample<span class="sc">$</span>score)[,<span class="dv">2</span>]</span>
<span id="cb56-434"><a href="#cb56-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-435"><a href="#cb56-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-436"><a href="#cb56-436" aria-hidden="true" tabindex="-1"></a>Both absolute values are below 3.29.</span>
<span id="cb56-437"><a href="#cb56-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-438"><a href="#cb56-438" aria-hidden="true" tabindex="-1"></a><span class="fu">### using a bootstrapped standard errors (recommended)</span></span>
<span id="cb56-439"><a href="#cb56-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-440"><a href="#cb56-440" aria-hidden="true" tabindex="-1"></a>There is a caveat to the test method from the previous section. The standard errors calculated above work for normal distributions, but not for other distributions. Obviously this is a problem, as by definition we are using the above method, including the standard errors, to test for non-normality. If our distribution is non-normal, then the standard error that we are using to test for non-normality is suspect!! See <span class="co">[</span><span class="ot">here</span><span class="co">](https://rdrr.io/cran/DescTools/man/Skew.html)</span> for a brief discussion. And a solution, <span class="in">`DescTools`</span>!!</span>
<span id="cb56-441"><a href="#cb56-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-442"><a href="#cb56-442" aria-hidden="true" tabindex="-1"></a>The solution involves bootstrapping the 95% confidence interval and estimating the standard error. <span class="in">`DescTools::Skew()`</span> and <span class="in">`DescTools::Kurt()`</span> both provide this option, using <span class="in">`ci.type="bca"`</span>. This method is also recommended by Joanes and Gill. Note that here <span class="in">`method`</span> refers to the <span class="in">`type`</span> of skew and kurtosis calculation (again, keeping it <span class="in">`2`</span> for the sake of consistency, although <span class="in">`3`</span> is fine as well).</span>
<span id="cb56-443"><a href="#cb56-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-446"><a href="#cb56-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-447"><a href="#cb56-447" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(DescTools)</span>
<span id="cb56-448"><a href="#cb56-448" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap with 1000 replications (R=1000)</span></span>
<span id="cb56-449"><a href="#cb56-449" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">Skew</span>(<span class="at">x =</span> skewed_sample<span class="sc">$</span>score, <span class="at">method =</span> <span class="dv">2</span>, <span class="at">ci.type =</span> <span class="st">"bca"</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb56-450"><a href="#cb56-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-451"><a href="#cb56-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-452"><a href="#cb56-452" aria-hidden="true" tabindex="-1"></a>from here, the standard error may be estimated by taking the range of the bootstrapped confidence interval and dividing it by <span class="in">`3.92`</span></span>
<span id="cb56-453"><a href="#cb56-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-456"><a href="#cb56-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-457"><a href="#cb56-457" aria-hidden="true" tabindex="-1"></a>bca_skew <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">Skew</span>(<span class="at">x =</span> skewed_sample<span class="sc">$</span>score, <span class="at">method =</span> <span class="dv">2</span>, <span class="at">ci.type =</span> <span class="st">"bca"</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb56-458"><a href="#cb56-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-459"><a href="#cb56-459" aria-hidden="true" tabindex="-1"></a>ses <span class="ot">&lt;-</span> (bca_skew[<span class="dv">3</span>]<span class="sc">-</span>bca_skew[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">3.92</span></span>
<span id="cb56-460"><a href="#cb56-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-461"><a href="#cb56-461" aria-hidden="true" tabindex="-1"></a>ses <span class="sc">%&gt;%</span> <span class="fu">unname</span>() <span class="co"># unname simply removes the name</span></span>
<span id="cb56-462"><a href="#cb56-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-463"><a href="#cb56-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-464"><a href="#cb56-464" aria-hidden="true" tabindex="-1"></a>From here we can take the obtained <span class="in">`skew`</span> and divide it by the standard error, <span class="in">`ses`</span>.</span>
<span id="cb56-465"><a href="#cb56-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-468"><a href="#cb56-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-469"><a href="#cb56-469" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">Skew</span>(<span class="at">x =</span> skewed_sample<span class="sc">$</span>score, <span class="at">ci.type =</span> <span class="st">"bca"</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">R =</span> <span class="dv">1000</span>)[<span class="dv">1</span>] <span class="sc">/</span> ses</span>
<span id="cb56-470"><a href="#cb56-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-471"><a href="#cb56-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-472"><a href="#cb56-472" aria-hidden="true" tabindex="-1"></a>Similar steps can be taken for kurtosis:</span>
<span id="cb56-473"><a href="#cb56-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-476"><a href="#cb56-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-477"><a href="#cb56-477" aria-hidden="true" tabindex="-1"></a>bca_kurtosis <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">Kurt</span>(<span class="at">x =</span> skewed_sample<span class="sc">$</span>score, <span class="at">ci.type =</span> <span class="st">"bca"</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb56-478"><a href="#cb56-478" aria-hidden="true" tabindex="-1"></a>ses <span class="ot">&lt;-</span> (bca_kurtosis[<span class="dv">3</span>]<span class="sc">-</span>bca_kurtosis[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">3.92</span></span>
<span id="cb56-479"><a href="#cb56-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-480"><a href="#cb56-480" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">Kurt</span>(<span class="at">x =</span> skewed_sample<span class="sc">$</span>score, <span class="at">ci.type =</span> <span class="st">"bca"</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">R =</span> <span class="dv">1000</span>)[<span class="dv">1</span>]<span class="sc">/</span>ses</span>
<span id="cb56-481"><a href="#cb56-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-482"><a href="#cb56-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-483"><a href="#cb56-483" aria-hidden="true" tabindex="-1"></a>**The logic of this.** Consider that we have bootstrapped a distribution of skews and or kurtosi just as we have done in the past with means. From class we know that the **standard error** equals the standard deviation of this distribution. The 95% CI obtained from bootstrapping are equivalent to ±1.96 <span class="sc">\*</span> the standard deviation. Therefore we can obtain the standard error by dividing the width of the 95% CI by 2 <span class="sc">\*</span> 1.96 or 3.92.</span>
<span id="cb56-484"><a href="#cb56-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-485"><a href="#cb56-485" aria-hidden="true" tabindex="-1"></a>Admittedly, coding this by hand is a bit of a chore, but the beauty of programming is that we can create our own functions for processes that we routinely perform.</span>
<span id="cb56-486"><a href="#cb56-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-487"><a href="#cb56-487" aria-hidden="true" tabindex="-1"></a>In this case I want to input a vector like <span class="in">`skewed_sample$score`</span> and have it return the bootstrapped <span class="in">`ses`</span> and the resulting skew and kurtosis.</span>
<span id="cb56-488"><a href="#cb56-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-489"><a href="#cb56-489" aria-hidden="true" tabindex="-1"></a>I'll name this function <span class="in">`skew_kurtosis_ses`</span>. Notice how I'm just taking the steps that I've performed before and wrapping them in the function:</span>
<span id="cb56-490"><a href="#cb56-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-493"><a href="#cb56-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-494"><a href="#cb56-494" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewness and kurtosis and their standard errors as determined </span></span>
<span id="cb56-495"><a href="#cb56-495" aria-hidden="true" tabindex="-1"></a><span class="co"># using boostrapped confidence intervals</span></span>
<span id="cb56-496"><a href="#cb56-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-497"><a href="#cb56-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Arguments:</span></span>
<span id="cb56-498"><a href="#cb56-498" aria-hidden="true" tabindex="-1"></a><span class="co">#   - x: vector of data you wish to analyze</span></span>
<span id="cb56-499"><a href="#cb56-499" aria-hidden="true" tabindex="-1"></a><span class="co">#   - calc_method: method of calculating skew and kurtosis, used by DescTools,                    defaults to "2"</span></span>
<span id="cb56-500"><a href="#cb56-500" aria-hidden="true" tabindex="-1"></a><span class="co">#   - calc_ci: how to derive conf. intervals, for DescTools, default "bca"</span></span>
<span id="cb56-501"><a href="#cb56-501" aria-hidden="true" tabindex="-1"></a><span class="co">#   - reps: How many bootstrap repetitions, recommend at least 1000</span></span>
<span id="cb56-502"><a href="#cb56-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-503"><a href="#cb56-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Result: a 2x2 matrix with standardized skew and kurtosis (z) </span></span>
<span id="cb56-504"><a href="#cb56-504" aria-hidden="true" tabindex="-1"></a><span class="co"># as well as critical values to compare against. </span></span>
<span id="cb56-505"><a href="#cb56-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-506"><a href="#cb56-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Values as recommended by Kim (2013) Statistical notes for clinical </span></span>
<span id="cb56-507"><a href="#cb56-507" aria-hidden="true" tabindex="-1"></a><span class="co"># researchers: assessing normal distribution (2) using skewness and kurtosis.</span></span>
<span id="cb56-508"><a href="#cb56-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-509"><a href="#cb56-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-510"><a href="#cb56-510" aria-hidden="true" tabindex="-1"></a>skew_kurtosis_z <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">calc_method =</span> <span class="dv">2</span>, <span class="at">calc_ci =</span> <span class="st">"bca"</span>, <span class="at">reps =</span> <span class="dv">10000</span>){</span>
<span id="cb56-511"><a href="#cb56-511" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-512"><a href="#cb56-512" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get skew and kurt and their cis </span></span>
<span id="cb56-513"><a href="#cb56-513" aria-hidden="true" tabindex="-1"></a>  skew_ci <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">Skew</span>(x, <span class="at">method =</span> calc_method, <span class="at">ci.type =</span> calc_ci,</span>
<span id="cb56-514"><a href="#cb56-514" aria-hidden="true" tabindex="-1"></a>                             <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">R =</span> reps)</span>
<span id="cb56-515"><a href="#cb56-515" aria-hidden="true" tabindex="-1"></a>  kurt_ci <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">Kurt</span>(x, <span class="at">method =</span> calc_method, <span class="at">ci.type =</span> calc_ci,</span>
<span id="cb56-516"><a href="#cb56-516" aria-hidden="true" tabindex="-1"></a>                             <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">R =</span> reps)</span>
<span id="cb56-517"><a href="#cb56-517" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-518"><a href="#cb56-518" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate ses from ci</span></span>
<span id="cb56-519"><a href="#cb56-519" aria-hidden="true" tabindex="-1"></a>  skew_ses <span class="ot">&lt;-</span> (skew_ci[<span class="dv">3</span>] <span class="sc">-</span> skew_ci[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">3.92</span></span>
<span id="cb56-520"><a href="#cb56-520" aria-hidden="true" tabindex="-1"></a>  kurt_ses <span class="ot">&lt;-</span> (kurt_ci[<span class="dv">3</span>] <span class="sc">-</span> kurt_ci[<span class="dv">2</span>])<span class="sc">/</span><span class="fl">3.92</span></span>
<span id="cb56-521"><a href="#cb56-521" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-522"><a href="#cb56-522" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate standardized valuess</span></span>
<span id="cb56-523"><a href="#cb56-523" aria-hidden="true" tabindex="-1"></a>  skew_z<span class="ot">&lt;-</span> skew_ci<span class="sc">/</span>skew_ses </span>
<span id="cb56-524"><a href="#cb56-524" aria-hidden="true" tabindex="-1"></a>  kurt_z<span class="ot">&lt;-</span> kurt_ci<span class="sc">/</span>kurt_ses</span>
<span id="cb56-525"><a href="#cb56-525" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-526"><a href="#cb56-526" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove names and ci columns</span></span>
<span id="cb56-527"><a href="#cb56-527" aria-hidden="true" tabindex="-1"></a>  skew_z <span class="ot">&lt;-</span> <span class="fu">unname</span>(skew_z)[<span class="dv">1</span>]</span>
<span id="cb56-528"><a href="#cb56-528" aria-hidden="true" tabindex="-1"></a>  kurt_z <span class="ot">&lt;-</span> <span class="fu">unname</span>(kurt_z)[<span class="dv">1</span>]</span>
<span id="cb56-529"><a href="#cb56-529" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-530"><a href="#cb56-530" aria-hidden="true" tabindex="-1"></a>  values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"values"</span> <span class="ot">=</span> <span class="fu">rbind</span>(skew_z,kurt_z))</span>
<span id="cb56-531"><a href="#cb56-531" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-532"><a href="#cb56-532" aria-hidden="true" tabindex="-1"></a>  <span class="co"># what are the critical values?</span></span>
<span id="cb56-533"><a href="#cb56-533" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb56-534"><a href="#cb56-534" aria-hidden="true" tabindex="-1"></a>  crit_vals<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(N<span class="sc">&lt;</span><span class="dv">50</span>, <span class="fl">1.96</span>,</span>
<span id="cb56-535"><a href="#cb56-535" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ifelse</span>(N<span class="sc">&lt;</span><span class="dv">300</span>, <span class="fl">3.29</span>)</span>
<span id="cb56-536"><a href="#cb56-536" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-537"><a href="#cb56-537" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-538"><a href="#cb56-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">cbind</span>(values,crit_vals),<span class="at">digits =</span> <span class="dv">2</span>) <span class="co"># round to 2 digits</span></span>
<span id="cb56-539"><a href="#cb56-539" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-540"><a href="#cb56-540" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-541"><a href="#cb56-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-542"><a href="#cb56-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-543"><a href="#cb56-543" aria-hidden="true" tabindex="-1"></a>Now to test my function:</span>
<span id="cb56-544"><a href="#cb56-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-547"><a href="#cb56-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-548"><a href="#cb56-548" aria-hidden="true" tabindex="-1"></a><span class="fu">skew_kurtosis_z</span>(<span class="at">x =</span> skewed_sample<span class="sc">$</span>score, <span class="at">calc_method =</span> <span class="dv">2</span>, <span class="at">calc_ci =</span> <span class="st">"bca"</span>, <span class="at">reps =</span> <span class="dv">1000</span>)</span>
<span id="cb56-549"><a href="#cb56-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-550"><a href="#cb56-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-551"><a href="#cb56-551" aria-hidden="true" tabindex="-1"></a>For those interested this function can be found on my github.com page, here, and sourced like so:</span>
<span id="cb56-552"><a href="#cb56-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-555"><a href="#cb56-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-556"><a href="#cb56-556" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://raw.githubusercontent.com/tehrandavis/PSYC7014/master/custom_functions/skew_kurtosis_z.R"</span>)</span>
<span id="cb56-557"><a href="#cb56-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-558"><a href="#cb56-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-559"><a href="#cb56-559" aria-hidden="true" tabindex="-1"></a>You can also save it to your own computer and source it from there as needed.</span>
<span id="cb56-560"><a href="#cb56-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-561"><a href="#cb56-561" aria-hidden="true" tabindex="-1"></a>Keep in mind since we are bootstrapping from random selection your absolute magnitudes will vary.</span>
<span id="cb56-562"><a href="#cb56-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-563"><a href="#cb56-563" aria-hidden="true" tabindex="-1"></a><span class="fu">## Significance Tests</span></span>
<span id="cb56-564"><a href="#cb56-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-565"><a href="#cb56-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Shapiro-Wilks</span></span>
<span id="cb56-566"><a href="#cb56-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-567"><a href="#cb56-567" aria-hidden="true" tabindex="-1"></a>The formal normality tests including Shapiro-Wilks test may be used from small to medium sized samples (e.g., n <span class="sc">\&lt;</span> 300), but may be unreliable for large samples. It outputs a test statistic <span class="in">`W`</span> that is tested against deviations from 1. This can be run by:</span>
<span id="cb56-568"><a href="#cb56-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-571"><a href="#cb56-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-572"><a href="#cb56-572" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(normal_sample<span class="sc">$</span>score)</span>
<span id="cb56-573"><a href="#cb56-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Written by <a href="https://tehrandav.is">Tehran Davis</a> of PSYC 7014.</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>