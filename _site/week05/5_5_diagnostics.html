<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>tehrandav.is - Regression model diagnostics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">tehrandav.is</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="https://tehrandav.is">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Regression model diagnostics</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../walkthroughs.html" class="sidebar-item-text sidebar-link">PSYC 7014</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">TOPIC 1 INTRO to R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_1-Rmarkdown_basics.html" class="sidebar-item-text sidebar-link">Rmarkdown Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_2-objects_assignment_functions.html" class="sidebar-item-text sidebar-link">Objects, assignment, and functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_3-install_packages.html" class="sidebar-item-text sidebar-link">Installing and loading an <code>R</code> package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_4-loading_data.html" class="sidebar-item-text sidebar-link">Loading in Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_5-leveling-up.html" class="sidebar-item-text sidebar-link">Leveling-up</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">TOPIC 2: DESCRIPTIVE STATS and CENTRAL TENDENCY</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_1-structure_data.html" class="sidebar-item-text sidebar-link">The structure of your data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_2-central_tendency.html" class="sidebar-item-text sidebar-link">Measures of central tendency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_3-summary_tables.html" class="sidebar-item-text sidebar-link">Creating summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_4-means_other_models.html" class="sidebar-item-text sidebar-link">Means and other models</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">TOPIC 3: DATA VISUALIZATION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_1-basic_ggplot.html" class="sidebar-item-text sidebar-link">Basic ggplotting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_2-more_adv_ggplot.html" class="sidebar-item-text sidebar-link">More advanced ggPlots</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">TOPIC 4: DISTRIBUTIONS and NHST</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="sidebar-item-text sidebar-link">Building intuitions about probability and NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_3-sampling_distributions_and_seeing_the_logic_of_nhst.html" class="sidebar-item-text sidebar-link">Sampling distributions and seeing the logic of NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_4-more_examples.html" class="sidebar-item-text sidebar-link">More examples of distributions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_5-bias_variance.html" class="sidebar-item-text sidebar-link">Bias in sample variance estimates</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">TOPIC 5: CORRELATION AND REGRESSION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_2_correlations.html" class="sidebar-item-text sidebar-link">Correlations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_3_regressions.html" class="sidebar-item-text sidebar-link">Regression, pt.&nbsp;1: Running the model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_4_plotting.html" class="sidebar-item-text sidebar-link">Plotting regression data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_5_diagnostics.html" class="sidebar-item-text sidebar-link active">Regression model diagnostics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_6_example_report.html" class="sidebar-item-text sidebar-link">Example Report</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">TOPIC 6: T-TESTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_1_t-test.html" class="sidebar-item-text sidebar-link">Testing differences in means / t-test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_2_t-test-null-model.html" class="sidebar-item-text sidebar-link">Thinking about nothing (aka the null)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_3_t-test-lm.html" class="sidebar-item-text sidebar-link">t-test? It’s just a linear model</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">TOPIC 7: POWER &amp; EFFECT SIZES</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_1-effect_size.html" class="sidebar-item-text sidebar-link">Effect Size</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_2-power.html" class="sidebar-item-text sidebar-link">Power</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_3-power_es_sig_tests.html" class="sidebar-item-text sidebar-link">Power, Effect sizes, and Significance testing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_4-simulating_power.html" class="sidebar-item-text sidebar-link">Simulating Power!!!</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">TOPIC 8: INTRO to ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_1-one-way-anova.html" class="sidebar-item-text sidebar-link">The One-way ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_2-anova-regression.html" class="sidebar-item-text sidebar-link">ANOVA and Regression</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">TOPIC 9: ANOVA: CONTRASTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_1-posthocs.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;1: post hoc tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_2-planned_contrasts.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;2: planned contrasts</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">TOPIC 10: ANOVA: FACTORIAL ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_1-main_effects.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - The omnibus ANOVA and Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_2-factorial_w_post_hocs.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - Post hoc analysis of Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_3-advanced_example_and_apa.html" class="sidebar-item-text sidebar-link">Template for Analysis &amp; APA Style</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">TOPIC 11: ANOVA + INTERACTIONS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_1-interactions.html" class="sidebar-item-text sidebar-link">Analysis of Variance: the Factorial ANOVA - Interactions &amp; Simple Effects ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_2-higher_order_anova.html" class="sidebar-item-text sidebar-link">Dealing with Higher Order Factorial ANOVA</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">TOPIC 12: WITHIN SUBJECTS / REPEATED MEASURES ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_1-afex_ANOVA.html" class="sidebar-item-text sidebar-link">afex is for ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_2-repeated_measures_anova.html" class="sidebar-item-text sidebar-link">Within Subjects / Repeated Measures ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_3-factorial_rma.html" class="sidebar-item-text sidebar-link">Factorial RM-ANOVA and simple effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_4-sphericity.html" class="sidebar-item-text sidebar-link">Sphericity: Variances and Co-Variances</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_5-spss_rma.html" class="sidebar-item-text sidebar-link">Running a RM-ANOVA in SPSS</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">TOPIC 13: MIXED ANOVA (BS + WS)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/13_1-mixed_effects_anova.html" class="sidebar-item-text sidebar-link">Mixed-effects ANOVA (BS + WS)</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#testing-the-residuals" id="toc-testing-the-residuals" class="nav-link active" data-scroll-target="#testing-the-residuals">Testing the residuals</a></li>
  <li><a href="#diagnostic-plots---base-method" id="toc-diagnostic-plots---base-method" class="nav-link" data-scroll-target="#diagnostic-plots---base-method">Diagnostic plots - base method</a></li>
  <li><a href="#diagnostic-plots---ggplot-method-ggfortify" id="toc-diagnostic-plots---ggplot-method-ggfortify" class="nav-link" data-scroll-target="#diagnostic-plots---ggplot-method-ggfortify">Diagnostic plots - ggplot method (ggfortify)</a></li>
  <li><a href="#diagnostic-plots---performance-method" id="toc-diagnostic-plots---performance-method" class="nav-link" data-scroll-target="#diagnostic-plots---performance-method">Diagnostic plots - performance method</a></li>
  <li><a href="#testing-heteroscedasticity" id="toc-testing-heteroscedasticity" class="nav-link" data-scroll-target="#testing-heteroscedasticity">Testing Heteroscedasticity</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Regression model diagnostics</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>This walkthrough assumes that you have the following loaded in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, car, cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="testing-the-residuals" class="level2"><h2 class="anchored" data-anchor-id="testing-the-residuals">Testing the residuals</h2>
<p>An important assumption test for our model is that the residuals are normally distributed. In fact some argue that this is more important than than having normal distributions in the raw data itself. Quickly, we can test this using the regular methods from the normal distribution walkthrough (see earlier this week).</p>
<p>Assuming we have loaded in our data and created our model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># load in data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>stress_data <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab9-2.dat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  ID = col_double(),
  Stress = col_double(),
  Symptoms = col_double(),
  lnSymptoms = col_double()
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># linear model</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>stress_symptoms_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnSymptoms <span class="sc">~</span> Stress, <span class="at">data =</span> stress_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">hist</span>(stress_symptoms_model<span class="sc">$</span>residuals,<span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>car<span class="sc">::</span><span class="fu">qqPlot</span>(stress_symptoms_model<span class="sc">$</span>residuals) <span class="sc">%&gt;%</span> <span class="fu">show</span>()</span>
<span id="cb5-3"><a href="#cb5-3"></a>psych<span class="sc">::</span><span class="fu">describe</span>(stress_symptoms_model<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Question 9: Run a Shapiro-Wilkes test (see earlier walkthrough) on our <code>stress_symptoms_model</code> residuals. How do we feel about the residuals here?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># run a S-W on the residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="diagnostic-plots---base-method" class="level2"><h2 class="anchored" data-anchor-id="diagnostic-plots---base-method">Diagnostic plots - base method</h2>
<p>We can also submit the <code>stress_symptoms_model</code> to a battery of diagnostic plots. See the Flora Chapter 1 section on <strong>Basic Regression Diagnostic Concepts</strong> for an ex-plainer on each of these plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">plot</span>(stress_symptoms_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>produces a host of successive plots, including a plot of “Residuals v. Fitted”, A Q-Q plot that includes possible outliers, and a leverage plot.</p>
</section><section id="diagnostic-plots---ggplot-method-ggfortify" class="level2"><h2 class="anchored" data-anchor-id="diagnostic-plots---ggplot-method-ggfortify">Diagnostic plots - ggplot method (ggfortify)</h2>
<p>The above function produces the plots in succession using base <code>R</code> graphics. There is a <code>ggplot</code> based alternative that uses the <code>ggfortify</code> package, that produces all 4 diagnostic plots in a single figure. <a href="https://cran.r-project.org/web/packages/ggfortify/vignettes/plot_lm.html">See this link for more details</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ggfortify)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># you mush have ggfortify loaded to call autoplot</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="fu">autoplot</span>(stress_symptoms_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_5_diagnostics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="diagnostic-plots---performance-method" class="level2"><h2 class="anchored" data-anchor-id="diagnostic-plots---performance-method">Diagnostic plots - performance method</h2>
<p>We can get a similar battery of diagnostics using the <code>performance</code> library. We can just submit our model to <code><a href="https://easystats.github.io/performance/reference/check_model.html">performance::check_model</a></code>. The nice thing about this method is the plot reminds you of what to look for. Because this function generates so many plots, it may be useful to execute this in your Console (as well as your qmd) to see the individual plots better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(stress_symptoms_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_5_diagnostics_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="testing-heteroscedasticity" class="level2"><h2 class="anchored" data-anchor-id="testing-heteroscedasticity">Testing Heteroscedasticity</h2>
<p>The assumption of Heteroscedasticity and the assumption of homogeneity of variance are one in the same. We typically refer to homogeneity of variance when we have categorical predictors. For example, next week this will involve comparing the variance of scores (their spread) in Group A against Group B.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>two_groups <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">groupA =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>,<span class="at">mean =</span> <span class="dv">150</span>,<span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb10-2"><a href="#cb10-2"></a>                     <span class="at">groupB =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">150</span>, <span class="at">sd =</span> <span class="dv">45</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"groupA"</span>, <span class="st">"groupB"</span>), <span class="at">names_to =</span> <span class="st">"group"</span>,<span class="at">values_to =</span> <span class="st">"scores"</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>  </span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="fu">ggplot</span>(two_groups, <span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>scores)) <span class="sc">+</span> </span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">"lightgray"</span>, <span class="at">geom =</span> <span class="st">"bar"</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="5_5_diagnostics_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this case, it’s apparent that the spread of scores for <code>groupB</code> is wider than <code>groupA</code>. Note that for categorical predictors we can test this using the <code><a href="https://rdrr.io/pkg/car/man/leveneTest.html">car::leveneTest</a></code> (we’ll revisit next week)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(scores<span class="sc">~</span>group,two_groups)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(y = y, group = group, ...): group coerced to
factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value    Pr(&gt;F)    
group  1  26.002 3.919e-06 ***
      58                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>However, with continuous predictors our data doesn’t lump down neatly into groups. Consider this example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a>heteroscedastic_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">predictor =</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb15-4"><a href="#cb15-4"></a>                          <span class="at">outcome =</span> <span class="dv">5</span> <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, predictor, predictor)</span>
<span id="cb15-5"><a href="#cb15-5"></a>)</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="fu">ggplot</span>(heteroscedastic_data, <span class="fu">aes</span>(<span class="at">x=</span>predictor, <span class="at">y=</span>outcome)) <span class="sc">+</span> </span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"gray"</span>) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="5_5_diagnostics_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We see here that the <code>outcome</code> becomes more variable as the predictor grows larger. This plot is demonstrating a violation of Heteroscedasticity The black line represents the line of best fit derived from running <code>lm</code>. Together, this highlights the central problem… in this case the error (residuals) increase as a function of the <code>predictor</code>. Among other things this would this may result in non-normal residuals.</p>
<p>A comprehensive visual inspection may be performed by calling the <code>autoplot</code> function on the linear model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">lm</span>(outcome<span class="sc">~</span>predictor, heteroscedastic_data) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_5_diagnostics_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this case, the important plots are the first three. If Heteroscedasticity were not present, plots (1) and (3) would have a flat horizontal red line indicating the average residuals of this regression. As the residuals are clumped in areas, we can say that Heteroscedasticity is evident in this data set. Plot (2), our qqplot, also is influenced by this Heteroscedasticity, as the distribution of errors is systematic rather than random (i.e., another confounding relationship is affecting error).</p>
<p>Several tests for Heteroscedasticity can be accessed from the <code>olsrr</code> package. For example, a simple test for Heteroscedasticity is the Breusch Pagan Test. Testing our <code>stress_symptoms_model</code> remember that the null hypothesis for this test is that the data is NOT heteroscedastic, therefore a p-value (here evaluated along the <span class="math inline">\(\chi^2\)</span> distribution (<code>Chi2</code>) that is less than .05 means that the model has violated this assumption. In this case our <code>stress_symptoms_model</code> check out fine:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(olsrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>also installing the dependency 'goftest'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/7k/6v7xmh35305_vjzy660s9_q40000gs/T//RtmpEbFMZZ/downloaded_packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
olsrr installed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">ols_test_breusch_pagan</span>(stress_symptoms_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

                 Data                  
 --------------------------------------
 Response : lnSymptoms 
 Variables: fitted values of lnSymptoms 

        Test Summary         
 ----------------------------
 DF            =    1 
 Chi2          =    1.434746 
 Prob &gt; Chi2   =    0.2309914 </code></pre>
</div>
</div>
<p>And now taking a look at our <code>heteroscedastic_data</code>, we see a violation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>heteroscedastic_data_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome<span class="sc">~</span>predictor, heteroscedastic_data)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">ols_test_breusch_pagan</span>(heteroscedastic_data_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

               Data                 
 -----------------------------------
 Response : outcome 
 Variables: fitted values of outcome 

         Test Summary           
 -------------------------------
 DF            =    1 
 Chi2          =    193.0889 
 Prob &gt; Chi2   =    6.731713e-44 </code></pre>
</div>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb26" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">---</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="an">title:</span><span class="co"> "Regression model diagnostics"</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">---</span></span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a>This walkthrough assumes that you have the following loaded in:</span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="in">```{r}</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, car, cowplot)</span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="in">```</span></span>
<span id="cb26-12"><a href="#cb26-12"></a></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="fu">## Testing the residuals</span></span>
<span id="cb26-14"><a href="#cb26-14"></a></span>
<span id="cb26-15"><a href="#cb26-15"></a>An important assumption test for our model is that the residuals are normally distributed. In fact some argue that this is more important than than having normal distributions in the raw data itself. Quickly, we can test this using the regular methods from the normal distribution walkthrough (see earlier this week).</span>
<span id="cb26-16"><a href="#cb26-16"></a></span>
<span id="cb26-17"><a href="#cb26-17"></a>Assuming we have loaded in our data and created our model:</span>
<span id="cb26-18"><a href="#cb26-18"></a></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="in">```{r}</span></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="co"># load in data</span></span>
<span id="cb26-23"><a href="#cb26-23"></a>stress_data <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab9-2.dat"</span>)</span>
<span id="cb26-24"><a href="#cb26-24"></a></span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="co"># linear model</span></span>
<span id="cb26-26"><a href="#cb26-26"></a>stress_symptoms_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnSymptoms <span class="sc">~</span> Stress, <span class="at">data =</span> stress_data)</span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="in">```</span></span>
<span id="cb26-28"><a href="#cb26-28"></a></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb26-30"><a href="#cb26-30"></a><span class="fu">hist</span>(stress_symptoms_model<span class="sc">$</span>residuals,<span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb26-31"><a href="#cb26-31"></a>car<span class="sc">::</span><span class="fu">qqPlot</span>(stress_symptoms_model<span class="sc">$</span>residuals) <span class="sc">%&gt;%</span> <span class="fu">show</span>()</span>
<span id="cb26-32"><a href="#cb26-32"></a>psych<span class="sc">::</span><span class="fu">describe</span>(stress_symptoms_model<span class="sc">$</span>residuals)</span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="in">```</span></span>
<span id="cb26-34"><a href="#cb26-34"></a></span>
<span id="cb26-35"><a href="#cb26-35"></a>**Question 9: Run a Shapiro-Wilkes test (see earlier walkthrough) on our `stress_symptoms_model` residuals. How do we feel about the residuals here?**</span>
<span id="cb26-36"><a href="#cb26-36"></a></span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="in">```{r}</span></span>
<span id="cb26-40"><a href="#cb26-40"></a><span class="co"># run a S-W on the residuals</span></span>
<span id="cb26-41"><a href="#cb26-41"></a></span>
<span id="cb26-42"><a href="#cb26-42"></a><span class="in">```</span></span>
<span id="cb26-43"><a href="#cb26-43"></a></span>
<span id="cb26-44"><a href="#cb26-44"></a><span class="fu">## Diagnostic plots - base method</span></span>
<span id="cb26-45"><a href="#cb26-45"></a></span>
<span id="cb26-46"><a href="#cb26-46"></a>We can also submit the <span class="in">`stress_symptoms_model`</span> to a battery of diagnostic plots. See the Flora Chapter 1 section on **Basic Regression Diagnostic Concepts** for an ex-plainer on each of these plots.</span>
<span id="cb26-47"><a href="#cb26-47"></a></span>
<span id="cb26-48"><a href="#cb26-48"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb26-49"><a href="#cb26-49"></a><span class="fu">plot</span>(stress_symptoms_model)</span>
<span id="cb26-50"><a href="#cb26-50"></a><span class="in">```</span></span>
<span id="cb26-51"><a href="#cb26-51"></a></span>
<span id="cb26-52"><a href="#cb26-52"></a>produces a host of successive plots, including a plot of "Residuals v. Fitted", A Q-Q plot that includes possible outliers, and a leverage plot.</span>
<span id="cb26-53"><a href="#cb26-53"></a></span>
<span id="cb26-54"><a href="#cb26-54"></a><span class="fu">## Diagnostic plots - ggplot method (ggfortify)</span></span>
<span id="cb26-55"><a href="#cb26-55"></a></span>
<span id="cb26-56"><a href="#cb26-56"></a>The above function produces the plots in succession using base <span class="in">`R`</span> graphics. There is a <span class="in">`ggplot`</span> based alternative that uses the <span class="in">`ggfortify`</span> package, that produces all 4 diagnostic plots in a single figure. <span class="co">[</span><span class="ot">See this link for more details</span><span class="co">](https://cran.r-project.org/web/packages/ggfortify/vignettes/plot_lm.html)</span>.</span>
<span id="cb26-57"><a href="#cb26-57"></a></span>
<span id="cb26-60"><a href="#cb26-60"></a><span class="in">```{r}</span></span>
<span id="cb26-61"><a href="#cb26-61"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ggfortify)</span>
<span id="cb26-62"><a href="#cb26-62"></a></span>
<span id="cb26-63"><a href="#cb26-63"></a><span class="co"># you mush have ggfortify loaded to call autoplot</span></span>
<span id="cb26-64"><a href="#cb26-64"></a><span class="fu">autoplot</span>(stress_symptoms_model)</span>
<span id="cb26-65"><a href="#cb26-65"></a><span class="in">```</span></span>
<span id="cb26-66"><a href="#cb26-66"></a></span>
<span id="cb26-67"><a href="#cb26-67"></a><span class="fu">## Diagnostic plots - performance method</span></span>
<span id="cb26-68"><a href="#cb26-68"></a></span>
<span id="cb26-69"><a href="#cb26-69"></a>We can get a similar battery of diagnostics using the <span class="in">`performance`</span> library. We can just submit our model to <span class="in">`performance::check_model`</span>. The nice thing about this method is the plot reminds you of what to look for. Because this function generates so many plots, it may be useful to execute this in your Console (as well as your qmd) to see the individual plots better.</span>
<span id="cb26-70"><a href="#cb26-70"></a></span>
<span id="cb26-73"><a href="#cb26-73"></a><span class="in">```{r}</span></span>
<span id="cb26-74"><a href="#cb26-74"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(stress_symptoms_model)</span>
<span id="cb26-75"><a href="#cb26-75"></a><span class="in">```</span></span>
<span id="cb26-76"><a href="#cb26-76"></a></span>
<span id="cb26-77"><a href="#cb26-77"></a><span class="fu">## Testing Heteroscedasticity</span></span>
<span id="cb26-78"><a href="#cb26-78"></a></span>
<span id="cb26-79"><a href="#cb26-79"></a>The assumption of Heteroscedasticity and the assumption of homogeneity of variance are one in the same. We typically refer to homogeneity of variance when we have categorical predictors. For example, next week this will involve comparing the variance of scores (their spread) in Group A against Group B.</span>
<span id="cb26-80"><a href="#cb26-80"></a></span>
<span id="cb26-83"><a href="#cb26-83"></a><span class="in">```{r}</span></span>
<span id="cb26-84"><a href="#cb26-84"></a>two_groups <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">groupA =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>,<span class="at">mean =</span> <span class="dv">150</span>,<span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb26-85"><a href="#cb26-85"></a>                     <span class="at">groupB =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">150</span>, <span class="at">sd =</span> <span class="dv">45</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-86"><a href="#cb26-86"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"groupA"</span>, <span class="st">"groupB"</span>), <span class="at">names_to =</span> <span class="st">"group"</span>,<span class="at">values_to =</span> <span class="st">"scores"</span>)</span>
<span id="cb26-87"><a href="#cb26-87"></a>  </span>
<span id="cb26-88"><a href="#cb26-88"></a><span class="fu">ggplot</span>(two_groups, <span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>scores)) <span class="sc">+</span> </span>
<span id="cb26-89"><a href="#cb26-89"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">"lightgray"</span>, <span class="at">geom =</span> <span class="st">"bar"</span>) <span class="sc">+</span></span>
<span id="cb26-90"><a href="#cb26-90"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-91"><a href="#cb26-91"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb26-92"><a href="#cb26-92"></a><span class="in">```</span></span>
<span id="cb26-93"><a href="#cb26-93"></a></span>
<span id="cb26-94"><a href="#cb26-94"></a>In this case, it's apparent that the spread of scores for <span class="in">`groupB`</span> is wider than <span class="in">`groupA`</span>. Note that for categorical predictors we can test this using the <span class="in">`car::leveneTest`</span> (we'll revisit next week)</span>
<span id="cb26-95"><a href="#cb26-95"></a></span>
<span id="cb26-98"><a href="#cb26-98"></a><span class="in">```{r}</span></span>
<span id="cb26-99"><a href="#cb26-99"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(scores<span class="sc">~</span>group,two_groups)</span>
<span id="cb26-100"><a href="#cb26-100"></a><span class="in">```</span></span>
<span id="cb26-101"><a href="#cb26-101"></a></span>
<span id="cb26-102"><a href="#cb26-102"></a>However, with continuous predictors our data doesn't lump down neatly into groups. Consider this example:</span>
<span id="cb26-103"><a href="#cb26-103"></a></span>
<span id="cb26-106"><a href="#cb26-106"></a><span class="in">```{r}</span></span>
<span id="cb26-107"><a href="#cb26-107"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb26-108"><a href="#cb26-108"></a></span>
<span id="cb26-109"><a href="#cb26-109"></a>heteroscedastic_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">predictor =</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb26-110"><a href="#cb26-110"></a>                          <span class="at">outcome =</span> <span class="dv">5</span> <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, predictor, predictor)</span>
<span id="cb26-111"><a href="#cb26-111"></a>)</span>
<span id="cb26-112"><a href="#cb26-112"></a></span>
<span id="cb26-113"><a href="#cb26-113"></a><span class="fu">ggplot</span>(heteroscedastic_data, <span class="fu">aes</span>(<span class="at">x=</span>predictor, <span class="at">y=</span>outcome)) <span class="sc">+</span> </span>
<span id="cb26-114"><a href="#cb26-114"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"gray"</span>) <span class="sc">+</span> </span>
<span id="cb26-115"><a href="#cb26-115"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb26-116"><a href="#cb26-116"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-117"><a href="#cb26-117"></a><span class="in">```</span></span>
<span id="cb26-118"><a href="#cb26-118"></a></span>
<span id="cb26-119"><a href="#cb26-119"></a>We see here that the <span class="in">`outcome`</span> becomes more variable as the predictor grows larger. This plot is demonstrating a violation of Heteroscedasticity The black line represents the line of best fit derived from running <span class="in">`lm`</span>. Together, this highlights the central problem... in this case the error (residuals) increase as a function of the <span class="in">`predictor`</span>. Among other things this would this may result in non-normal residuals.</span>
<span id="cb26-120"><a href="#cb26-120"></a></span>
<span id="cb26-121"><a href="#cb26-121"></a>A comprehensive visual inspection may be performed by calling the <span class="in">`autoplot`</span> function on the linear model:</span>
<span id="cb26-122"><a href="#cb26-122"></a></span>
<span id="cb26-125"><a href="#cb26-125"></a><span class="in">```{r}</span></span>
<span id="cb26-126"><a href="#cb26-126"></a><span class="fu">lm</span>(outcome<span class="sc">~</span>predictor, heteroscedastic_data) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>()</span>
<span id="cb26-127"><a href="#cb26-127"></a><span class="in">```</span></span>
<span id="cb26-128"><a href="#cb26-128"></a></span>
<span id="cb26-129"><a href="#cb26-129"></a>In this case, the important plots are the first three. If Heteroscedasticity were not present, plots (1) and (3) would have a flat horizontal red line indicating the average residuals of this regression. As the residuals are clumped in areas, we can say that Heteroscedasticity is evident in this data set. Plot (2), our qqplot, also is influenced by this Heteroscedasticity, as the distribution of errors is systematic rather than random (i.e., another confounding relationship is affecting error).</span>
<span id="cb26-130"><a href="#cb26-130"></a></span>
<span id="cb26-131"><a href="#cb26-131"></a>Several tests for Heteroscedasticity can be accessed from the <span class="in">`olsrr`</span> package. For example, a simple test for Heteroscedasticity is the Breusch Pagan Test. Testing our <span class="in">`stress_symptoms_model`</span> remember that the null hypothesis for this test is that the data is NOT heteroscedastic, therefore a p-value (here evaluated along the $\chi^2$ distribution (<span class="in">`Chi2`</span>) that is less than .05 means that the model has violated this assumption. In this case our <span class="in">`stress_symptoms_model`</span> check out fine:</span>
<span id="cb26-132"><a href="#cb26-132"></a></span>
<span id="cb26-135"><a href="#cb26-135"></a><span class="in">```{r}</span></span>
<span id="cb26-136"><a href="#cb26-136"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(olsrr)</span>
<span id="cb26-137"><a href="#cb26-137"></a><span class="fu">ols_test_breusch_pagan</span>(stress_symptoms_model)</span>
<span id="cb26-138"><a href="#cb26-138"></a><span class="in">```</span></span>
<span id="cb26-139"><a href="#cb26-139"></a></span>
<span id="cb26-140"><a href="#cb26-140"></a>And now taking a look at our <span class="in">`heteroscedastic_data`</span>, we see a violation.</span>
<span id="cb26-141"><a href="#cb26-141"></a></span>
<span id="cb26-144"><a href="#cb26-144"></a><span class="in">```{r}</span></span>
<span id="cb26-145"><a href="#cb26-145"></a>heteroscedastic_data_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome<span class="sc">~</span>predictor, heteroscedastic_data)</span>
<span id="cb26-146"><a href="#cb26-146"></a><span class="fu">ols_test_breusch_pagan</span>(heteroscedastic_data_model)</span>
<span id="cb26-147"><a href="#cb26-147"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>