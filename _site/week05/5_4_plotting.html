<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>tehrandav.is - Plotting regression data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">tehrandav.is</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="https://tehrandav.is">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Plotting regression data</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../walkthroughs.html" class="sidebar-item-text sidebar-link">PSYC 7014</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">TOPIC 1 INTRO to R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_1-Rmarkdown_basics.html" class="sidebar-item-text sidebar-link">Rmarkdown Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_2-objects_assignment_functions.html" class="sidebar-item-text sidebar-link">Objects, assignment, and functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_3-install_packages.html" class="sidebar-item-text sidebar-link">Installing and loading an <code>R</code> package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_4-loading_data.html" class="sidebar-item-text sidebar-link">Loading in Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_5-leveling-up.html" class="sidebar-item-text sidebar-link">Leveling-up</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">TOPIC 2: DESCRIPTIVE STATS and CENTRAL TENDENCY</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_1-structure_data.html" class="sidebar-item-text sidebar-link">The structure of your data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_2-central_tendency.html" class="sidebar-item-text sidebar-link">Measures of central tendency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_3-summary_tables.html" class="sidebar-item-text sidebar-link">Creating summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_4-means_other_models.html" class="sidebar-item-text sidebar-link">Means and other models</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">TOPIC 3: DATA VISUALIZATION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_1-basic_ggplot.html" class="sidebar-item-text sidebar-link">Basic ggplotting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_2-more_adv_ggplot.html" class="sidebar-item-text sidebar-link">More advanced ggPlots</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">TOPIC 4: DISTRIBUTIONS and NHST</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="sidebar-item-text sidebar-link">Building intuitions about probability and NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_3-sampling_distributions_and_seeing_the_logic_of_nhst.html" class="sidebar-item-text sidebar-link">Sampling distributions and seeing the logic of NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_4-more_examples.html" class="sidebar-item-text sidebar-link">More examples of distributions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_5-bias_variance.html" class="sidebar-item-text sidebar-link">Bias in sample variance estimates</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">TOPIC 5: CORRELATION AND REGRESSION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_2_correlations.html" class="sidebar-item-text sidebar-link">Correlations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_3_regressions.html" class="sidebar-item-text sidebar-link">Regression, pt.&nbsp;1: Running the model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_4_plotting.html" class="sidebar-item-text sidebar-link active">Plotting regression data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_5_diagnostics.html" class="sidebar-item-text sidebar-link">Regression model diagnostics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_6_example_report.html" class="sidebar-item-text sidebar-link">Example Report</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">TOPIC 6: T-TESTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_1_t-test.html" class="sidebar-item-text sidebar-link">Testing differences in means / t-test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_2_t-test-null-model.html" class="sidebar-item-text sidebar-link">Thinking about nothing (aka the null)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_3_t-test-lm.html" class="sidebar-item-text sidebar-link">t-test? It’s just a linear model</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">TOPIC 7: POWER &amp; EFFECT SIZES</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_1-effect_size.html" class="sidebar-item-text sidebar-link">Effect Size</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_2-power.html" class="sidebar-item-text sidebar-link">Power</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_3-power_es_sig_tests.html" class="sidebar-item-text sidebar-link">Power, Effect sizes, and Significance testing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_4-simulating_power.html" class="sidebar-item-text sidebar-link">Simulating Power!!!</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">TOPIC 8: INTRO to ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_1-one-way-anova.html" class="sidebar-item-text sidebar-link">The One-way ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_2-anova-regression.html" class="sidebar-item-text sidebar-link">ANOVA and Regression</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">TOPIC 9: ANOVA: CONTRASTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_1-posthocs.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;1: post hoc tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_2-planned_contrasts.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;2: planned contrasts</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">TOPIC 10: ANOVA: FACTORIAL ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_1-main_effects.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - The omnibus ANOVA and Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_2-factorial_w_post_hocs.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - Post hoc analysis of Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_3-advanced_example_and_apa.html" class="sidebar-item-text sidebar-link">Template for Analysis &amp; APA Style</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">TOPIC 11: ANOVA + INTERACTIONS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_1-interactions.html" class="sidebar-item-text sidebar-link">Analysis of Variance: the Factorial ANOVA - Interactions &amp; Simple Effects ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_2-higher_order_anova.html" class="sidebar-item-text sidebar-link">Dealing with Higher Order Factorial ANOVA</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">TOPIC 12: WITHIN SUBJECTS / REPEATED MEASURES ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_1-afex_ANOVA.html" class="sidebar-item-text sidebar-link">afex is for ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_2-repeated_measures_anova.html" class="sidebar-item-text sidebar-link">Within Subjects / Repeated Measures ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_3-factorial_rma.html" class="sidebar-item-text sidebar-link">Factorial RM-ANOVA and simple effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_4-sphericity.html" class="sidebar-item-text sidebar-link">Sphericity: Variances and Co-Variances</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_5-spss_rma.html" class="sidebar-item-text sidebar-link">Running a RM-ANOVA in SPSS</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">TOPIC 13: MIXED ANOVA (BS + WS)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/13_1-mixed_effects_anova.html" class="sidebar-item-text sidebar-link">Mixed-effects ANOVA (BS + WS)</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#load-in-the-data" id="toc-load-in-the-data" class="nav-link active" data-scroll-target="#load-in-the-data">Load in the data</a></li>
  <li><a href="#create-a-simple-scatter-plot" id="toc-create-a-simple-scatter-plot" class="nav-link" data-scroll-target="#create-a-simple-scatter-plot">Create a simple scatter plot</a></li>
  <li>
<a href="#add-a-regression-line" id="toc-add-a-regression-line" class="nav-link" data-scroll-target="#add-a-regression-line">Add a regression line</a>
  <ul class="collapse">
<li><a href="#final-code-example" id="toc-final-code-example" class="nav-link" data-scroll-target="#final-code-example">Final code example</a></li>
  </ul>
</li>
  <li><a href="#using-ggpmisc-to-display-additional-info" id="toc-using-ggpmisc-to-display-additional-info" class="nav-link" data-scroll-target="#using-ggpmisc-to-display-additional-info">Using <code>ggpmisc</code> to display additional info</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Plotting regression data</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>This walkthrough requires the following packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, broom, plotly, cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s useful practice to plot the regression data and line. In fact, I would typically recommend doing this at the outset of the analysis (way back at the beginning) but we had a few things to cover make this step clear.</p>
<section id="load-in-the-data" class="level2"><h2 class="anchored" data-anchor-id="load-in-the-data">Load in the data</h2>
<p>First let’s reload our <code>stress_data</code> in case you’ve reset your environment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>stress_data <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab9-2.dat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  ID = col_double(),
  Stress = col_double(),
  Symptoms = col_double(),
  lnSymptoms = col_double()
)</code></pre>
</div>
</div>
</section><section id="create-a-simple-scatter-plot" class="level2"><h2 class="anchored" data-anchor-id="create-a-simple-scatter-plot">Create a simple scatter plot</h2>
<p>And now to create a simple scatter plot of <code>lnSymptoms</code> as a function of <code>Stress</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># creating a new plot with our original scatter plot as a template:</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>scatter_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stress_data, <span class="fu">aes</span>(<span class="at">x =</span> Stress, <span class="at">y =</span> lnSymptoms)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># creates scatter plot</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">xlab</span>(<span class="st">"Stress"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"lnSymptoms"</span>) <span class="sc">+</span> </span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="fu">show</span>(scatter_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_4_plotting_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="add-a-regression-line" class="level2"><h2 class="anchored" data-anchor-id="add-a-regression-line">Add a regression line</h2>
<p>From this scatterplot we can overlay a regression line as so</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>regression_plot <span class="ot">&lt;-</span> scatter_plot <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># adding a regression line</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu">show</span>(regression_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="5_4_plotting_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Teasing apart that last line: <code>geom_smooth(method=lm, level = 0.95, color="black", se = TRUE)</code></p>
<p>To add a simple regression line to a scatter plot we can use the <code>geom_smooth()</code> function. <code>geom_smooth()</code> takes the following arguments:</p>
<p>-<code>method</code>: what kind of regression line do you want to create? in this case we are performing a linear regression, so <code>lm</code>.</p>
<p>-<code>mapping</code>: if you did not specify your <code>aes()</code> in the original call you need to specify them here (whats on the x-axis, y-axis, etc). Additionally if you are performing custom mappings this is the place.</p>
<p>-<code>level</code>: create a ribbon specifying a confidence interval of each predicted value (here I’m using 95% CI).</p>
<p>-<code>se</code>: do you want a shaded ribbon to be shown on the plot (<code>TRUE</code> of <code>FALSE</code>)</p>
<p>-<code>color</code>: what color do you want the line.</p>
<p>-<code>linetype</code>: solid line? dotted line? dashed line? default is solid.</p>
<p>Note that <code>geom_smooth()</code> is useful if one is doing very simple regression plots. If one has a more complicated model structure, then you may need to use the attributes of the model to create a data frame that works for you. I’ll coordinate with my analog for the Spring semester and see how they want to approach this, though I’m thinking at the very least I’ll have a walkthrough at the tail end of the semester that shows how one might accomplish this.</p>
<p>The shaded ribbon around the line of regression represents the 95% CI of the estimate at each value of the predictor. The size of the CI may be adjusted by using the <code>level</code> parameter in <code>geom_smooth()</code>.</p>
<section id="final-code-example" class="level3"><h3 class="anchored" data-anchor-id="final-code-example">Final code example</h3>
<p>Performing the previous two steps in a single call. Also, personally I like to lighten-up the scatter plot point to really emphasize the regression line. This can be accomplished by modifying the color of the point (line 2 below)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>regression_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stress_data, <span class="fu">aes</span>(<span class="at">x =</span> Stress, <span class="at">y =</span> lnSymptoms)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span> <span class="co"># creates scatter plot</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># add regression line</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="fu">show</span>(regression_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="5_4_plotting_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="using-ggpmisc-to-display-additional-info" class="level2"><h2 class="anchored" data-anchor-id="using-ggpmisc-to-display-additional-info">Using <code>ggpmisc</code> to display additional info</h2>
<p>In theory, the <code>regression_plot</code> created above should suffice, and the example above only relies upon <code>ggplot</code> making it fairly robust. Sometimes, however, it’s good to convey additional info about the model in the plot. This usually is the <span class="math inline">\(R^2\)</span> and the equation for the model. Using <code>ggplot()</code> alone, this is a little more complex. But has been made easier by someone in the community “building a package for that”. <a href="https://stackoverflow.com/questions/7549694/add-regression-line-equation-and-r2-on-graph">See this exchange for details</a>.</p>
<p>Borrowing the final example from the site above, we can use the <code>ggpmisc</code> package to make life easier. In fact <code>ggpmisc()</code> allows us to create the same plot above using a slightly different code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># load in ggpmisc</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ggpmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>regression_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stress_data, <span class="fu">aes</span>(<span class="at">x =</span> Stress, <span class="at">y =</span> lnSymptoms)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">stat_poly_line</span>(<span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span> <span class="co">#ggpmisc replacement for geom_smooth()</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb10-5"><a href="#cb10-5"></a>  </span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="fu">show</span>(regression_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_4_plotting_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And now to add <span class="math inline">\(R^2\)</span> and the equation of the line to our previously created <code>regression_plot</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>regression_plot <span class="sc">+</span> <span class="co"># our regression plot from above</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(eq.label),</span>
<span id="cb11-3"><a href="#cb11-3"></a>                                 <span class="fu">after_stat</span>(rr.label), <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="5_4_plotting_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comparing this plot to our <code>stress_symptoms_model</code> output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>stress_symptoms_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress<span class="sc">~</span>lnSymptoms, <span class="at">data =</span> stress_data)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">tidy</span>(stress_symptoms_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic       p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
1 (Intercept)   -125.      22.9      -5.45 0.000000339  
2 lnSymptoms      32.6      5.11      6.38 0.00000000483</code></pre>
</div>
</div>
<p>From this plot it becomes apparent that the model coefficients obtained above represent the values of the slope and intercept of the regression line.</p>
<ul>
<li><p>The beta coefficient conveys the <em>slope</em> of the line—unit change in outcome per unit change in predictor. Typically this is expressed as <em>b</em> in text or <strong>B</strong> in SPSS. In <code>R</code> output, the beta estimate is tied to the name of the corresponding predictor variable. In our case that’s <code>Stress</code>.</p></li>
<li><p>The <strong>intercept</strong> tells us what the value of the outcome would be if the predictor was 0. In most instances the intercept is not terribly useful. For example if you were looking at the relationship between height and weight it would make no sense to concern yourself with instances where height is absolutely 0. Obviously, a caveat here is if the value 0 is meaningful for your analysis. For example, perhaps you are looking at depression as a function of alcohol consumption and want to explicitly say something about people that have never had a single drink in their life.</p></li>
</ul>
<p>One way of making a meaningless intercept meaningful is by centering your data (subtracting every value of your predictor from a constant). For example, if you center around the mean, the intercept will tell you the predicted value of the outcome variable at the mean value of the predictor.</p>
<p>Just for giggles, lets plot our mean-centered data. We mean center <code>Stress</code> by subtracting each value of <code>Stress</code> from its mean:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stress_data, <span class="fu">aes</span>(<span class="at">x=</span>(lnSymptoms<span class="sc">-</span><span class="fu">mean</span>(lnSymptoms)), <span class="at">y=</span>Stress)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">19</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">xlab</span>(<span class="st">"Stress"</span>) <span class="sc">+</span> </span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">ylab</span>(<span class="st">"lnSymptoms"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="5_4_plotting_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>as you can see slope doesn’t change, but the values become centered around the intercept <code>0</code>. In this case <code>0</code> represents the means Stress score.</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb16" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">---</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="an">title:</span><span class="co"> "Plotting regression data"</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">---</span></span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a>This walkthrough requires the following packages:</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="in">```{r}</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, broom, plotly, cowplot)</span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="in">```</span></span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a>It's useful practice to plot the regression data and line. In fact, I would typically recommend doing this at the outset of the analysis (way back at the beginning) but we had a few things to cover make this step clear.</span>
<span id="cb16-14"><a href="#cb16-14"></a></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="fu">## Load in the data</span></span>
<span id="cb16-16"><a href="#cb16-16"></a></span>
<span id="cb16-17"><a href="#cb16-17"></a>First let's reload our <span class="in">`stress_data`</span> in case you've reset your environment:</span>
<span id="cb16-18"><a href="#cb16-18"></a></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="in">```{r}</span></span>
<span id="cb16-22"><a href="#cb16-22"></a>stress_data <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="st">"https://www.uvm.edu/~statdhtx/methods8/DataFiles/Tab9-2.dat"</span>)</span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="in">```</span></span>
<span id="cb16-24"><a href="#cb16-24"></a></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="fu">## Create a simple scatter plot</span></span>
<span id="cb16-26"><a href="#cb16-26"></a></span>
<span id="cb16-27"><a href="#cb16-27"></a>And now to create a simple scatter plot of <span class="in">`lnSymptoms`</span> as a function of <span class="in">`Stress`</span></span>
<span id="cb16-28"><a href="#cb16-28"></a></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="in">```{r}</span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co"># creating a new plot with our original scatter plot as a template:</span></span>
<span id="cb16-33"><a href="#cb16-33"></a>scatter_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stress_data, <span class="fu">aes</span>(<span class="at">x =</span> Stress, <span class="at">y =</span> lnSymptoms)) <span class="sc">+</span></span>
<span id="cb16-34"><a href="#cb16-34"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># creates scatter plot</span></span>
<span id="cb16-35"><a href="#cb16-35"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb16-36"><a href="#cb16-36"></a>  <span class="fu">xlab</span>(<span class="st">"Stress"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"lnSymptoms"</span>) <span class="sc">+</span> </span>
<span id="cb16-37"><a href="#cb16-37"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb16-38"><a href="#cb16-38"></a></span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="fu">show</span>(scatter_plot)</span>
<span id="cb16-40"><a href="#cb16-40"></a><span class="in">```</span></span>
<span id="cb16-41"><a href="#cb16-41"></a></span>
<span id="cb16-42"><a href="#cb16-42"></a><span class="fu">## Add a regression line</span></span>
<span id="cb16-43"><a href="#cb16-43"></a></span>
<span id="cb16-44"><a href="#cb16-44"></a>From this scatterplot we can overlay a regression line as so</span>
<span id="cb16-45"><a href="#cb16-45"></a></span>
<span id="cb16-48"><a href="#cb16-48"></a><span class="in">```{r}</span></span>
<span id="cb16-49"><a href="#cb16-49"></a>regression_plot <span class="ot">&lt;-</span> scatter_plot <span class="sc">+</span></span>
<span id="cb16-50"><a href="#cb16-50"></a><span class="co"># adding a regression line</span></span>
<span id="cb16-51"><a href="#cb16-51"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-52"><a href="#cb16-52"></a></span>
<span id="cb16-53"><a href="#cb16-53"></a><span class="fu">show</span>(regression_plot)</span>
<span id="cb16-54"><a href="#cb16-54"></a><span class="in">```</span></span>
<span id="cb16-55"><a href="#cb16-55"></a></span>
<span id="cb16-56"><a href="#cb16-56"></a>Teasing apart that last line: <span class="in">`geom_smooth(method=lm, level = 0.95, color="black", se = TRUE)`</span></span>
<span id="cb16-57"><a href="#cb16-57"></a></span>
<span id="cb16-58"><a href="#cb16-58"></a>To add a simple regression line to a scatter plot we can use the <span class="in">`geom_smooth()`</span> function. <span class="in">`geom_smooth()`</span> takes the following arguments:</span>
<span id="cb16-59"><a href="#cb16-59"></a></span>
<span id="cb16-60"><a href="#cb16-60"></a><span class="sc">\-</span><span class="in">`method`</span>: what kind of regression line do you want to create? in this case we are performing a linear regression, so <span class="in">`lm`</span>.</span>
<span id="cb16-61"><a href="#cb16-61"></a></span>
<span id="cb16-62"><a href="#cb16-62"></a><span class="sc">\-</span><span class="in">`mapping`</span>: if you did not specify your <span class="in">`aes()`</span> in the original call you need to specify them here (whats on the x-axis, y-axis, etc). Additionally if you are performing custom mappings this is the place.</span>
<span id="cb16-63"><a href="#cb16-63"></a></span>
<span id="cb16-64"><a href="#cb16-64"></a><span class="sc">\-</span><span class="in">`level`</span>: create a ribbon specifying a confidence interval of each predicted value (here I'm using 95% CI).</span>
<span id="cb16-65"><a href="#cb16-65"></a></span>
<span id="cb16-66"><a href="#cb16-66"></a><span class="sc">\-</span><span class="in">`se`</span>: do you want a shaded ribbon to be shown on the plot (<span class="in">`TRUE`</span> of <span class="in">`FALSE`</span>)</span>
<span id="cb16-67"><a href="#cb16-67"></a></span>
<span id="cb16-68"><a href="#cb16-68"></a><span class="sc">\-</span><span class="in">`color`</span>: what color do you want the line.</span>
<span id="cb16-69"><a href="#cb16-69"></a></span>
<span id="cb16-70"><a href="#cb16-70"></a><span class="sc">\-</span><span class="in">`linetype`</span>: solid line? dotted line? dashed line? default is solid.</span>
<span id="cb16-71"><a href="#cb16-71"></a></span>
<span id="cb16-72"><a href="#cb16-72"></a>Note that <span class="in">`geom_smooth()`</span> is useful if one is doing very simple regression plots. If one has a more complicated model structure, then you may need to use the attributes of the model to create a data frame that works for you. I'll coordinate with my analog for the Spring semester and see how they want to approach this, though I'm thinking at the very least I'll have a walkthrough at the tail end of the semester that shows how one might accomplish this.</span>
<span id="cb16-73"><a href="#cb16-73"></a></span>
<span id="cb16-74"><a href="#cb16-74"></a>The shaded ribbon around the line of regression represents the 95% CI of the estimate at each value of the predictor. The size of the CI may be adjusted by using the <span class="in">`level`</span> parameter in <span class="in">`geom_smooth()`</span>.</span>
<span id="cb16-75"><a href="#cb16-75"></a></span>
<span id="cb16-76"><a href="#cb16-76"></a><span class="fu">### Final code example</span></span>
<span id="cb16-77"><a href="#cb16-77"></a></span>
<span id="cb16-78"><a href="#cb16-78"></a>Performing the previous two steps in a single call. Also, personally I like to lighten-up the scatter plot point to really emphasize the regression line. This can be accomplished by modifying the color of the point (line 2 below)</span>
<span id="cb16-79"><a href="#cb16-79"></a></span>
<span id="cb16-82"><a href="#cb16-82"></a><span class="in">```{r}</span></span>
<span id="cb16-83"><a href="#cb16-83"></a>regression_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stress_data, <span class="fu">aes</span>(<span class="at">x =</span> Stress, <span class="at">y =</span> lnSymptoms)) <span class="sc">+</span></span>
<span id="cb16-84"><a href="#cb16-84"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span> <span class="co"># creates scatter plot</span></span>
<span id="cb16-85"><a href="#cb16-85"></a>  <span class="co"># add regression line</span></span>
<span id="cb16-86"><a href="#cb16-86"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb16-87"><a href="#cb16-87"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb16-88"><a href="#cb16-88"></a></span>
<span id="cb16-89"><a href="#cb16-89"></a><span class="fu">show</span>(regression_plot)</span>
<span id="cb16-90"><a href="#cb16-90"></a><span class="in">```</span></span>
<span id="cb16-91"><a href="#cb16-91"></a></span>
<span id="cb16-92"><a href="#cb16-92"></a><span class="fu">## Using `ggpmisc` to display additional info</span></span>
<span id="cb16-93"><a href="#cb16-93"></a></span>
<span id="cb16-94"><a href="#cb16-94"></a>In theory, the <span class="in">`regression_plot`</span> created above should suffice, and the example above only relies upon <span class="in">`ggplot`</span> making it fairly robust. Sometimes, however, it's good to convey additional info about the model in the plot. This usually is the $R^2$ and the equation for the model. Using <span class="in">`ggplot()`</span> alone, this is a little more complex. But has been made easier by someone in the community "building a package for that". <span class="co">[</span><span class="ot">See this exchange for details</span><span class="co">](https://stackoverflow.com/questions/7549694/add-regression-line-equation-and-r2-on-graph)</span>.</span>
<span id="cb16-95"><a href="#cb16-95"></a></span>
<span id="cb16-96"><a href="#cb16-96"></a>Borrowing the final example from the site above, we can use the <span class="in">`ggpmisc`</span> package to make life easier. In fact <span class="in">`ggpmisc()`</span> allows us to create the same plot above using a slightly different code:</span>
<span id="cb16-97"><a href="#cb16-97"></a></span>
<span id="cb16-100"><a href="#cb16-100"></a><span class="in">```{r}</span></span>
<span id="cb16-101"><a href="#cb16-101"></a><span class="co"># load in ggpmisc</span></span>
<span id="cb16-102"><a href="#cb16-102"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ggpmisc)</span>
<span id="cb16-103"><a href="#cb16-103"></a><span class="in">```</span></span>
<span id="cb16-104"><a href="#cb16-104"></a></span>
<span id="cb16-107"><a href="#cb16-107"></a><span class="in">```{r}</span></span>
<span id="cb16-108"><a href="#cb16-108"></a>regression_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stress_data, <span class="fu">aes</span>(<span class="at">x =</span> Stress, <span class="at">y =</span> lnSymptoms)) <span class="sc">+</span></span>
<span id="cb16-109"><a href="#cb16-109"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb16-110"><a href="#cb16-110"></a>  <span class="fu">stat_poly_line</span>(<span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span> <span class="co">#ggpmisc replacement for geom_smooth()</span></span>
<span id="cb16-111"><a href="#cb16-111"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb16-112"><a href="#cb16-112"></a>  </span>
<span id="cb16-113"><a href="#cb16-113"></a><span class="fu">show</span>(regression_plot)</span>
<span id="cb16-114"><a href="#cb16-114"></a><span class="in">```</span></span>
<span id="cb16-115"><a href="#cb16-115"></a></span>
<span id="cb16-116"><a href="#cb16-116"></a>And now to add $R^2$ and the equation of the line to our previously created <span class="in">`regression_plot`</span></span>
<span id="cb16-117"><a href="#cb16-117"></a></span>
<span id="cb16-120"><a href="#cb16-120"></a><span class="in">```{r}</span></span>
<span id="cb16-121"><a href="#cb16-121"></a>regression_plot <span class="sc">+</span> <span class="co"># our regression plot from above</span></span>
<span id="cb16-122"><a href="#cb16-122"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(eq.label),</span>
<span id="cb16-123"><a href="#cb16-123"></a>                                 <span class="fu">after_stat</span>(rr.label), <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))</span>
<span id="cb16-124"><a href="#cb16-124"></a><span class="in">```</span></span>
<span id="cb16-125"><a href="#cb16-125"></a></span>
<span id="cb16-126"><a href="#cb16-126"></a>Comparing this plot to our <span class="in">`stress_symptoms_model`</span> output:</span>
<span id="cb16-127"><a href="#cb16-127"></a></span>
<span id="cb16-130"><a href="#cb16-130"></a><span class="in">```{r}</span></span>
<span id="cb16-131"><a href="#cb16-131"></a>stress_symptoms_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress<span class="sc">~</span>lnSymptoms, <span class="at">data =</span> stress_data)</span>
<span id="cb16-132"><a href="#cb16-132"></a><span class="fu">tidy</span>(stress_symptoms_model)</span>
<span id="cb16-133"><a href="#cb16-133"></a><span class="in">```</span></span>
<span id="cb16-134"><a href="#cb16-134"></a></span>
<span id="cb16-135"><a href="#cb16-135"></a>From this plot it becomes apparent that the model coefficients obtained above represent the values of the slope and intercept of the regression line.</span>
<span id="cb16-136"><a href="#cb16-136"></a></span>
<span id="cb16-137"><a href="#cb16-137"></a><span class="ss">-   </span>The beta coefficient conveys the *slope* of the line---unit change in outcome per unit change in predictor. Typically this is expressed as *b* in text or **B** in SPSS. In <span class="in">`R`</span> output, the beta estimate is tied to the name of the corresponding predictor variable. In our case that's <span class="in">`Stress`</span>.</span>
<span id="cb16-138"><a href="#cb16-138"></a></span>
<span id="cb16-139"><a href="#cb16-139"></a><span class="ss">-   </span>The **intercept** tells us what the value of the outcome would be if the predictor was 0. In most instances the intercept is not terribly useful. For example if you were looking at the relationship between height and weight it would make no sense to concern yourself with instances where height is absolutely 0. Obviously, a caveat here is if the value 0 is meaningful for your analysis. For example, perhaps you are looking at depression as a function of alcohol consumption and want to explicitly say something about people that have never had a single drink in their life.</span>
<span id="cb16-140"><a href="#cb16-140"></a></span>
<span id="cb16-141"><a href="#cb16-141"></a>One way of making a meaningless intercept meaningful is by centering your data (subtracting every value of your predictor from a constant). For example, if you center around the mean, the intercept will tell you the predicted value of the outcome variable at the mean value of the predictor.</span>
<span id="cb16-142"><a href="#cb16-142"></a></span>
<span id="cb16-143"><a href="#cb16-143"></a>Just for giggles, lets plot our mean-centered data. We mean center <span class="in">`Stress`</span> by subtracting each value of <span class="in">`Stress`</span> from its mean:</span>
<span id="cb16-144"><a href="#cb16-144"></a></span>
<span id="cb16-147"><a href="#cb16-147"></a><span class="in">```{r}</span></span>
<span id="cb16-148"><a href="#cb16-148"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stress_data, <span class="fu">aes</span>(<span class="at">x=</span>(lnSymptoms<span class="sc">-</span><span class="fu">mean</span>(lnSymptoms)), <span class="at">y=</span>Stress)) <span class="sc">+</span></span>
<span id="cb16-149"><a href="#cb16-149"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">19</span>) <span class="sc">+</span></span>
<span id="cb16-150"><a href="#cb16-150"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-151"><a href="#cb16-151"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb16-152"><a href="#cb16-152"></a>  <span class="fu">xlab</span>(<span class="st">"Stress"</span>) <span class="sc">+</span> </span>
<span id="cb16-153"><a href="#cb16-153"></a>  <span class="fu">ylab</span>(<span class="st">"lnSymptoms"</span>)</span>
<span id="cb16-154"><a href="#cb16-154"></a>  </span>
<span id="cb16-155"><a href="#cb16-155"></a><span class="in">```</span></span>
<span id="cb16-156"><a href="#cb16-156"></a></span>
<span id="cb16-157"><a href="#cb16-157"></a>as you can see slope doesn't change, but the values become centered around the intercept <span class="in">`0`</span>. In this case <span class="in">`0`</span> represents the means Stress score.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>