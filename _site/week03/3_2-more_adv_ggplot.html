<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>tehrandav.is - More advanced ggPlots</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">tehrandav.is</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="https://tehrandav.is">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">More advanced ggPlots</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../walkthroughs.html" class="sidebar-item-text sidebar-link">PSYC 7014</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">TOPIC 1 INTRO to R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_1-Rmarkdown_basics.html" class="sidebar-item-text sidebar-link">Rmarkdown Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_2-objects_assignment_functions.html" class="sidebar-item-text sidebar-link">Objects, assignment, and functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_3-install_packages.html" class="sidebar-item-text sidebar-link">Installing and loading an <code>R</code> package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_4-loading_data.html" class="sidebar-item-text sidebar-link">Loading in Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/1_5-leveling-up.html" class="sidebar-item-text sidebar-link">Leveling-up</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">TOPIC 2: DESCRIPTIVE STATS and CENTRAL TENDENCY</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_1-structure_data.html" class="sidebar-item-text sidebar-link">The structure of your data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_2-central_tendency.html" class="sidebar-item-text sidebar-link">Measures of central tendency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_3-summary_tables.html" class="sidebar-item-text sidebar-link">Creating summary tables</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week02/2_4-means_other_models.html" class="sidebar-item-text sidebar-link">Means and other models</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">TOPIC 3: DATA VISUALIZATION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_1-basic_ggplot.html" class="sidebar-item-text sidebar-link">Basic ggplotting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week03/3_2-more_adv_ggplot.html" class="sidebar-item-text sidebar-link active">More advanced ggPlots</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">TOPIC 4: DISTRIBUTIONS and NHST</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_2-building_intuitions_about_probability_and_nhst.html" class="sidebar-item-text sidebar-link">Building intuitions about probability and NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_3-sampling_distributions_and_seeing_the_logic_of_nhst.html" class="sidebar-item-text sidebar-link">Sampling distributions and seeing the logic of NHST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_4-more_examples.html" class="sidebar-item-text sidebar-link">More examples of distributions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week04/4_5-bias_variance.html" class="sidebar-item-text sidebar-link">Bias in sample variance estimates</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">TOPIC 5: CORRELATION AND REGRESSION</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_1-the_normal_distribution.html" class="sidebar-item-text sidebar-link">The normal distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_2_correlations.html" class="sidebar-item-text sidebar-link">Correlations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_3_regressions.html" class="sidebar-item-text sidebar-link">Regression, pt.&nbsp;1: Running the model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_4_plotting.html" class="sidebar-item-text sidebar-link">Plotting regression data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_5_diagnostics.html" class="sidebar-item-text sidebar-link">Regression model diagnostics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week05/5_6_example_report.html" class="sidebar-item-text sidebar-link">Example Report</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">TOPIC 6: T-TESTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_1_t-test.html" class="sidebar-item-text sidebar-link">Testing differences in means / t-test</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_2_t-test-null-model.html" class="sidebar-item-text sidebar-link">Thinking about nothing (aka the null)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week06/6_3_t-test-lm.html" class="sidebar-item-text sidebar-link">t-test? It’s just a linear model</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">TOPIC 7: POWER &amp; EFFECT SIZES</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_1-effect_size.html" class="sidebar-item-text sidebar-link">Effect Size</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_2-power.html" class="sidebar-item-text sidebar-link">Power</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_3-power_es_sig_tests.html" class="sidebar-item-text sidebar-link">Power, Effect sizes, and Significance testing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week07/7_4-simulating_power.html" class="sidebar-item-text sidebar-link">Simulating Power!!!</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">TOPIC 8: INTRO to ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_1-one-way-anova.html" class="sidebar-item-text sidebar-link">The One-way ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week08/8_2-anova-regression.html" class="sidebar-item-text sidebar-link">ANOVA and Regression</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">TOPIC 9: ANOVA: CONTRASTS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_1-posthocs.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;1: post hoc tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week09/9_2-planned_contrasts.html" class="sidebar-item-text sidebar-link">Multiple comparisons in One-way ANOVA, pt.&nbsp;2: planned contrasts</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">TOPIC 10: ANOVA: FACTORIAL ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_1-main_effects.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - The omnibus ANOVA and Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_2-factorial_w_post_hocs.html" class="sidebar-item-text sidebar-link">Factorial ANOVA - Post hoc analysis of Main effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/10_3-advanced_example_and_apa.html" class="sidebar-item-text sidebar-link">Template for Analysis &amp; APA Style</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">TOPIC 11: ANOVA + INTERACTIONS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_1-interactions.html" class="sidebar-item-text sidebar-link">Analysis of Variance: the Factorial ANOVA - Interactions &amp; Simple Effects ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/11_2-higher_order_anova.html" class="sidebar-item-text sidebar-link">Dealing with Higher Order Factorial ANOVA</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">TOPIC 12: WITHIN SUBJECTS / REPEATED MEASURES ANOVA</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_1-afex_ANOVA.html" class="sidebar-item-text sidebar-link">afex is for ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_2-repeated_measures_anova.html" class="sidebar-item-text sidebar-link">Within Subjects / Repeated Measures ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_3-factorial_rma.html" class="sidebar-item-text sidebar-link">Factorial RM-ANOVA and simple effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_4-sphericity.html" class="sidebar-item-text sidebar-link">Sphericity: Variances and Co-Variances</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week12/12_5-spss_rma.html" class="sidebar-item-text sidebar-link">Running a RM-ANOVA in SPSS</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">TOPIC 13: MIXED ANOVA (BS + WS)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/13_1-mixed_effects_anova.html" class="sidebar-item-text sidebar-link">Mixed-effects ANOVA (BS + WS)</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#the-data" id="toc-the-data" class="nav-link active" data-scroll-target="#the-data">The data</a></li>
  <li>
<a href="#correlation-regression-for-2-continuous-variables" id="toc-correlation-regression-for-2-continuous-variables" class="nav-link" data-scroll-target="#correlation-regression-for-2-continuous-variables">Correlation / Regression for 2 continuous variables</a>
  <ul class="collapse">
<li><a href="#basic-regression-example" id="toc-basic-regression-example" class="nav-link" data-scroll-target="#basic-regression-example">Basic regression example</a></li>
  <li><a href="#independent-regression-by-group" id="toc-independent-regression-by-group" class="nav-link" data-scroll-target="#independent-regression-by-group">Independent regression by group</a></li>
  </ul>
</li>
  <li>
<a href="#differences-in-groups" id="toc-differences-in-groups" class="nav-link" data-scroll-target="#differences-in-groups">Differences in groups</a>
  <ul class="collapse">
<li><a href="#comparing-groups-levels-of-a-single-iv" id="toc-comparing-groups-levels-of-a-single-iv" class="nav-link" data-scroll-target="#comparing-groups-levels-of-a-single-iv">Comparing groups (levels) of a single IV</a></li>
  <li><a href="#comparing-groups-in-a-factorial-design-interaction-plot" id="toc-comparing-groups-in-a-factorial-design-interaction-plot" class="nav-link" data-scroll-target="#comparing-groups-in-a-factorial-design-interaction-plot">Comparing groups in a factorial design (interaction plot)</a></li>
  </ul>
</li>
  <li><a href="#line-plots" id="toc-line-plots" class="nav-link" data-scroll-target="#line-plots">Line plots</a></li>
  <li><a href="#a-note-on-color-and-apa-formatting" id="toc-a-note-on-color-and-apa-formatting" class="nav-link" data-scroll-target="#a-note-on-color-and-apa-formatting">A note on color and APA formatting</a></li>
  <li>
<a href="#the-legend" id="toc-the-legend" class="nav-link" data-scroll-target="#the-legend">The Legend</a>
  <ul class="collapse">
<li><a href="#positioning" id="toc-positioning" class="nav-link" data-scroll-target="#positioning">Positioning</a></li>
  <li><a href="#title-ing" id="toc-title-ing" class="nav-link" data-scroll-target="#title-ing">Title-ing</a></li>
  <li><a href="#color" id="toc-color" class="nav-link" data-scroll-target="#color">Color</a></li>
  </ul>
</li>
  <li><a href="#advanced-stuff" id="toc-advanced-stuff" class="nav-link" data-scroll-target="#advanced-stuff">Advanced stuff</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">More advanced ggPlots</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Consider this vignette a compliment to your training materials with plotting, including the DataCamp modules as well as the <code>ggplot</code> specific pdfs that have been made available to you.</p>
<p>The idea here is to provide a series of templates for plot types that you can build from when developing your own plots.</p>
<p>When producing a plot, you need to give consideration to:</p>
<ol type="1">
<li>the kind of data you have, and</li>
<li>the kind of information you are trying to convey.</li>
</ol>
<p>In that spirit this vignette will be organized with those considerations in mind. I recommend before you even think of producing anything in <code>R</code>, grab a piece of paper and draw what your ideal plot would look like in terms of structure. What goes on each axes? How are groups differentiated? What kind of plot do you want? etc…</p>
<section id="the-data" class="level2"><h2 class="anchored" data-anchor-id="the-data">The data</h2>
<p>I’ll be using a modified dataset from Danielle Navarro’s <em>Learning statistics with R: A tutorial for psychology students and other beginners</em> which is a nice online text that I may use as a backbone for the course in future years. If you’re interested on Navarro’s take on stats and <code>R</code>, please check it out <a href="http://compcogscisydney.org/learning-statistics-with-r">here</a>. Coincidentally, the <code>lsr</code> package she provides is what we use to calculate certain values like Cohen’s D.</p>
<blockquote class="blockquote">
<p>The following data set was used to address the relationships that exist between a newbnorn baby’s (3-6 mos) nightly sleep, their parent’s sleep, and their parent’s overall mood. Several questions modivated the collection of this data, including: - what is the relationship between the average hours of sleep for the baby and parent? - what is the relationship between the average hours of sleep for the parent and their mood? - are these relationships influence by parental role—different for mothers and fathers - does the impact of a newborn baby on sleep differ for mothers and fathers (houts of sleep, grumpiness)</p>
</blockquote>
<p>the dataset <code>parent_sleep_data</code> contains the following variables:</p>
<ul>
<li>
<code>parent</code>: 100 mothers (typically primary care giver, especially if breast feeding) v. 100 fathers (un-matched)</li>
<li>
<code>child</code>: 100 parents with their first child v. 100 parents with their second child</li>
<li>
<code>parent_sleep</code>: average hours parent sleep 30 days prior to assessment</li>
<li>
<code>baby_sleep</code>: average hours babry sleep 30 days prior to assessment</li>
<li>
<code>parent_grumpy</code>: parent grunmpiness score</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, cowplot)</span>
<span id="cb1-2"><a href="#cb1-2"></a>parent_sleep_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/practice_datasets/parent_sleep.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 200 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): parent, child
dbl (3): parent_sleep, baby_sleep, parent_grumpy

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<ul>
<li>You might imagine, this data hits a little close to the heart ;)</li>
</ul></section><section id="correlation-regression-for-2-continuous-variables" class="level2"><h2 class="anchored" data-anchor-id="correlation-regression-for-2-continuous-variables">Correlation / Regression for 2 continuous variables</h2>
<p>Typically with correlations and regressions you want to present your data in scatterplot form.</p>
<p>Your scatterplot should include:</p>
<ul>
<li>all original data points</li>
<li>the regression line</li>
<li>the 95% CI about the regression line</li>
<li>some like the equation (coefficients) and the <span class="math inline">\(R^2\)</span> in the plot, but I find it to be busy, I’d suggest mentioning these values in the figure caption or just save them for the text.</li>
<li>I like to present the points in a lighter color, with the regression line in a heavier color.</li>
</ul>
<section id="basic-regression-example" class="level3"><h3 class="anchored" data-anchor-id="basic-regression-example">Basic regression example</h3>
<p>for example if we wanted to plot the relationship between the average hours of parent’s sleep and their grumpiness:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent_sleep, <span class="at">y=</span>parent_grumpy)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"lightgray"</span>) <span class="sc">+</span> <span class="co"># points in light gray</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> T, <span class="at">se =</span> T, <span class="co"># regression line with 95%CI</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype=</span><span class="st">"solid"</span>) <span class="sc">+</span> <span class="co"># color and linetype for regression line</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">xlab</span>(<span class="st">"Average hours parent sleep"</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">ylab</span>(<span class="st">"Parent Grumpiness Score"</span>) <span class="sc">+</span> </span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/regression plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="independent-regression-by-group" class="level3"><h3 class="anchored" data-anchor-id="independent-regression-by-group">Independent regression by group</h3>
<p>In this case we are extending the question above, by asking whether the relationship between the average hours of parent’s sleep and their grumpiness differs by parental role. We can either put both groups on the sample plot (differentiating by shape, or color, or linetype), or place them side by side.</p>
<section id="same-plot" class="level4"><h4 class="anchored" data-anchor-id="same-plot">same plot</h4>
<p>To put different groups on the same plot use the <code>group</code> aesthetic (aes):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent_sleep, <span class="at">y=</span>parent_grumpy, <span class="at">group=</span>parent)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>parent)) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> T, <span class="at">se =</span> T, <span class="co"># regression line with 95%CI</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>parent)) <span class="sc">+</span> <span class="co"># color and linetype for regression line</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">xlab</span>(<span class="st">"Average hours parent sleep"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">ylab</span>(<span class="st">"Parent Grumpiness Score"</span>) <span class="sc">+</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/two regressions same plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="seperate-plots" class="level4"><h4 class="anchored" data-anchor-id="seperate-plots">seperate plots</h4>
<p>If you find the plot about to be too busy, use <code>facet_wrap()</code> instead</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent_sleep, <span class="at">y=</span>parent_grumpy)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>parent)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> T, <span class="at">se =</span> T, <span class="co"># regression line with 95%CI</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>parent)) <span class="sc">+</span> <span class="co"># color and linetype for regression line</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">xlab</span>(<span class="st">"Average hours parent sleep"</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">ylab</span>(<span class="st">"Parent Grumpiness Score"</span>) <span class="sc">+</span> </span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="combination" class="level4"><h4 class="anchored" data-anchor-id="combination">Combination</h4>
<p>Here I am plotting parent grumpiness as a function of avg. hours of sleep, differentiating BOTH by <code>parent</code> role and <code>child</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent_sleep, <span class="at">y=</span>parent_grumpy, <span class="at">group=</span>parent)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>parent)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> T, <span class="at">se =</span> T, <span class="co"># regression line with 95%CI</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>parent)) <span class="sc">+</span> <span class="co"># color and linetype for regression line</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">xlab</span>(<span class="st">"Average hours parent sleep"</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">ylab</span>(<span class="st">"Parent Grumpiness Score"</span>) <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>child)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/combo with facet-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Without worrying about the statsitics, what story are these plots conveying about average hours sleep, relative grumpiness, and whether its your first born?</p>
</section></section></section><section id="differences-in-groups" class="level2"><h2 class="anchored" data-anchor-id="differences-in-groups">Differences in groups</h2>
<p>Typically with differences in groups, you’ll want to present your data in one of several formats, depending on what you want to emphasize.</p>
<ul>
<li>If your want to emphasize mean differences, choose a barplot or pointrange</li>
<li>If you want to emphaseze differences in distribution, choose a boxplot or violin plot</li>
</ul>
<section id="comparing-groups-levels-of-a-single-iv" class="level3"><h3 class="anchored" data-anchor-id="comparing-groups-levels-of-a-single-iv">Comparing groups (levels) of a single IV</h3>
<p>Question: Which parent typically gets less sleep when their in a newborn in the family?</p>
<section id="barplot" class="level4"><h4 class="anchored" data-anchor-id="barplot">barplot</h4>
<p>Barplots are typically the industry convention, although we’ve noted their issues:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span> <span class="co"># you can change the color of the bar using `fill`; `color` changes the color of the outline.</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width=</span>.<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.
ℹ Please use the `fun` argument instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/basic barplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On annoying thing about barplots is that by default <code>ggplot</code> creats a gap betweeon 0 and the x-axis like above. To fix this, you need to add <code>scale_y_continuous(expand =  c(0,0))</code> to every barplot that you intend to start from 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span> <span class="co"># you can change the color of the bar using `fill`; `color` changes the color of the outline.</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width=</span>.<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span>  <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/basic barplot with corrected axis-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="barplot-with-datapoints" class="level4"><h4 class="anchored" data-anchor-id="barplot-with-datapoints">barplot with datapoints</h4>
<p>Another option is barplot with raw data point overlays, although these plots can look odd / busy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>), <span class="at">fill=</span><span class="st">"grey"</span>, <span class="at">col=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span>.<span class="dv">5</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(.<span class="dv">01</span>)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span>  <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/barplot with datapoints-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="boxplot" class="level4"><h4 class="anchored" data-anchor-id="boxplot">boxplot</h4>
<p>Boxplots are useful if you want to give your reader a little more info about the distribution of the data being compared. Here is the mother v. father data in boxplot form</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">theme_cowplot</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="comparing-groups-in-a-factorial-design-interaction-plot" class="level3"><h3 class="anchored" data-anchor-id="comparing-groups-in-a-factorial-design-interaction-plot">Comparing groups in a factorial design (interaction plot)</h3>
<p>On we get to factoral ANOVA, we are comparing groups along multiple dimensions (multiple IVs). For example, here we are looking a means data of the average hours of sleep as a function of BOTH parent role and child number. A more technical way of saying this is that we are looking at these values as a function of the interaction between parent role and child number. Since there are two levels in both <code>parent</code> and <code>child</code> we end up with four means to convey. We typically want these means grouped in a way that conveys the design of the analysis.</p>
<p>Here I am grouping <code>parent</code> along the x-axis, and grouping child by the <code>geom</code>.</p>
<section id="barplot-with-error-bars" class="level4"><h4 class="anchored" data-anchor-id="barplot-with-error-bars">barplot with error bars</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>), <span class="fu">aes</span>(<span class="at">fill=</span>child), <span class="at">col=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width=</span>.<span class="dv">15</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/factoral barplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="boxplot-1" class="level4"><h4 class="anchored" data-anchor-id="boxplot-1">boxplot</h4>
<p>Note that when you put together a boxplot, you need to note that the grouping is by the <code>interaction</code> between the two variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">fill =</span> child)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group=</span><span class="fu">interaction</span>(child,parent))) <span class="sc">+</span> </span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/factoral boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="violin-barplot-combo" class="level4"><h4 class="anchored" data-anchor-id="violin-barplot-combo">violin-barplot combo</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">fill =</span> child)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> T,</span>
<span id="cb18-3"><a href="#cb18-3"></a>              <span class="fu">aes</span>(<span class="at">group=</span><span class="fu">interaction</span>(child,parent))) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb18-5"><a href="#cb18-5"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>),</span>
<span id="cb18-6"><a href="#cb18-6"></a>                <span class="fu">aes</span>(<span class="at">group=</span><span class="fu">interaction</span>(child,parent))</span>
<span id="cb18-7"><a href="#cb18-7"></a>               ) <span class="sc">+</span> </span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb18-10"><a href="#cb18-10"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/violin barplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section></section><section id="line-plots" class="level2"><h2 class="anchored" data-anchor-id="line-plots">Line plots</h2>
<p>Typically we only use line plots when the data is “connected” somehow. For example, imagine that instead of seperate groups for <code>child</code> (100 parents with their first v. 100 different parents with their second) be got data from parents with two children (200 parants comparing experience with first child v second). FWIW this would end up being a mixed design—parent: mother v. father is a between variable, and child would be a within. In this case it would make sense to draw a line plot connecting first child values to the second child values to emphasize that this data reflects that these data a meaningfully connected / dependent on one another.</p>
<p>In cases like these I recommend a line and pointrange plot. I also recommend getting familiar with <code>position_dodge</code> as a way of dealing with overlapping pointranges. For example, without the points and lines dodged:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/line plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>compared to with them dodged:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="a-note-on-color-and-apa-formatting" class="level2"><h2 class="anchored" data-anchor-id="a-note-on-color-and-apa-formatting">A note on color and APA formatting</h2>
<p>If you are concerned about APA formatting, I find the <code>theme_cowplot()</code> from the <code>cowplot</code> package will get you almost all of the way there depending on how complex your plot is. For example, this plot is pretty ready to go:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">theme_cowplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="the-legend" class="level2"><h2 class="anchored" data-anchor-id="the-legend">The Legend</h2>
<section id="positioning" class="level3"><h3 class="anchored" data-anchor-id="positioning">Positioning</h3>
<p>A few issues remain. APA asks for the legend to be within the plot itself (not off to the side). This can be accplished by adjusting the legend. With the <code>legend.position</code> call, imagine your plot has a coordinate system ranging from 0 to 1 along both the x and y axes. So for example, to place the legend in a position at 50% of the x-axis and 75% of the y-axis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Play around with this to get a feel for how position changes.</p>
</section><section id="title-ing" class="level3"><h3 class="anchored" data-anchor-id="title-ing">Title-ing</h3>
<p>To change the header in the legend to a capital “Child”, I need to have an appreciation for what is changing in the lengend. In this case <code>child</code> is designated by both <code>shape</code> and <code>linetype</code>. I then use the <code>labs()</code> call</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">75</span>)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">labs</span>(<span class="at">shape =</span> <span class="st">"Child"</span>, <span class="at">linetype=</span><span class="st">"Child"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is typically good enough for the legend, but I invite you to go <a href="https://www.datanovia.com/en/blog/ggplot-legend-title-position-and-labels/">this page on Datanova</a> if you really want to get into customizing the legend, including reversing the order of items, and presenting the legend in wide format.</p>
</section><section id="color" class="level3"><h3 class="anchored" data-anchor-id="color">Color</h3>
<p>A convention of print publication is to present your figures in black-white-greyscale (cheaper ink!). Since most people read articles by way of pdf you might find this a bit antiquated.</p>
<p><strong>My Pro-tip: </strong> - For simple plots like these, use APA format (black-white-grey) if your intend to submit for print. For complex plots this may mean you need to differentiate your group data by <code>shape</code> or <code>linetype</code> as in the previous plot.</p>
<ul>
<li>I’d offer for presentations and posters, use color to make your figures pop! i.e., highlighting important aspectes of the data.</li>
</ul>
<p><code>ggplot()</code> has a default color scheme that’s pretty terrible. For example, you recreate the previous plot differntiating <code>child</code> (First v. Second) by color, I can add color to first line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child, <span class="at">color=</span>child)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Differentiaing the same thing, <code>child</code> by <code>shape</code>, <code>linetype</code>, and <code>color</code> is a bit redundent. So there’s that. At the same time those default color choices are awful! Fortunately I can change this using <code>scale_color_manual</code></p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child, <span class="at">color=</span>child)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">75</span>)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_2-more_adv_ggplot_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="advanced-stuff" class="level2"><h2 class="anchored" data-anchor-id="advanced-stuff">Advanced stuff</h2>
<p>For other cool stuff that can be done with <code>cowplot()</code> including placing multiple plots side by side, check out the signette links below written by its author, <a href="http://wilkelab.org/">Claus O. Wilke</a>:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html">Introduction to cowplot</a></li>
<li><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/axis_position.html">Changing the axis positions</a></li>
<li><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/plot_annotations.html">Plot annotations</a></li>
<li><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/plot_grid.html">Arranging plots in a grid</a></li>
<li><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/shared_legends.html">Shared legends</a></li>
</ul>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb26" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">---</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="an">title:</span><span class="co"> "More advanced ggPlots"</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">---</span></span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a>Consider this vignette a compliment to your training materials with plotting, including the DataCamp modules as well as the <span class="in">`ggplot`</span> specific pdfs that have been made available to you.</span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a>The idea here is to provide a series of templates for plot types that you can build from when developing your own plots. </span>
<span id="cb26-8"><a href="#cb26-8"></a></span>
<span id="cb26-9"><a href="#cb26-9"></a>When producing a plot, you need to give consideration to:</span>
<span id="cb26-10"><a href="#cb26-10"></a></span>
<span id="cb26-11"><a href="#cb26-11"></a>(1) the kind of data you have, and </span>
<span id="cb26-12"><a href="#cb26-12"></a>(2) the kind of information you are trying to convey.</span>
<span id="cb26-13"><a href="#cb26-13"></a></span>
<span id="cb26-14"><a href="#cb26-14"></a>In that spirit this vignette will be organized with those considerations in mind. I recommend before you even think of producing anything in <span class="in">`R`</span>, grab a piece of paper and draw what your ideal plot would look like in terms of structure. What goes on each axes? How are groups differentiated? What kind of plot do you want? etc...</span>
<span id="cb26-15"><a href="#cb26-15"></a></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="fu">## The data</span></span>
<span id="cb26-17"><a href="#cb26-17"></a></span>
<span id="cb26-18"><a href="#cb26-18"></a>I'll be using a modified dataset from Danielle Navarro's *Learning statistics with R:</span>
<span id="cb26-19"><a href="#cb26-19"></a>A tutorial for psychology students and other beginners* which is a nice online text that I may use as a backbone for the course in future years. If you're interested on Navarro's take on stats and <span class="in">`R`</span>, please check it out <span class="co">[</span><span class="ot">here</span><span class="co">](http://compcogscisydney.org/learning-statistics-with-r)</span>. Coincidentally, the <span class="in">`lsr`</span> package she provides is what we use to calculate certain values like Cohen's D.</span>
<span id="cb26-20"><a href="#cb26-20"></a></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="at">&gt; The following data set was used to address the relationships that exist between a newbnorn baby's (3-6 mos) nightly sleep, their parent's sleep, and their parent's overall mood. Several questions modivated the collection of this data, including:</span></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="ss">- </span>what is the relationship between the average hours of sleep for the baby and parent?</span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="ss">- </span>what is the relationship between the average hours of sleep for the parent and their mood?</span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="ss">- </span>are these relationships influence by parental role—different for mothers and fathers</span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="ss">- </span>does the impact of a newborn baby on sleep differ for mothers and fathers (houts of sleep, grumpiness)</span>
<span id="cb26-26"><a href="#cb26-26"></a></span>
<span id="cb26-27"><a href="#cb26-27"></a>the dataset <span class="in">`parent_sleep_data`</span> contains the following variables:</span>
<span id="cb26-28"><a href="#cb26-28"></a></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="ss">- </span><span class="in">`parent`</span>: 100 mothers (typically primary care giver, especially if breast feeding) v. 100 fathers (un-matched)</span>
<span id="cb26-30"><a href="#cb26-30"></a><span class="ss">- </span><span class="in">`child`</span>: 100 parents with their first child v. 100 parents with their second child</span>
<span id="cb26-31"><a href="#cb26-31"></a><span class="ss">- </span><span class="in">`parent_sleep`</span>: average hours parent sleep 30 days prior to assessment</span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="ss">- </span><span class="in">`baby_sleep`</span>: average hours babry sleep 30 days prior to assessment</span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="ss">- </span><span class="in">`parent_grumpy`</span>: parent grunmpiness score</span>
<span id="cb26-34"><a href="#cb26-34"></a></span>
<span id="cb26-35"><a href="#cb26-35"></a></span>
<span id="cb26-36"><a href="#cb26-36"></a><span class="in">```{r load in libraries and data}</span></span>
<span id="cb26-37"><a href="#cb26-37"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, cowplot)</span>
<span id="cb26-38"><a href="#cb26-38"></a>parent_sleep_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/tehrandavis/graduate_statistics/main/practice_datasets/parent_sleep.csv"</span>)</span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="in">```</span></span>
<span id="cb26-40"><a href="#cb26-40"></a></span>
<span id="cb26-41"><a href="#cb26-41"></a><span class="ss">* </span>You might imagine, this data hits a little close to the heart ;)</span>
<span id="cb26-42"><a href="#cb26-42"></a></span>
<span id="cb26-43"><a href="#cb26-43"></a></span>
<span id="cb26-44"><a href="#cb26-44"></a><span class="fu">## Correlation / Regression for 2 continuous variables</span></span>
<span id="cb26-45"><a href="#cb26-45"></a></span>
<span id="cb26-46"><a href="#cb26-46"></a>Typically with correlations and regressions you want to present your data in scatterplot form. </span>
<span id="cb26-47"><a href="#cb26-47"></a></span>
<span id="cb26-48"><a href="#cb26-48"></a>Your scatterplot should include:</span>
<span id="cb26-49"><a href="#cb26-49"></a></span>
<span id="cb26-50"><a href="#cb26-50"></a><span class="ss">- </span>all original data points</span>
<span id="cb26-51"><a href="#cb26-51"></a><span class="ss">- </span>the regression line</span>
<span id="cb26-52"><a href="#cb26-52"></a><span class="ss">- </span>the 95% CI about the regression line</span>
<span id="cb26-53"><a href="#cb26-53"></a><span class="ss">- </span>some like the equation (coefficients) and the $R^2$ in the plot, but I find it to be busy, I'd suggest mentioning these values in the figure caption or just save them for the text.</span>
<span id="cb26-54"><a href="#cb26-54"></a><span class="ss">- </span>I like to present the points in a lighter color, with the regression line in a heavier color.</span>
<span id="cb26-55"><a href="#cb26-55"></a></span>
<span id="cb26-56"><a href="#cb26-56"></a><span class="fu">### Basic regression example</span></span>
<span id="cb26-57"><a href="#cb26-57"></a></span>
<span id="cb26-58"><a href="#cb26-58"></a>for example if we wanted to plot the relationship between the average hours of parent's sleep and their grumpiness:</span>
<span id="cb26-59"><a href="#cb26-59"></a></span>
<span id="cb26-60"><a href="#cb26-60"></a><span class="in">```{r regression plot}</span></span>
<span id="cb26-61"><a href="#cb26-61"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent_sleep, <span class="at">y=</span>parent_grumpy)) <span class="sc">+</span></span>
<span id="cb26-62"><a href="#cb26-62"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"lightgray"</span>) <span class="sc">+</span> <span class="co"># points in light gray</span></span>
<span id="cb26-63"><a href="#cb26-63"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> T, <span class="at">se =</span> T, <span class="co"># regression line with 95%CI</span></span>
<span id="cb26-64"><a href="#cb26-64"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype=</span><span class="st">"solid"</span>) <span class="sc">+</span> <span class="co"># color and linetype for regression line</span></span>
<span id="cb26-65"><a href="#cb26-65"></a>  <span class="fu">xlab</span>(<span class="st">"Average hours parent sleep"</span>) <span class="sc">+</span></span>
<span id="cb26-66"><a href="#cb26-66"></a>  <span class="fu">ylab</span>(<span class="st">"Parent Grumpiness Score"</span>) <span class="sc">+</span> </span>
<span id="cb26-67"><a href="#cb26-67"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-68"><a href="#cb26-68"></a><span class="in">```</span></span>
<span id="cb26-69"><a href="#cb26-69"></a></span>
<span id="cb26-70"><a href="#cb26-70"></a><span class="fu">### Independent regression by group</span></span>
<span id="cb26-71"><a href="#cb26-71"></a>In this case we are extending the question above, by asking whether the relationship between the average hours of parent's sleep and their grumpiness differs by parental role. We can either put both groups on the sample plot (differentiating by shape, or color, or linetype), or place them side by side.</span>
<span id="cb26-72"><a href="#cb26-72"></a></span>
<span id="cb26-73"><a href="#cb26-73"></a><span class="fu">#### same plot</span></span>
<span id="cb26-74"><a href="#cb26-74"></a>To put different groups on the same plot use the <span class="in">`group`</span> aesthetic (aes):</span>
<span id="cb26-75"><a href="#cb26-75"></a><span class="in">```{r two regressions same plot}</span></span>
<span id="cb26-76"><a href="#cb26-76"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent_sleep, <span class="at">y=</span>parent_grumpy, <span class="at">group=</span>parent)) <span class="sc">+</span></span>
<span id="cb26-77"><a href="#cb26-77"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>parent)) <span class="sc">+</span> </span>
<span id="cb26-78"><a href="#cb26-78"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> T, <span class="at">se =</span> T, <span class="co"># regression line with 95%CI</span></span>
<span id="cb26-79"><a href="#cb26-79"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>parent)) <span class="sc">+</span> <span class="co"># color and linetype for regression line</span></span>
<span id="cb26-80"><a href="#cb26-80"></a>  <span class="fu">xlab</span>(<span class="st">"Average hours parent sleep"</span>) <span class="sc">+</span></span>
<span id="cb26-81"><a href="#cb26-81"></a>  <span class="fu">ylab</span>(<span class="st">"Parent Grumpiness Score"</span>) <span class="sc">+</span> </span>
<span id="cb26-82"><a href="#cb26-82"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-83"><a href="#cb26-83"></a><span class="in">```</span></span>
<span id="cb26-84"><a href="#cb26-84"></a></span>
<span id="cb26-85"><a href="#cb26-85"></a><span class="fu">#### seperate plots</span></span>
<span id="cb26-86"><a href="#cb26-86"></a>If you find the plot about to be too busy, use <span class="in">`facet_wrap()`</span> instead</span>
<span id="cb26-89"><a href="#cb26-89"></a><span class="in">```{r}</span></span>
<span id="cb26-90"><a href="#cb26-90"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent_sleep, <span class="at">y=</span>parent_grumpy)) <span class="sc">+</span></span>
<span id="cb26-91"><a href="#cb26-91"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>parent)) <span class="sc">+</span> </span>
<span id="cb26-92"><a href="#cb26-92"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> T, <span class="at">se =</span> T, <span class="co"># regression line with 95%CI</span></span>
<span id="cb26-93"><a href="#cb26-93"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>parent)) <span class="sc">+</span> <span class="co"># color and linetype for regression line</span></span>
<span id="cb26-94"><a href="#cb26-94"></a>  <span class="fu">xlab</span>(<span class="st">"Average hours parent sleep"</span>) <span class="sc">+</span></span>
<span id="cb26-95"><a href="#cb26-95"></a>  <span class="fu">ylab</span>(<span class="st">"Parent Grumpiness Score"</span>) <span class="sc">+</span> </span>
<span id="cb26-96"><a href="#cb26-96"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb26-97"><a href="#cb26-97"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parent)</span>
<span id="cb26-98"><a href="#cb26-98"></a><span class="in">```</span></span>
<span id="cb26-99"><a href="#cb26-99"></a><span class="fu">#### Combination</span></span>
<span id="cb26-100"><a href="#cb26-100"></a></span>
<span id="cb26-101"><a href="#cb26-101"></a>Here I am plotting parent grumpiness as a function of avg. hours of sleep, differentiating BOTH by <span class="in">`parent`</span> role and <span class="in">`child`</span>:</span>
<span id="cb26-102"><a href="#cb26-102"></a></span>
<span id="cb26-103"><a href="#cb26-103"></a><span class="in">```{r combo with facet}</span></span>
<span id="cb26-104"><a href="#cb26-104"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent_sleep, <span class="at">y=</span>parent_grumpy, <span class="at">group=</span>parent)) <span class="sc">+</span></span>
<span id="cb26-105"><a href="#cb26-105"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>parent)) <span class="sc">+</span> </span>
<span id="cb26-106"><a href="#cb26-106"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> T, <span class="at">se =</span> T, <span class="co"># regression line with 95%CI</span></span>
<span id="cb26-107"><a href="#cb26-107"></a>              <span class="at">color =</span> <span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>parent)) <span class="sc">+</span> <span class="co"># color and linetype for regression line</span></span>
<span id="cb26-108"><a href="#cb26-108"></a>  <span class="fu">xlab</span>(<span class="st">"Average hours parent sleep"</span>) <span class="sc">+</span></span>
<span id="cb26-109"><a href="#cb26-109"></a>  <span class="fu">ylab</span>(<span class="st">"Parent Grumpiness Score"</span>) <span class="sc">+</span> </span>
<span id="cb26-110"><a href="#cb26-110"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb26-111"><a href="#cb26-111"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>child)</span>
<span id="cb26-112"><a href="#cb26-112"></a><span class="in">```</span></span>
<span id="cb26-113"><a href="#cb26-113"></a></span>
<span id="cb26-114"><a href="#cb26-114"></a>Without worrying about the statsitics, what story are these plots conveying about average hours sleep, relative grumpiness, and whether its your first born?</span>
<span id="cb26-115"><a href="#cb26-115"></a></span>
<span id="cb26-116"><a href="#cb26-116"></a></span>
<span id="cb26-117"><a href="#cb26-117"></a><span class="fu">## Differences in groups</span></span>
<span id="cb26-118"><a href="#cb26-118"></a>Typically with differences in groups, you'll want to present your data in one of several formats, depending on what you want to emphasize.</span>
<span id="cb26-119"><a href="#cb26-119"></a></span>
<span id="cb26-120"><a href="#cb26-120"></a><span class="ss">- </span>If your want to emphasize mean differences, choose a barplot or pointrange</span>
<span id="cb26-121"><a href="#cb26-121"></a><span class="ss">- </span>If you want to emphaseze differences in distribution, choose a boxplot or violin plot</span>
<span id="cb26-122"><a href="#cb26-122"></a></span>
<span id="cb26-123"><a href="#cb26-123"></a><span class="fu">### Comparing groups (levels) of a single IV</span></span>
<span id="cb26-124"><a href="#cb26-124"></a></span>
<span id="cb26-125"><a href="#cb26-125"></a>Question: Which parent typically gets less sleep when their in a newborn in the family?</span>
<span id="cb26-126"><a href="#cb26-126"></a></span>
<span id="cb26-127"><a href="#cb26-127"></a><span class="fu">#### barplot</span></span>
<span id="cb26-128"><a href="#cb26-128"></a>Barplots are typically the industry convention, although we've noted their issues:</span>
<span id="cb26-129"><a href="#cb26-129"></a><span class="in">```{r basic barplot}</span></span>
<span id="cb26-130"><a href="#cb26-130"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep)) <span class="sc">+</span></span>
<span id="cb26-131"><a href="#cb26-131"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span> <span class="co"># you can change the color of the bar using `fill`; `color` changes the color of the outline.</span></span>
<span id="cb26-132"><a href="#cb26-132"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width=</span>.<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb26-133"><a href="#cb26-133"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-134"><a href="#cb26-134"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-135"><a href="#cb26-135"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-136"><a href="#cb26-136"></a><span class="in">```</span></span>
<span id="cb26-137"><a href="#cb26-137"></a></span>
<span id="cb26-138"><a href="#cb26-138"></a>On annoying thing about barplots is that by default <span class="in">`ggplot`</span> creats a gap betweeon 0 and the x-axis like above. To fix this, you need to add <span class="in">`scale_y_continuous(expand =  c(0,0))`</span> to every barplot that you intend to start from 0.</span>
<span id="cb26-139"><a href="#cb26-139"></a></span>
<span id="cb26-140"><a href="#cb26-140"></a><span class="in">```{r basic barplot with corrected axis}</span></span>
<span id="cb26-141"><a href="#cb26-141"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep)) <span class="sc">+</span></span>
<span id="cb26-142"><a href="#cb26-142"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span> <span class="co"># you can change the color of the bar using `fill`; `color` changes the color of the outline.</span></span>
<span id="cb26-143"><a href="#cb26-143"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width=</span>.<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb26-144"><a href="#cb26-144"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-145"><a href="#cb26-145"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-146"><a href="#cb26-146"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb26-147"><a href="#cb26-147"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span>  <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb26-148"><a href="#cb26-148"></a><span class="in">```</span></span>
<span id="cb26-149"><a href="#cb26-149"></a></span>
<span id="cb26-150"><a href="#cb26-150"></a><span class="fu">#### barplot with datapoints</span></span>
<span id="cb26-151"><a href="#cb26-151"></a>Another option is barplot with raw data point overlays, although these plots can look odd / busy.</span>
<span id="cb26-152"><a href="#cb26-152"></a><span class="in">```{r barplot with datapoints}</span></span>
<span id="cb26-153"><a href="#cb26-153"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep)) <span class="sc">+</span></span>
<span id="cb26-154"><a href="#cb26-154"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>), <span class="at">fill=</span><span class="st">"grey"</span>, <span class="at">col=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb26-155"><a href="#cb26-155"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span>.<span class="dv">5</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(.<span class="dv">01</span>)) <span class="sc">+</span></span>
<span id="cb26-156"><a href="#cb26-156"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-157"><a href="#cb26-157"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-158"><a href="#cb26-158"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb26-159"><a href="#cb26-159"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span>  <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb26-160"><a href="#cb26-160"></a><span class="in">```</span></span>
<span id="cb26-161"><a href="#cb26-161"></a></span>
<span id="cb26-162"><a href="#cb26-162"></a><span class="fu">#### boxplot</span></span>
<span id="cb26-163"><a href="#cb26-163"></a></span>
<span id="cb26-164"><a href="#cb26-164"></a>Boxplots are useful if you want to give your reader a little more info about the distribution of the data being compared. Here is the mother v. father data in boxplot form</span>
<span id="cb26-165"><a href="#cb26-165"></a><span class="in">```{r boxplot}</span></span>
<span id="cb26-166"><a href="#cb26-166"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep)) <span class="sc">+</span></span>
<span id="cb26-167"><a href="#cb26-167"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb26-168"><a href="#cb26-168"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-169"><a href="#cb26-169"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-170"><a href="#cb26-170"></a>  <span class="fu">theme_cowplot</span>() </span>
<span id="cb26-171"><a href="#cb26-171"></a><span class="in">```</span></span>
<span id="cb26-172"><a href="#cb26-172"></a></span>
<span id="cb26-173"><a href="#cb26-173"></a><span class="fu">### Comparing groups in a factorial design (interaction plot)</span></span>
<span id="cb26-174"><a href="#cb26-174"></a>On we get to factoral ANOVA, we are comparing groups along multiple dimensions (multiple IVs). For example, here we are looking a means data of the average hours of sleep as a function of BOTH parent role and child number. A more technical way of saying this is that we are looking at these values as a function of the interaction between parent role and child number. Since there are two levels in both <span class="in">`parent`</span> and <span class="in">`child`</span> we end up with four means to convey. We typically want these means grouped in a way that conveys the design of the analysis.</span>
<span id="cb26-175"><a href="#cb26-175"></a></span>
<span id="cb26-176"><a href="#cb26-176"></a>Here I am grouping <span class="in">`parent`</span> along the x-axis, and grouping child by the <span class="in">`geom`</span>.</span>
<span id="cb26-177"><a href="#cb26-177"></a></span>
<span id="cb26-178"><a href="#cb26-178"></a><span class="fu">#### barplot with error bars</span></span>
<span id="cb26-179"><a href="#cb26-179"></a><span class="in">```{r factoral barplot}</span></span>
<span id="cb26-180"><a href="#cb26-180"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb26-181"><a href="#cb26-181"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"col"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>), <span class="fu">aes</span>(<span class="at">fill=</span>child), <span class="at">col=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb26-182"><a href="#cb26-182"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width=</span>.<span class="dv">15</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb26-183"><a href="#cb26-183"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-184"><a href="#cb26-184"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-185"><a href="#cb26-185"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-186"><a href="#cb26-186"></a><span class="in">```</span></span>
<span id="cb26-187"><a href="#cb26-187"></a></span>
<span id="cb26-188"><a href="#cb26-188"></a><span class="fu">#### boxplot</span></span>
<span id="cb26-189"><a href="#cb26-189"></a>Note that when you put together a boxplot, you need to note that the grouping is by the <span class="in">`interaction`</span> between the two variables.</span>
<span id="cb26-190"><a href="#cb26-190"></a><span class="in">```{r factoral boxplot}</span></span>
<span id="cb26-191"><a href="#cb26-191"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">fill =</span> child)) <span class="sc">+</span></span>
<span id="cb26-192"><a href="#cb26-192"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group=</span><span class="fu">interaction</span>(child,parent))) <span class="sc">+</span> </span>
<span id="cb26-193"><a href="#cb26-193"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-194"><a href="#cb26-194"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-195"><a href="#cb26-195"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-196"><a href="#cb26-196"></a><span class="in">```</span></span>
<span id="cb26-197"><a href="#cb26-197"></a></span>
<span id="cb26-198"><a href="#cb26-198"></a><span class="fu">#### violin-barplot combo</span></span>
<span id="cb26-199"><a href="#cb26-199"></a><span class="in">```{r violin barplot}</span></span>
<span id="cb26-200"><a href="#cb26-200"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">fill =</span> child)) <span class="sc">+</span></span>
<span id="cb26-201"><a href="#cb26-201"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> T,</span>
<span id="cb26-202"><a href="#cb26-202"></a>              <span class="fu">aes</span>(<span class="at">group=</span><span class="fu">interaction</span>(child,parent))) <span class="sc">+</span></span>
<span id="cb26-203"><a href="#cb26-203"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb26-204"><a href="#cb26-204"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">9</span>),</span>
<span id="cb26-205"><a href="#cb26-205"></a>                <span class="fu">aes</span>(<span class="at">group=</span><span class="fu">interaction</span>(child,parent))</span>
<span id="cb26-206"><a href="#cb26-206"></a>               ) <span class="sc">+</span> </span>
<span id="cb26-207"><a href="#cb26-207"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-208"><a href="#cb26-208"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-209"><a href="#cb26-209"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-210"><a href="#cb26-210"></a><span class="in">```</span></span>
<span id="cb26-211"><a href="#cb26-211"></a></span>
<span id="cb26-212"><a href="#cb26-212"></a></span>
<span id="cb26-213"><a href="#cb26-213"></a><span class="fu">## Line plots</span></span>
<span id="cb26-214"><a href="#cb26-214"></a></span>
<span id="cb26-215"><a href="#cb26-215"></a>Typically we only use line plots when the data is "connected" somehow. For example, imagine that instead of seperate groups for <span class="in">`child`</span> (100 parents with their first v. 100 different parents with their second) be got data from parents with two children (200 parants comparing experience with first child v second). FWIW this would end up being a mixed design—parent: mother v. father is a between variable, and child would be a within. In this case it would make sense to draw a line plot connecting first child values to the second child values to emphasize that this data reflects that these data a meaningfully connected / dependent on one another.</span>
<span id="cb26-216"><a href="#cb26-216"></a></span>
<span id="cb26-217"><a href="#cb26-217"></a>In cases like these I recommend a line and pointrange plot. I also recommend getting familiar with <span class="in">`position_dodge`</span> as a way of dealing with overlapping pointranges. For example, without the points and lines dodged:</span>
<span id="cb26-218"><a href="#cb26-218"></a></span>
<span id="cb26-219"><a href="#cb26-219"></a><span class="in">```{r line plot}</span></span>
<span id="cb26-220"><a href="#cb26-220"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb26-221"><a href="#cb26-221"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child)) <span class="sc">+</span></span>
<span id="cb26-222"><a href="#cb26-222"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child)) <span class="sc">+</span></span>
<span id="cb26-223"><a href="#cb26-223"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-224"><a href="#cb26-224"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-225"><a href="#cb26-225"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-226"><a href="#cb26-226"></a><span class="in">```</span></span>
<span id="cb26-227"><a href="#cb26-227"></a></span>
<span id="cb26-228"><a href="#cb26-228"></a>compared to with them dodged:</span>
<span id="cb26-231"><a href="#cb26-231"></a><span class="in">```{r}</span></span>
<span id="cb26-232"><a href="#cb26-232"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb26-233"><a href="#cb26-233"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-234"><a href="#cb26-234"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-235"><a href="#cb26-235"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-236"><a href="#cb26-236"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-237"><a href="#cb26-237"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-238"><a href="#cb26-238"></a><span class="in">```</span></span>
<span id="cb26-239"><a href="#cb26-239"></a></span>
<span id="cb26-240"><a href="#cb26-240"></a><span class="fu">## A note on color and APA formatting</span></span>
<span id="cb26-241"><a href="#cb26-241"></a></span>
<span id="cb26-242"><a href="#cb26-242"></a>If you are concerned about APA formatting, I find the <span class="in">`theme_cowplot()`</span> from the <span class="in">`cowplot`</span> package will get you almost all of the way there depending on how complex your plot is. For example, this plot is pretty ready to go:</span>
<span id="cb26-243"><a href="#cb26-243"></a></span>
<span id="cb26-246"><a href="#cb26-246"></a><span class="in">```{r}</span></span>
<span id="cb26-247"><a href="#cb26-247"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb26-248"><a href="#cb26-248"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child)) <span class="sc">+</span></span>
<span id="cb26-249"><a href="#cb26-249"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child)) <span class="sc">+</span></span>
<span id="cb26-250"><a href="#cb26-250"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-251"><a href="#cb26-251"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-252"><a href="#cb26-252"></a>  <span class="fu">theme_cowplot</span>()</span>
<span id="cb26-253"><a href="#cb26-253"></a><span class="in">```</span></span>
<span id="cb26-254"><a href="#cb26-254"></a></span>
<span id="cb26-255"><a href="#cb26-255"></a><span class="fu">## The Legend </span></span>
<span id="cb26-256"><a href="#cb26-256"></a><span class="fu">### Positioning</span></span>
<span id="cb26-257"><a href="#cb26-257"></a>A few issues remain. APA asks for the legend to be within the plot itself (not off to the side). This can be accplished by adjusting the legend. With the <span class="in">`legend.position`</span> call, imagine your plot has a coordinate system ranging from 0 to 1 along both the x and y axes. So for example, to place the legend in a position at 50% of the x-axis and 75% of the y-axis:</span>
<span id="cb26-258"><a href="#cb26-258"></a></span>
<span id="cb26-261"><a href="#cb26-261"></a><span class="in">```{r}</span></span>
<span id="cb26-262"><a href="#cb26-262"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb26-263"><a href="#cb26-263"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child)) <span class="sc">+</span></span>
<span id="cb26-264"><a href="#cb26-264"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child)) <span class="sc">+</span></span>
<span id="cb26-265"><a href="#cb26-265"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-266"><a href="#cb26-266"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-267"><a href="#cb26-267"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb26-268"><a href="#cb26-268"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">75</span>))</span>
<span id="cb26-269"><a href="#cb26-269"></a><span class="in">```</span></span>
<span id="cb26-270"><a href="#cb26-270"></a></span>
<span id="cb26-271"><a href="#cb26-271"></a>Play around with this to get a feel for how position changes.</span>
<span id="cb26-272"><a href="#cb26-272"></a></span>
<span id="cb26-273"><a href="#cb26-273"></a><span class="fu">### Title-ing</span></span>
<span id="cb26-274"><a href="#cb26-274"></a>To change the header in the legend to a capital "Child", I need to have an appreciation for what is changing in the lengend. In this case <span class="in">`child`</span> is designated by both <span class="in">`shape`</span> and <span class="in">`linetype`</span>. I then use the <span class="in">`labs()`</span> call</span>
<span id="cb26-277"><a href="#cb26-277"></a><span class="in">```{r}</span></span>
<span id="cb26-278"><a href="#cb26-278"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child)) <span class="sc">+</span></span>
<span id="cb26-279"><a href="#cb26-279"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-280"><a href="#cb26-280"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-281"><a href="#cb26-281"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-282"><a href="#cb26-282"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-283"><a href="#cb26-283"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb26-284"><a href="#cb26-284"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">75</span>)) <span class="sc">+</span></span>
<span id="cb26-285"><a href="#cb26-285"></a>  <span class="fu">labs</span>(<span class="at">shape =</span> <span class="st">"Child"</span>, <span class="at">linetype=</span><span class="st">"Child"</span>)</span>
<span id="cb26-286"><a href="#cb26-286"></a><span class="in">```</span></span>
<span id="cb26-287"><a href="#cb26-287"></a></span>
<span id="cb26-288"><a href="#cb26-288"></a>This is typically good enough for the legend, but I invite you to go <span class="co">[</span><span class="ot">this page on Datanova</span><span class="co">](https://www.datanovia.com/en/blog/ggplot-legend-title-position-and-labels/)</span> if you really want to get into customizing the legend, including reversing the order of items, and presenting the legend in wide format.</span>
<span id="cb26-289"><a href="#cb26-289"></a></span>
<span id="cb26-290"><a href="#cb26-290"></a><span class="fu">### Color</span></span>
<span id="cb26-291"><a href="#cb26-291"></a></span>
<span id="cb26-292"><a href="#cb26-292"></a>A convention of print publication is to present your figures in black-white-greyscale (cheaper ink!). Since most people read articles by way of pdf you might find this a bit antiquated. </span>
<span id="cb26-293"><a href="#cb26-293"></a></span>
<span id="cb26-294"><a href="#cb26-294"></a>**My Pro-tip: **</span>
<span id="cb26-295"><a href="#cb26-295"></a><span class="ss">- </span>For simple plots like these, use APA format (black-white-grey) if your intend to submit for print. For complex plots this may mean you need to differentiate your group data by <span class="in">`shape`</span> or <span class="in">`linetype`</span> as in the previous plot.</span>
<span id="cb26-296"><a href="#cb26-296"></a></span>
<span id="cb26-297"><a href="#cb26-297"></a><span class="ss">- </span>I'd offer for presentations and posters, use color to make your figures pop! i.e., highlighting important aspectes of the data. </span>
<span id="cb26-298"><a href="#cb26-298"></a></span>
<span id="cb26-299"><a href="#cb26-299"></a><span class="in">`ggplot()`</span> has a default color scheme that's pretty terrible. For example, you recreate the previous plot differntiating <span class="in">`child`</span> (First v. Second) by color, I can add color to first line.</span>
<span id="cb26-300"><a href="#cb26-300"></a></span>
<span id="cb26-303"><a href="#cb26-303"></a><span class="in">```{r}</span></span>
<span id="cb26-304"><a href="#cb26-304"></a><span class="fu">ggplot</span>(parent_sleep_data, <span class="fu">aes</span>(<span class="at">x =</span> parent, <span class="at">y=</span>parent_sleep, <span class="at">group =</span> child, <span class="at">color=</span>child)) <span class="sc">+</span></span>
<span id="cb26-305"><a href="#cb26-305"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_se"</span>, <span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="fu">aes</span>(<span class="at">shape=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-306"><a href="#cb26-306"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">linetype=</span>child), <span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-307"><a href="#cb26-307"></a>  <span class="fu">xlab</span>(<span class="st">"Parent"</span>) <span class="sc">+</span></span>
<span id="cb26-308"><a href="#cb26-308"></a>  <span class="fu">ylab</span>(<span class="st">"Average hours sleep"</span>) <span class="sc">+</span> </span>
<span id="cb26-309"><a href="#cb26-309"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span> </span>
<span id="cb26-310"><a href="#cb26-310"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">75</span>))</span>
<span id="cb26-311"><a href="#cb26-311"></a><span class="in">```</span></span>
<span id="cb26-312"><a href="#cb26-312"></a></span>
<span id="cb26-313"><a href="#cb26-313"></a>Differentiaing the same thing, <span class="in">`child`</span> by <span class="in">`shape`</span>, <span class="in">`linetype`</span>, and <span class="in">`color`</span> is a bit redundent. So there's that. At the same time those default color choices are awful! Fortunately I can change this using <span class="in">`scale_color_manual`</span></span>
<span id="cb26-314"><a href="#cb26-314"></a></span>
<span id="cb26-317"><a href="#cb26-317"></a><span class="in">```{r}</span></span>
<span id="cb26-318"><a href="#cb26-318"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb26-319"><a href="#cb26-319"></a><span class="at">ggplot(parent_sleep_data, aes(x = parent, y=parent_sleep, group = child, color=child)) +</span></span>
<span id="cb26-320"><a href="#cb26-320"></a><span class="at">  stat_summary(fun.data = "mean_se", geom = "pointrange", position = position_dodge(.1)) +</span></span>
<span id="cb26-321"><a href="#cb26-321"></a><span class="at">  stat_summary(fun.y = "mean", geom = "line", position = position_dodge(.1)) +</span></span>
<span id="cb26-322"><a href="#cb26-322"></a><span class="at">  xlab("Parent") +</span></span>
<span id="cb26-323"><a href="#cb26-323"></a><span class="at">  ylab("Average hours sleep") + </span></span>
<span id="cb26-324"><a href="#cb26-324"></a><span class="at">  theme_cowplot() + </span></span>
<span id="cb26-325"><a href="#cb26-325"></a><span class="at">  theme(legend.position = c(.5, .75)) +</span></span>
<span id="cb26-326"><a href="#cb26-326"></a><span class="at">  scale_color_manual(values = c("black", "red"))</span></span>
<span id="cb26-327"><a href="#cb26-327"></a><span class="st">```</span></span>
<span id="cb26-328"><a href="#cb26-328"></a></span>
<span id="cb26-329"><a href="#cb26-329"></a></span>
<span id="cb26-330"><a href="#cb26-330"></a></span>
<span id="cb26-331"><a href="#cb26-331"></a></span>
<span id="cb26-332"><a href="#cb26-332"></a><span class="do">## Advanced stuff</span></span>
<span id="cb26-333"><a href="#cb26-333"></a></span>
<span id="cb26-334"><a href="#cb26-334"></a>For other cool stuff that can be done with <span class="st">`</span><span class="at">cowplot()</span><span class="st">`</span> including placing multiple plots side by side, check out the signette links below written by its author, [Claus O. Wilke](http<span class="sc">:</span><span class="er">//</span>wilkelab.org<span class="sc">/</span>)<span class="sc">:</span></span>
<span id="cb26-335"><a href="#cb26-335"></a></span>
<span id="cb26-336"><a href="#cb26-336"></a><span class="sc">+</span> [Introduction to cowplot](https<span class="sc">:</span><span class="er">//</span>cran.r<span class="sc">-</span>project.org<span class="sc">/</span>web<span class="sc">/</span>packages<span class="sc">/</span>cowplot<span class="sc">/</span>vignettes<span class="sc">/</span>introduction.html)</span>
<span id="cb26-337"><a href="#cb26-337"></a><span class="sc">+</span> [Changing the axis positions](https<span class="sc">:</span><span class="er">//</span>cran.r<span class="sc">-</span>project.org<span class="sc">/</span>web<span class="sc">/</span>packages<span class="sc">/</span>cowplot<span class="sc">/</span>vignettes<span class="sc">/</span>axis_position.html)</span>
<span id="cb26-338"><a href="#cb26-338"></a><span class="sc">+</span> [Plot annotations](https<span class="sc">:</span><span class="er">//</span>cran.r<span class="sc">-</span>project.org<span class="sc">/</span>web<span class="sc">/</span>packages<span class="sc">/</span>cowplot<span class="sc">/</span>vignettes<span class="sc">/</span>plot_annotations.html)</span>
<span id="cb26-339"><a href="#cb26-339"></a><span class="sc">+</span> [Arranging plots <span class="cf">in</span> a grid](https<span class="sc">:</span><span class="er">//</span>cran.r<span class="sc">-</span>project.org<span class="sc">/</span>web<span class="sc">/</span>packages<span class="sc">/</span>cowplot<span class="sc">/</span>vignettes<span class="sc">/</span>plot_grid.html)</span>
<span id="cb26-340"><a href="#cb26-340"></a><span class="sc">+</span> [Shared legends](https<span class="sc">:</span><span class="er">//</span>cran.r<span class="sc">-</span>project.org<span class="sc">/</span>web<span class="sc">/</span>packages<span class="sc">/</span>cowplot<span class="sc">/</span>vignettes<span class="sc">/</span>shared_legends.html)</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>